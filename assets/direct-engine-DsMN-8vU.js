import{N as zr,a as G,P as O,p as ot,i as Hr,b as Jt,u as qt,c as R,d as $r,e as Yr,f as Xr,g as Ge,h as ne,j as Ve,k as Kr,l as Ae,m as Qt,w as Zt,n as Jr,o as gt,q as qr,r as en,t as Qr,v as Ue,x as Zr,y as eo,z as it,R as ze,A as We,B as tn,C as to,D as nn,T as rn,E as he,F as ae,M as on,G as no}from"./index-CwCUhUJK.js";var ro=(()=>{var W=import.meta.url;return async function(r={}){var n,e=r,i,u,F=new Promise((t,o)=>{i=t,u=o});["_EPDF_GetMetaKeyCount","_EPDF_GetMetaKeyName","_EPDF_GetMetaTrapped","_EPDF_GetPageRotationByIndex","_EPDF_HasMetaText","_EPDF_PNG_EncodeRGBA","_EPDF_RenderAnnotBitmap","_EPDF_SetMetaText","_EPDF_SetMetaTrapped","_EPDFAction_CreateGoTo","_EPDFAction_CreateGoToNamed","_EPDFAction_CreateLaunch","_EPDFAction_CreateRemoteGoToByName","_EPDFAction_CreateRemoteGoToDest","_EPDFAction_CreateURI","_EPDFAnnot_ClearColor","_EPDFAnnot_GenerateAppearance","_EPDFAnnot_GenerateAppearanceWithBlend","_EPDFAnnot_GetBlendMode","_EPDFAnnot_GetBorderDashPattern","_EPDFAnnot_GetBorderDashPatternCount","_EPDFAnnot_GetBorderEffect","_EPDFAnnot_GetBorderStyle","_EPDFAnnot_GetColor","_EPDFAnnot_GetDefaultAppearance","_EPDFAnnot_GetIcon","_EPDFAnnot_GetIntent","_EPDFAnnot_GetLineEndings","_EPDFAnnot_GetOpacity","_EPDFAnnot_GetRectangleDifferences","_EPDFAnnot_GetRichContent","_EPDFAnnot_GetTextAlignment","_EPDFAnnot_GetVerticalAlignment","_EPDFAnnot_SetBorderDashPattern","_EPDFAnnot_SetBorderStyle","_EPDFAnnot_SetColor","_EPDFAnnot_SetDefaultAppearance","_EPDFAnnot_SetIcon","_EPDFAnnot_SetIntent","_EPDFAnnot_SetLine","_EPDFAnnot_SetLineEndings","_EPDFAnnot_SetLinkedAnnot","_EPDFAnnot_SetOpacity","_EPDFAnnot_SetTextAlignment","_EPDFAnnot_SetVerticalAlignment","_EPDFAnnot_SetVertices","_EPDFAnnot_UpdateAppearanceToRect","_EPDFAttachment_GetDescription","_EPDFAttachment_GetIntegerValue","_EPDFAttachment_SetDescription","_EPDFAttachment_SetSubtype","_EPDFBookmark_AppendChild","_EPDFBookmark_Clear","_EPDFBookmark_ClearTarget","_EPDFBookmark_Create","_EPDFBookmark_Delete","_EPDFBookmark_InsertAfter","_EPDFBookmark_SetAction","_EPDFBookmark_SetDest","_EPDFBookmark_SetTitle","_EPDFCatalog_GetLanguage","_EPDFDest_CreateRemoteView","_EPDFDest_CreateRemoteXYZ","_EPDFDest_CreateView","_EPDFDest_CreateXYZ","_EPDFNamedDest_Remove","_EPDFNamedDest_SetDest","_EPDFPage_CreateAnnot","_EPDFPage_GetAnnotByName","_EPDFPage_GetAnnotCountRaw","_EPDFPage_GetAnnotRaw","_EPDFPage_RemoveAnnotByName","_EPDFPage_RemoveAnnotRaw","_EPDFText_RedactInQuads","_EPDFText_RedactInRect","_FORM_CanRedo","_FORM_CanUndo","_FORM_DoDocumentAAction","_FORM_DoDocumentJSAction","_FORM_DoDocumentOpenAction","_FORM_DoPageAAction","_FORM_ForceToKillFocus","_FORM_GetFocusedAnnot","_FORM_GetFocusedText","_FORM_GetSelectedText","_FORM_IsIndexSelected","_FORM_OnAfterLoadPage","_FORM_OnBeforeClosePage","_FORM_OnChar","_FORM_OnFocus","_FORM_OnKeyDown","_FORM_OnKeyUp","_FORM_OnLButtonDoubleClick","_FORM_OnLButtonDown","_FORM_OnLButtonUp","_FORM_OnMouseMove","_FORM_OnMouseWheel","_FORM_OnRButtonDown","_FORM_OnRButtonUp","_FORM_Redo","_FORM_ReplaceAndKeepSelection","_FORM_ReplaceSelection","_FORM_SelectAllText","_FORM_SetFocusedAnnot","_FORM_SetIndexSelected","_FORM_Undo","_FPDF_AddInstalledFont","_FPDF_CloseDocument","_FPDF_ClosePage","_FPDF_CloseXObject","_FPDF_CopyViewerPreferences","_FPDF_CountNamedDests","_FPDF_CreateClipPath","_FPDF_CreateNewDocument","_FPDF_DestroyClipPath","_FPDF_DestroyLibrary","_FPDF_DeviceToPage","_FPDF_DocumentHasValidCrossReferenceTable","_FPDF_FFLDraw","_FPDF_FreeDefaultSystemFontInfo","_FPDF_GetDefaultSystemFontInfo","_FPDF_GetDefaultTTFMap","_FPDF_GetDefaultTTFMapCount","_FPDF_GetDefaultTTFMapEntry","_FPDF_GetDocPermissions","_FPDF_GetDocUserPermissions","_FPDF_GetFileIdentifier","_FPDF_GetFileVersion","_FPDF_GetFormType","_FPDF_GetLastError","_FPDF_GetMetaText","_FPDF_GetNamedDest","_FPDF_GetNamedDestByName","_FPDF_GetPageAAction","_FPDF_GetPageBoundingBox","_FPDF_GetPageCount","_FPDF_GetPageHeight","_FPDF_GetPageHeightF","_FPDF_GetPageLabel","_FPDF_GetPageSizeByIndex","_FPDF_GetPageSizeByIndexF","_FPDF_GetPageWidth","_FPDF_GetPageWidthF","_FPDF_GetSecurityHandlerRevision","_FPDF_GetSignatureCount","_FPDF_GetSignatureObject","_FPDF_GetTrailerEnds","_FPDF_GetXFAPacketContent","_FPDF_GetXFAPacketCount","_FPDF_GetXFAPacketName","_FPDF_ImportNPagesToOne","_FPDF_ImportPages","_FPDF_ImportPagesByIndex","_FPDF_InitLibrary","_FPDF_InitLibraryWithConfig","_FPDF_LoadCustomDocument","_FPDF_LoadDocument","_FPDF_LoadMemDocument","_FPDF_LoadMemDocument64","_FPDF_LoadPage","_FPDF_LoadXFA","_FPDF_MovePages","_FPDF_NewFormObjectFromXObject","_FPDF_NewXObjectFromPage","_FPDF_PageToDevice","_FPDF_RemoveFormFieldHighlight","_FPDF_RenderPage_Close","_FPDF_RenderPage_Continue","_FPDF_RenderPageBitmap","_FPDF_RenderPageBitmap_Start","_FPDF_RenderPageBitmapWithColorScheme_Start","_FPDF_RenderPageBitmapWithMatrix","_FPDF_SaveAsCopy","_FPDF_SaveWithVersion","_FPDF_SetFormFieldHighlightAlpha","_FPDF_SetFormFieldHighlightColor","_FPDF_SetSandBoxPolicy","_FPDF_SetSystemFontInfo","_FPDF_StructElement_Attr_CountChildren","_FPDF_StructElement_Attr_GetBlobValue","_FPDF_StructElement_Attr_GetBooleanValue","_FPDF_StructElement_Attr_GetChildAtIndex","_FPDF_StructElement_Attr_GetCount","_FPDF_StructElement_Attr_GetName","_FPDF_StructElement_Attr_GetNumberValue","_FPDF_StructElement_Attr_GetStringValue","_FPDF_StructElement_Attr_GetType","_FPDF_StructElement_Attr_GetValue","_FPDF_StructElement_CountChildren","_FPDF_StructElement_GetActualText","_FPDF_StructElement_GetAltText","_FPDF_StructElement_GetAttributeAtIndex","_FPDF_StructElement_GetAttributeCount","_FPDF_StructElement_GetChildAtIndex","_FPDF_StructElement_GetChildMarkedContentID","_FPDF_StructElement_GetID","_FPDF_StructElement_GetLang","_FPDF_StructElement_GetMarkedContentID","_FPDF_StructElement_GetMarkedContentIdAtIndex","_FPDF_StructElement_GetMarkedContentIdCount","_FPDF_StructElement_GetObjType","_FPDF_StructElement_GetParent","_FPDF_StructElement_GetStringAttribute","_FPDF_StructElement_GetTitle","_FPDF_StructElement_GetType","_FPDF_StructTree_Close","_FPDF_StructTree_CountChildren","_FPDF_StructTree_GetChildAtIndex","_FPDF_StructTree_GetForPage","_FPDF_VIEWERREF_GetDuplex","_FPDF_VIEWERREF_GetName","_FPDF_VIEWERREF_GetNumCopies","_FPDF_VIEWERREF_GetPrintPageRange","_FPDF_VIEWERREF_GetPrintPageRangeCount","_FPDF_VIEWERREF_GetPrintPageRangeElement","_FPDF_VIEWERREF_GetPrintScaling","_FPDFAction_GetDest","_FPDFAction_GetFilePath","_FPDFAction_GetType","_FPDFAction_GetURIPath","_FPDFAnnot_AddFileAttachment","_FPDFAnnot_AddInkStroke","_FPDFAnnot_AppendAttachmentPoints","_FPDFAnnot_AppendObject","_FPDFAnnot_CountAttachmentPoints","_FPDFAnnot_GetAP","_FPDFAnnot_GetAttachmentPoints","_FPDFAnnot_GetBorder","_FPDFAnnot_GetColor","_FPDFAnnot_GetFileAttachment","_FPDFAnnot_GetFlags","_FPDFAnnot_GetFocusableSubtypes","_FPDFAnnot_GetFocusableSubtypesCount","_FPDFAnnot_GetFontColor","_FPDFAnnot_GetFontSize","_FPDFAnnot_GetFormAdditionalActionJavaScript","_FPDFAnnot_GetFormControlCount","_FPDFAnnot_GetFormControlIndex","_FPDFAnnot_GetFormFieldAlternateName","_FPDFAnnot_GetFormFieldAtPoint","_FPDFAnnot_GetFormFieldExportValue","_FPDFAnnot_GetFormFieldFlags","_FPDFAnnot_GetFormFieldName","_FPDFAnnot_GetFormFieldType","_FPDFAnnot_GetFormFieldValue","_FPDFAnnot_GetInkListCount","_FPDFAnnot_GetInkListPath","_FPDFAnnot_GetLine","_FPDFAnnot_GetLink","_FPDFAnnot_GetLinkedAnnot","_FPDFAnnot_GetNumberValue","_FPDFAnnot_GetObject","_FPDFAnnot_GetObjectCount","_FPDFAnnot_GetOptionCount","_FPDFAnnot_GetOptionLabel","_FPDFAnnot_GetRect","_FPDFAnnot_GetStringValue","_FPDFAnnot_GetSubtype","_FPDFAnnot_GetValueType","_FPDFAnnot_GetVertices","_FPDFAnnot_HasAttachmentPoints","_FPDFAnnot_HasKey","_FPDFAnnot_IsChecked","_FPDFAnnot_IsObjectSupportedSubtype","_FPDFAnnot_IsOptionSelected","_FPDFAnnot_IsSupportedSubtype","_FPDFAnnot_RemoveInkList","_FPDFAnnot_RemoveObject","_FPDFAnnot_SetAP","_FPDFAnnot_SetAttachmentPoints","_FPDFAnnot_SetBorder","_FPDFAnnot_SetColor","_FPDFAnnot_SetFlags","_FPDFAnnot_SetFocusableSubtypes","_FPDFAnnot_SetFontColor","_FPDFAnnot_SetFormFieldFlags","_FPDFAnnot_SetRect","_FPDFAnnot_SetStringValue","_FPDFAnnot_SetURI","_FPDFAnnot_UpdateObject","_FPDFAttachment_GetFile","_FPDFAttachment_GetName","_FPDFAttachment_GetStringValue","_FPDFAttachment_GetSubtype","_FPDFAttachment_GetValueType","_FPDFAttachment_HasKey","_FPDFAttachment_SetFile","_FPDFAttachment_SetStringValue","_FPDFAvail_Create","_FPDFAvail_Destroy","_FPDFAvail_GetDocument","_FPDFAvail_GetFirstPageNum","_FPDFAvail_IsDocAvail","_FPDFAvail_IsFormAvail","_FPDFAvail_IsLinearized","_FPDFAvail_IsPageAvail","_FPDFBitmap_Create","_FPDFBitmap_CreateEx","_FPDFBitmap_Destroy","_FPDFBitmap_FillRect","_FPDFBitmap_GetBuffer","_FPDFBitmap_GetFormat","_FPDFBitmap_GetHeight","_FPDFBitmap_GetStride","_FPDFBitmap_GetWidth","_FPDFBookmark_Find","_FPDFBookmark_GetAction","_FPDFBookmark_GetCount","_FPDFBookmark_GetDest","_FPDFBookmark_GetFirstChild","_FPDFBookmark_GetNextSibling","_FPDFBookmark_GetTitle","_FPDFCatalog_IsTagged","_FPDFCatalog_SetLanguage","_FPDFClipPath_CountPaths","_FPDFClipPath_CountPathSegments","_FPDFClipPath_GetPathSegment","_FPDFDest_GetDestPageIndex","_FPDFDest_GetLocationInPage","_FPDFDest_GetView","_FPDFDoc_AddAttachment","_FPDFDoc_CloseJavaScriptAction","_FPDFDoc_DeleteAttachment","_FPDFDOC_ExitFormFillEnvironment","_FPDFDoc_GetAttachment","_FPDFDoc_GetAttachmentCount","_FPDFDoc_GetJavaScriptAction","_FPDFDoc_GetJavaScriptActionCount","_FPDFDoc_GetPageMode","_FPDFDOC_InitFormFillEnvironment","_FPDFFont_Close","_FPDFFont_GetAscent","_FPDFFont_GetBaseFontName","_FPDFFont_GetDescent","_FPDFFont_GetFamilyName","_FPDFFont_GetFlags","_FPDFFont_GetFontData","_FPDFFont_GetGlyphPath","_FPDFFont_GetGlyphWidth","_FPDFFont_GetIsEmbedded","_FPDFFont_GetItalicAngle","_FPDFFont_GetWeight","_FPDFFormObj_CountObjects","_FPDFFormObj_GetObject","_FPDFFormObj_RemoveObject","_FPDFGlyphPath_CountGlyphSegments","_FPDFGlyphPath_GetGlyphPathSegment","_FPDFImageObj_GetBitmap","_FPDFImageObj_GetIccProfileDataDecoded","_FPDFImageObj_GetImageDataDecoded","_FPDFImageObj_GetImageDataRaw","_FPDFImageObj_GetImageFilter","_FPDFImageObj_GetImageFilterCount","_FPDFImageObj_GetImageMetadata","_FPDFImageObj_GetImagePixelSize","_FPDFImageObj_GetRenderedBitmap","_FPDFImageObj_LoadJpegFile","_FPDFImageObj_LoadJpegFileInline","_FPDFImageObj_SetBitmap","_FPDFImageObj_SetMatrix","_FPDFJavaScriptAction_GetName","_FPDFJavaScriptAction_GetScript","_FPDFLink_CloseWebLinks","_FPDFLink_CountQuadPoints","_FPDFLink_CountRects","_FPDFLink_CountWebLinks","_FPDFLink_Enumerate","_FPDFLink_GetAction","_FPDFLink_GetAnnot","_FPDFLink_GetAnnotRect","_FPDFLink_GetDest","_FPDFLink_GetLinkAtPoint","_FPDFLink_GetLinkZOrderAtPoint","_FPDFLink_GetQuadPoints","_FPDFLink_GetRect","_FPDFLink_GetTextRange","_FPDFLink_GetURL","_FPDFLink_LoadWebLinks","_FPDFPage_CloseAnnot","_FPDFPage_CountObjects","_FPDFPage_CreateAnnot","_FPDFPage_Delete","_FPDFPage_Flatten","_FPDFPage_FormFieldZOrderAtPoint","_FPDFPage_GenerateContent","_FPDFPage_GetAnnot","_FPDFPage_GetAnnotCount","_FPDFPage_GetAnnotIndex","_FPDFPage_GetArtBox","_FPDFPage_GetBleedBox","_FPDFPage_GetCropBox","_FPDFPage_GetDecodedThumbnailData","_FPDFPage_GetMediaBox","_FPDFPage_GetObject","_FPDFPage_GetRawThumbnailData","_FPDFPage_GetRotation","_FPDFPage_GetThumbnailAsBitmap","_FPDFPage_GetTrimBox","_FPDFPage_HasFormFieldAtPoint","_FPDFPage_HasTransparency","_FPDFPage_InsertClipPath","_FPDFPage_InsertObject","_FPDFPage_InsertObjectAtIndex","_FPDFPage_New","_FPDFPage_RemoveAnnot","_FPDFPage_RemoveObject","_FPDFPage_SetArtBox","_FPDFPage_SetBleedBox","_FPDFPage_SetCropBox","_FPDFPage_SetMediaBox","_FPDFPage_SetRotation","_FPDFPage_SetTrimBox","_FPDFPage_TransformAnnots","_FPDFPage_TransFormWithClip","_FPDFPageObj_AddMark","_FPDFPageObj_CountMarks","_FPDFPageObj_CreateNewPath","_FPDFPageObj_CreateNewRect","_FPDFPageObj_CreateTextObj","_FPDFPageObj_Destroy","_FPDFPageObj_GetBounds","_FPDFPageObj_GetClipPath","_FPDFPageObj_GetDashArray","_FPDFPageObj_GetDashCount","_FPDFPageObj_GetDashPhase","_FPDFPageObj_GetFillColor","_FPDFPageObj_GetIsActive","_FPDFPageObj_GetLineCap","_FPDFPageObj_GetLineJoin","_FPDFPageObj_GetMark","_FPDFPageObj_GetMarkedContentID","_FPDFPageObj_GetMatrix","_FPDFPageObj_GetRotatedBounds","_FPDFPageObj_GetStrokeColor","_FPDFPageObj_GetStrokeWidth","_FPDFPageObj_GetType","_FPDFPageObj_HasTransparency","_FPDFPageObj_NewImageObj","_FPDFPageObj_NewTextObj","_FPDFPageObj_RemoveMark","_FPDFPageObj_SetBlendMode","_FPDFPageObj_SetDashArray","_FPDFPageObj_SetDashPhase","_FPDFPageObj_SetFillColor","_FPDFPageObj_SetIsActive","_FPDFPageObj_SetLineCap","_FPDFPageObj_SetLineJoin","_FPDFPageObj_SetMatrix","_FPDFPageObj_SetStrokeColor","_FPDFPageObj_SetStrokeWidth","_FPDFPageObj_Transform","_FPDFPageObj_TransformClipPath","_FPDFPageObj_TransformF","_FPDFPageObjMark_CountParams","_FPDFPageObjMark_GetName","_FPDFPageObjMark_GetParamBlobValue","_FPDFPageObjMark_GetParamIntValue","_FPDFPageObjMark_GetParamKey","_FPDFPageObjMark_GetParamStringValue","_FPDFPageObjMark_GetParamValueType","_FPDFPageObjMark_RemoveParam","_FPDFPageObjMark_SetBlobParam","_FPDFPageObjMark_SetIntParam","_FPDFPageObjMark_SetStringParam","_FPDFPath_BezierTo","_FPDFPath_Close","_FPDFPath_CountSegments","_FPDFPath_GetDrawMode","_FPDFPath_GetPathSegment","_FPDFPath_LineTo","_FPDFPath_MoveTo","_FPDFPath_SetDrawMode","_FPDFPathSegment_GetClose","_FPDFPathSegment_GetPoint","_FPDFPathSegment_GetType","_FPDFSignatureObj_GetByteRange","_FPDFSignatureObj_GetContents","_FPDFSignatureObj_GetDocMDPPermission","_FPDFSignatureObj_GetReason","_FPDFSignatureObj_GetSubFilter","_FPDFSignatureObj_GetTime","_FPDFText_ClosePage","_FPDFText_CountChars","_FPDFText_CountRects","_FPDFText_FindClose","_FPDFText_FindNext","_FPDFText_FindPrev","_FPDFText_FindStart","_FPDFText_GetBoundedText","_FPDFText_GetCharAngle","_FPDFText_GetCharBox","_FPDFText_GetCharIndexAtPos","_FPDFText_GetCharIndexFromTextIndex","_FPDFText_GetCharOrigin","_FPDFText_GetFillColor","_FPDFText_GetFontInfo","_FPDFText_GetFontSize","_FPDFText_GetFontWeight","_FPDFText_GetLooseCharBox","_FPDFText_GetMatrix","_FPDFText_GetRect","_FPDFText_GetSchCount","_FPDFText_GetSchResultIndex","_FPDFText_GetStrokeColor","_FPDFText_GetText","_FPDFText_GetTextIndexFromCharIndex","_FPDFText_GetTextObject","_FPDFText_GetUnicode","_FPDFText_HasUnicodeMapError","_FPDFText_IsGenerated","_FPDFText_IsHyphen","_FPDFText_LoadCidType2Font","_FPDFText_LoadFont","_FPDFText_LoadPage","_FPDFText_LoadStandardFont","_FPDFText_SetCharcodes","_FPDFText_SetText","_FPDFTextObj_GetFont","_FPDFTextObj_GetFontSize","_FPDFTextObj_GetRenderedBitmap","_FPDFTextObj_GetText","_FPDFTextObj_GetTextRenderMode","_FPDFTextObj_SetTextRenderMode","_PDFiumExt_CloseFileWriter","_PDFiumExt_CloseFormFillInfo","_PDFiumExt_ExitFormFillEnvironment","_PDFiumExt_GetFileWriterData","_PDFiumExt_GetFileWriterSize","_PDFiumExt_Init","_PDFiumExt_InitFormFillEnvironment","_PDFiumExt_OpenFileWriter","_PDFiumExt_OpenFormFillInfo","_PDFiumExt_SaveAsCopy","_malloc","_free","_memory","___indirect_function_table","onRuntimeInitialized"].forEach(t=>{Object.getOwnPropertyDescriptor(F,t)||Object.defineProperty(F,t,{get:()=>Z("You are getting "+t+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js"),set:()=>Z("You are setting "+t+" on the Promise object, instead of the instance. Use .then() to get called back with the instance, see the MODULARIZE docs in src/settings.js")})});var d=typeof window=="object",_=typeof importScripts=="function";typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string"&&process.type!="renderer";var P=!d&&!0&&!_,h=Object.assign({},e),b="./this.program",A="";function M(t){return e.locateFile?e.locateFile(t,A):A+t}var y,S;if(P){if(typeof window=="object"||typeof importScripts=="function")throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");S=t=>{if(typeof readbuffer=="function")return new Uint8Array(readbuffer(t));let o=read(t,"binary");return C(typeof o=="object"),o},y=t=>new Promise((o,s)=>{setTimeout(()=>o(S(t)))}),globalThis.clearTimeout??(globalThis.clearTimeout=t=>{}),globalThis.setTimeout??(globalThis.setTimeout=t=>typeof t=="function"?t():Z()),typeof print<"u"&&(globalThis.console??(globalThis.console={}),console.log=print,console.warn=console.error=globalThis.printErr??print)}else if(d||_){if(_?A=self.location.href:typeof document<"u"&&document.currentScript&&(A=document.currentScript.src),W&&(A=W),A.startsWith("blob:")?A="":A=A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1),!(typeof window=="object"||typeof importScripts=="function"))throw new Error("not compiled for this environment (did you build to HTML and try to run it not on the web, or set ENVIRONMENT to something - like node - and run it someplace else - like on the web?)");_&&(S=t=>{var o=new XMLHttpRequest;return o.open("GET",t,!1),o.responseType="arraybuffer",o.send(null),new Uint8Array(o.response)}),y=t=>(C(!St(t),"readAsync does not work with file:// URLs"),fetch(t,{credentials:"same-origin"}).then(o=>o.ok?o.arrayBuffer():Promise.reject(new Error(o.status+" : "+o.url))))}else throw new Error("environment detection error");var x=e.print||console.log.bind(console),v=e.printErr||console.error.bind(console);Object.assign(e,h),h=null,Cr(),e.arguments&&e.arguments,xe("arguments","arguments_"),e.thisProgram&&(b=e.thisProgram),xe("thisProgram","thisProgram"),C(typeof e.memoryInitializerPrefixURL>"u","Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),C(typeof e.pthreadMainPrefixURL>"u","Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),C(typeof e.cdInitializerPrefixURL>"u","Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),C(typeof e.filePackagePrefixURL>"u","Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),C(typeof e.read>"u","Module.read option was removed"),C(typeof e.readAsync>"u","Module.readAsync option was removed (modify readAsync in JS)"),C(typeof e.readBinary>"u","Module.readBinary option was removed (modify readBinary in JS)"),C(typeof e.setWindowTitle>"u","Module.setWindowTitle option was removed (modify emscripten_set_window_title in JS)"),C(typeof e.TOTAL_MEMORY>"u","Module.TOTAL_MEMORY has been renamed Module.INITIAL_MEMORY"),xe("asm","wasmExports"),xe("readAsync","readAsync"),xe("readBinary","readBinary"),xe("setWindowTitle","setWindowTitle");var I=e.wasmBinary;xe("wasmBinary","wasmBinary"),typeof WebAssembly!="object"&&v("no native wasm support detected");var B,Y=!1;function C(t,o){t||Z("Assertion failed"+(o?": "+o:""))}var H,te,X,re,k,K,me,Ce;function ue(){var t=B.buffer;e.HEAP8=H=new Int8Array(t),e.HEAP16=X=new Int16Array(t),e.HEAPU8=te=new Uint8Array(t),e.HEAPU16=re=new Uint16Array(t),e.HEAP32=k=new Int32Array(t),e.HEAPU32=K=new Uint32Array(t),e.HEAPF32=me=new Float32Array(t),e.HEAPF64=Ce=new Float64Array(t)}C(!e.STACK_SIZE,"STACK_SIZE can no longer be set at runtime.  Use -sSTACK_SIZE at link time"),C(typeof Int32Array<"u"&&typeof Float64Array<"u"&&Int32Array.prototype.subarray!=null&&Int32Array.prototype.set!=null,"JS engine does not provide full typed array support"),C(!e.wasmMemory,"Use of `wasmMemory` detected.  Use -sIMPORTED_MEMORY to define wasmMemory externally"),C(!e.INITIAL_MEMORY,"Detected runtime INITIAL_MEMORY setting.  Use -sIMPORTED_MEMORY to define wasmMemory dynamically");function fe(){var t=Pt();C((t&3)==0),t==0&&(t+=4),K[t>>2]=34821223,K[t+4>>2]=2310721022,K[0]=1668509029}function oe(){if(!Y){var t=Pt();t==0&&(t+=4);var o=K[t>>2],s=K[t+4>>2];(o!=34821223||s!=2310721022)&&Z(`Stack overflow! Stack cookie has been overwritten at ${Ye(t)}, expected hex dwords 0x89BACDFE and 0x2135467, but received ${Ye(s)} ${Ye(o)}`),K[0]!=1668509029&&Z("Runtime error: The application has corrupted its heap memory area (address zero)!")}}var Fe=[],Qe=[],Ze=[],Ie=!1;function At(){var t=e.preRun;t&&(typeof t=="function"&&(t=[t]),t.forEach(un)),ut(Fe)}function Et(){C(!Ie),Ie=!0,oe(),!e.noFSInit&&!l.initialized&&l.init(),l.ignorePermissions=!1,ut(Qe)}function sn(){oe();var t=e.postRun;t&&(typeof t=="function"&&(t=[t]),t.forEach(Fn)),ut(Ze)}function un(t){Fe.unshift(t)}function mn(t){Qe.unshift(t)}function Fn(t){Ze.unshift(t)}C(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),C(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),C(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),C(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill");var ve=0,Te=null,He=null,je={};function yt(t){for(var o=t;;){if(!je[t])return t;t=o+Math.random()}}function st(t){var o;ve++,(o=e.monitorRunDependencies)==null||o.call(e,ve),t?(C(!je[t]),je[t]=1,Te===null&&typeof setInterval<"u"&&(Te=setInterval(()=>{if(Y){clearInterval(Te),Te=null;return}var s=!1;for(var m in je)s||(s=!0,v("still waiting on run dependencies:")),v(`dependency: ${m}`);s&&v("(end of list)")},1e4))):v("warning: run dependency added without ID")}function et(t){var s;if(ve--,(s=e.monitorRunDependencies)==null||s.call(e,ve),t?(C(je[t]),delete je[t]):v("warning: run dependency removed without ID"),ve==0&&(Te!==null&&(clearInterval(Te),Te=null),He)){var o=He;He=null,o()}}function Z(t){var s;(s=e.onAbort)==null||s.call(e,t),t="Aborted("+t+")",v(t),Y=!0;var o=new WebAssembly.RuntimeError(t);throw u(o),o}var ln="data:application/octet-stream;base64,",Mt=t=>t.startsWith(ln),St=t=>t.startsWith("file://");function a(t,o){return(...s)=>{C(Ie,`native function \`${t}\` called before runtime initialization`);var m=le[t];return C(m,`exported native function \`${t}\` not found`),C(s.length<=o,`native function \`${t}\` called with ${s.length} args but expects ${o}`),m(...s)}}function dn(){if(e.locateFile){var t="pdfium.wasm";return Mt(t)?t:M(t)}return P?"pdfium.wasm":new URL("/assets/pdfium-B8f0vBaD.wasm",import.meta.url).href}var $e;function Gt(t){if(t==$e&&I)return new Uint8Array(I);if(S)return S(t);throw"both async and sync fetching of the wasm failed"}function cn(t){return I?Promise.resolve().then(()=>Gt(t)):y(t).then(o=>new Uint8Array(o),()=>Gt(t))}function Ct(t,o,s){return cn(t).then(m=>WebAssembly.instantiate(m,o)).then(s,m=>{v(`failed to asynchronously prepare wasm: ${m}`),St($e)&&v(`warning: Loading from a file URI (${$e}) is not supported in most browsers. See https://emscripten.org/docs/getting_started/FAQ.html#how-do-i-run-a-local-webserver-for-testing-why-does-my-program-stall-in-downloading-or-preparing`),Z(m)})}function _n(t,o,s,m){return!t&&typeof WebAssembly.instantiateStreaming=="function"&&!Mt(o)&&typeof fetch=="function"?fetch(o,{credentials:"same-origin"}).then(c=>{var g=WebAssembly.instantiateStreaming(c,s);return g.then(m,function(p){return v(`wasm streaming compile failed: ${p}`),v("falling back to ArrayBuffer instantiation"),Ct(o,s,m)})}):Ct(o,s,m)}function Pn(){return{env:Wt,wasi_snapshot_preview1:Wt}}function gn(){var t=Pn();function o(c,g){return le=c.exports,e.wasmExports=le,B=le.memory,C(B,"memory not found in wasm exports"),ue(),Me=le.__indirect_function_table,C(Me,"table not found in wasm exports"),mn(le.__wasm_call_ctors),et("wasm-instantiate"),le}st("wasm-instantiate");var s=e;function m(c){C(e===s,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),s=null,o(c.instance)}if(e.instantiateWasm)try{return e.instantiateWasm(t,o)}catch(c){v(`Module.instantiateWasm callback failed with error: ${c}`),u(c)}return $e??($e=dn()),_n(I,$e,t,m).catch(u),{}}var L,ee;if((()=>{var t=new Int16Array(1),o=new Int8Array(t.buffer);if(t[0]=25459,o[0]!==115||o[1]!==99)throw"Runtime error: expected the system to be little-endian! (Run with -sSUPPORT_BIG_ENDIAN to bypass)"})(),e.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -sENVIRONMENT=web or -sENVIRONMENT=node)");function xe(t,o,s=!0){Object.getOwnPropertyDescriptor(e,t)||Object.defineProperty(e,t,{configurable:!0,get(){let m=s?" (the initial value can be provided on Module, but after startup the value is only looked for on a local variable of that name)":"";Z(`\`Module.${t}\` has been replaced by \`${o}\``+m)}})}function hn(t){Object.getOwnPropertyDescriptor(e,t)&&Z(`\`Module.${t}\` was supplied but \`${t}\` not included in INCOMING_MODULE_JS_API`)}function vt(t){return t==="FS_createPath"||t==="FS_createDataFile"||t==="FS_createPreloadedFile"||t==="FS_unlink"||t==="addRunDependency"||t==="FS_createLazyFile"||t==="FS_createDevice"||t==="removeRunDependency"}function Tt(t,o){typeof globalThis<"u"&&!Object.getOwnPropertyDescriptor(globalThis,t)&&Object.defineProperty(globalThis,t,{configurable:!0,get(){o()}})}function xt(t,o){Tt(t,()=>{Ee(`\`${t}\` is not longer defined by emscripten. ${o}`)})}xt("buffer","Please use HEAP8.buffer or wasmMemory.buffer"),xt("asm","Please use wasmExports instead");function fn(t){Tt(t,()=>{var o=`\`${t}\` is a library symbol and not included by default; add it to your library.js __deps or to DEFAULT_LIBRARY_FUNCS_TO_INCLUDE on the command line`,s=t;s.startsWith("_")||(s="$"+t),o+=` (e.g. -sDEFAULT_LIBRARY_FUNCS_TO_INCLUDE='${s}')`,vt(t)&&(o+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),Ee(o)}),Ot(t)}function Ot(t){Object.getOwnPropertyDescriptor(e,t)||Object.defineProperty(e,t,{configurable:!0,get(){var o=`'${t}' was not exported. add it to EXPORTED_RUNTIME_METHODS (see the Emscripten FAQ)`;vt(t)&&(o+=". Alternatively, forcing filesystem support (-sFORCE_FILESYSTEM) can export this for you"),Z(o)}})}var ut=t=>{t.forEach(o=>o(e))};function Dn(t,o="i8"){switch(o.endsWith("*")&&(o="*"),o){case"i1":return H[t];case"i8":return H[t];case"i16":return X[t>>1];case"i32":return k[t>>2];case"i64":Z("to do getValue(i64) use WASM_BIGINT");case"float":return me[t>>2];case"double":return Ce[t>>3];case"*":return K[t>>2];default:Z(`invalid type for getValue: ${o}`)}}e.noExitRuntime;var Ye=t=>(C(typeof t=="number"),t>>>=0,"0x"+t.toString(16).padStart(8,"0"));function bn(t,o,s="i8"){switch(s.endsWith("*")&&(s="*"),s){case"i1":H[t]=o;break;case"i8":H[t]=o;break;case"i16":X[t>>1]=o;break;case"i32":k[t>>2]=o;break;case"i64":Z("to do setValue(i64) use WASM_BIGINT");case"float":me[t>>2]=o;break;case"double":Ce[t>>3]=o;break;case"*":K[t>>2]=o;break;default:Z(`invalid type for setValue: ${s}`)}}var De=t=>Ht(t),be=()=>Yt(),Ee=t=>{Ee.shown||(Ee.shown={}),Ee.shown[t]||(Ee.shown[t]=1,v(t))},kt=typeof TextDecoder<"u"?new TextDecoder:void 0,Be=(t,o=0,s=NaN)=>{for(var m=o+s,c=o;t[c]&&!(c>=m);)++c;if(c-o>16&&t.buffer&&kt)return kt.decode(t.subarray(o,c));for(var g="";o<c;){var p=t[o++];if(!(p&128)){g+=String.fromCharCode(p);continue}var E=t[o++]&63;if((p&224)==192){g+=String.fromCharCode((p&31)<<6|E);continue}var T=t[o++]&63;if((p&240)==224?p=(p&15)<<12|E<<6|T:((p&248)!=240&&Ee("Invalid UTF-8 leading byte "+Ye(p)+" encountered when deserializing a UTF-8 string in wasm memory to a JS string!"),p=(p&7)<<18|E<<12|T<<6|t[o++]&63),p<65536)g+=String.fromCharCode(p);else{var j=p-65536;g+=String.fromCharCode(55296|j>>10,56320|j&1023)}}return g},Oe=(t,o)=>(C(typeof t=="number",`UTF8ToString expects a number (got ${typeof t})`),t?Be(te,t,o):""),pn=(t,o,s,m)=>{Z(`Assertion failed: ${Oe(t)}, at: `+[o?Oe(o):"unknown filename",s,m?Oe(m):"unknown function"])};function tt(){C(J.varargs!=null);var t=k[+J.varargs>>2];return J.varargs+=4,t}var Le=tt,Q={isAbs:t=>t.charAt(0)==="/",splitPath:t=>{var o=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/;return o.exec(t).slice(1)},normalizeArray:(t,o)=>{for(var s=0,m=t.length-1;m>=0;m--){var c=t[m];c==="."?t.splice(m,1):c===".."?(t.splice(m,1),s++):s&&(t.splice(m,1),s--)}if(o)for(;s;s--)t.unshift("..");return t},normalize:t=>{var o=Q.isAbs(t),s=t.substr(-1)==="/";return t=Q.normalizeArray(t.split("/").filter(m=>!!m),!o).join("/"),!t&&!o&&(t="."),t&&s&&(t+="/"),(o?"/":"")+t},dirname:t=>{var o=Q.splitPath(t),s=o[0],m=o[1];return!s&&!m?".":(m&&(m=m.substr(0,m.length-1)),s+m)},basename:t=>{if(t==="/")return"/";t=Q.normalize(t),t=t.replace(/\/$/,"");var o=t.lastIndexOf("/");return o===-1?t:t.substr(o+1)},join:(...t)=>Q.normalize(t.join("/")),join2:(t,o)=>Q.normalize(t+"/"+o)},An=()=>{if(typeof crypto=="object"&&typeof crypto.getRandomValues=="function")return t=>crypto.getRandomValues(t);Z("no cryptographic support found for randomDevice. consider polyfilling it if you want to use something insecure like Math.random(), e.g. put this in a --pre-js: var crypto = { getRandomValues: (array) => { for (var i = 0; i < array.length; i++) array[i] = (Math.random()*256)|0 } };")},wt=t=>(wt=An())(t),ye={resolve:(...t)=>{for(var o="",s=!1,m=t.length-1;m>=-1&&!s;m--){var c=m>=0?t[m]:l.cwd();if(typeof c!="string")throw new TypeError("Arguments to path.resolve must be strings");if(!c)return"";o=c+"/"+o,s=Q.isAbs(c)}return o=Q.normalizeArray(o.split("/").filter(g=>!!g),!s).join("/"),(s?"/":"")+o||"."},relative:(t,o)=>{t=ye.resolve(t).substr(1),o=ye.resolve(o).substr(1);function s(j){for(var V=0;V<j.length&&j[V]==="";V++);for(var U=j.length-1;U>=0&&j[U]==="";U--);return V>U?[]:j.slice(V,U-V+1)}for(var m=s(t.split("/")),c=s(o.split("/")),g=Math.min(m.length,c.length),p=g,E=0;E<g;E++)if(m[E]!==c[E]){p=E;break}for(var T=[],E=p;E<m.length;E++)T.push("..");return T=T.concat(c.slice(p)),T.join("/")}},mt=[],Xe=t=>{for(var o=0,s=0;s<t.length;++s){var m=t.charCodeAt(s);m<=127?o++:m<=2047?o+=2:m>=55296&&m<=57343?(o+=4,++s):o+=3}return o},Ft=(t,o,s,m)=>{if(C(typeof t=="string",`stringToUTF8Array expects a string (got ${typeof t})`),!(m>0))return 0;for(var c=s,g=s+m-1,p=0;p<t.length;++p){var E=t.charCodeAt(p);if(E>=55296&&E<=57343){var T=t.charCodeAt(++p);E=65536+((E&1023)<<10)|T&1023}if(E<=127){if(s>=g)break;o[s++]=E}else if(E<=2047){if(s+1>=g)break;o[s++]=192|E>>6,o[s++]=128|E&63}else if(E<=65535){if(s+2>=g)break;o[s++]=224|E>>12,o[s++]=128|E>>6&63,o[s++]=128|E&63}else{if(s+3>=g)break;E>1114111&&Ee("Invalid Unicode code point "+Ye(E)+" encountered when serializing a JS string to a UTF-8 string in wasm memory! (Valid unicode code points should be in range 0-0x10FFFF)."),o[s++]=240|E>>18,o[s++]=128|E>>12&63,o[s++]=128|E>>6&63,o[s++]=128|E&63}}return o[s]=0,s-c};function Rt(t,o,s){var m=Xe(t)+1,c=new Array(m),g=Ft(t,c,0,c.length);return c.length=g,c}var En=()=>{if(!mt.length){var t=null;if(typeof window<"u"&&typeof window.prompt=="function"?(t=window.prompt("Input: "),t!==null&&(t+=`
`)):typeof readline=="function"&&(t=readline(),t&&(t+=`
`)),!t)return null;mt=Rt(t)}return mt.shift()},ke={ttys:[],init(){},shutdown(){},register(t,o){ke.ttys[t]={input:[],output:[],ops:o},l.registerDevice(t,ke.stream_ops)},stream_ops:{open(t){var o=ke.ttys[t.node.rdev];if(!o)throw new l.ErrnoError(43);t.tty=o,t.seekable=!1},close(t){t.tty.ops.fsync(t.tty)},fsync(t){t.tty.ops.fsync(t.tty)},read(t,o,s,m,c){if(!t.tty||!t.tty.ops.get_char)throw new l.ErrnoError(60);for(var g=0,p=0;p<m;p++){var E;try{E=t.tty.ops.get_char(t.tty)}catch{throw new l.ErrnoError(29)}if(E===void 0&&g===0)throw new l.ErrnoError(6);if(E==null)break;g++,o[s+p]=E}return g&&(t.node.timestamp=Date.now()),g},write(t,o,s,m,c){if(!t.tty||!t.tty.ops.put_char)throw new l.ErrnoError(60);try{for(var g=0;g<m;g++)t.tty.ops.put_char(t.tty,o[s+g])}catch{throw new l.ErrnoError(29)}return m&&(t.node.timestamp=Date.now()),g}},default_tty_ops:{get_char(t){return En()},put_char(t,o){o===null||o===10?(x(Be(t.output)),t.output=[]):o!=0&&t.output.push(o)},fsync(t){t.output&&t.output.length>0&&(x(Be(t.output)),t.output=[])},ioctl_tcgets(t){return{c_iflag:25856,c_oflag:5,c_cflag:191,c_lflag:35387,c_cc:[3,28,127,21,4,0,1,0,17,19,26,0,18,15,23,22,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}},ioctl_tcsets(t,o,s){return 0},ioctl_tiocgwinsz(t){return[24,80]}},default_tty1_ops:{put_char(t,o){o===null||o===10?(v(Be(t.output)),t.output=[]):o!=0&&t.output.push(o)},fsync(t){t.output&&t.output.length>0&&(v(Be(t.output)),t.output=[])}}},yn=(t,o)=>{te.fill(0,t,t+o)},It=(t,o)=>(C(o,"alignment argument is required"),Math.ceil(t/o)*o),jt=t=>{t=It(t,65536);var o=Tr(65536,t);return o&&yn(o,t),o},z={ops_table:null,mount(t){return z.createNode(null,"/",16895,0)},createNode(t,o,s,m){if(l.isBlkdev(s)||l.isFIFO(s))throw new l.ErrnoError(63);z.ops_table||(z.ops_table={dir:{node:{getattr:z.node_ops.getattr,setattr:z.node_ops.setattr,lookup:z.node_ops.lookup,mknod:z.node_ops.mknod,rename:z.node_ops.rename,unlink:z.node_ops.unlink,rmdir:z.node_ops.rmdir,readdir:z.node_ops.readdir,symlink:z.node_ops.symlink},stream:{llseek:z.stream_ops.llseek}},file:{node:{getattr:z.node_ops.getattr,setattr:z.node_ops.setattr},stream:{llseek:z.stream_ops.llseek,read:z.stream_ops.read,write:z.stream_ops.write,allocate:z.stream_ops.allocate,mmap:z.stream_ops.mmap,msync:z.stream_ops.msync}},link:{node:{getattr:z.node_ops.getattr,setattr:z.node_ops.setattr,readlink:z.node_ops.readlink},stream:{}},chrdev:{node:{getattr:z.node_ops.getattr,setattr:z.node_ops.setattr},stream:l.chrdev_stream_ops}});var c=l.createNode(t,o,s,m);return l.isDir(c.mode)?(c.node_ops=z.ops_table.dir.node,c.stream_ops=z.ops_table.dir.stream,c.contents={}):l.isFile(c.mode)?(c.node_ops=z.ops_table.file.node,c.stream_ops=z.ops_table.file.stream,c.usedBytes=0,c.contents=null):l.isLink(c.mode)?(c.node_ops=z.ops_table.link.node,c.stream_ops=z.ops_table.link.stream):l.isChrdev(c.mode)&&(c.node_ops=z.ops_table.chrdev.node,c.stream_ops=z.ops_table.chrdev.stream),c.timestamp=Date.now(),t&&(t.contents[o]=c,t.timestamp=c.timestamp),c},getFileDataAsTypedArray(t){return t.contents?t.contents.subarray?t.contents.subarray(0,t.usedBytes):new Uint8Array(t.contents):new Uint8Array(0)},expandFileStorage(t,o){var s=t.contents?t.contents.length:0;if(!(s>=o)){var m=1024*1024;o=Math.max(o,s*(s<m?2:1.125)>>>0),s!=0&&(o=Math.max(o,256));var c=t.contents;t.contents=new Uint8Array(o),t.usedBytes>0&&t.contents.set(c.subarray(0,t.usedBytes),0)}},resizeFileStorage(t,o){if(t.usedBytes!=o)if(o==0)t.contents=null,t.usedBytes=0;else{var s=t.contents;t.contents=new Uint8Array(o),s&&t.contents.set(s.subarray(0,Math.min(o,t.usedBytes))),t.usedBytes=o}},node_ops:{getattr(t){var o={};return o.dev=l.isChrdev(t.mode)?t.id:1,o.ino=t.id,o.mode=t.mode,o.nlink=1,o.uid=0,o.gid=0,o.rdev=t.rdev,l.isDir(t.mode)?o.size=4096:l.isFile(t.mode)?o.size=t.usedBytes:l.isLink(t.mode)?o.size=t.link.length:o.size=0,o.atime=new Date(t.timestamp),o.mtime=new Date(t.timestamp),o.ctime=new Date(t.timestamp),o.blksize=4096,o.blocks=Math.ceil(o.size/o.blksize),o},setattr(t,o){o.mode!==void 0&&(t.mode=o.mode),o.timestamp!==void 0&&(t.timestamp=o.timestamp),o.size!==void 0&&z.resizeFileStorage(t,o.size)},lookup(t,o){throw l.genericErrors[44]},mknod(t,o,s,m){return z.createNode(t,o,s,m)},rename(t,o,s){if(l.isDir(t.mode)){var m;try{m=l.lookupNode(o,s)}catch{}if(m)for(var c in m.contents)throw new l.ErrnoError(55)}delete t.parent.contents[t.name],t.parent.timestamp=Date.now(),t.name=s,o.contents[s]=t,o.timestamp=t.parent.timestamp},unlink(t,o){delete t.contents[o],t.timestamp=Date.now()},rmdir(t,o){var s=l.lookupNode(t,o);for(var m in s.contents)throw new l.ErrnoError(55);delete t.contents[o],t.timestamp=Date.now()},readdir(t){var o=[".",".."];for(var s of Object.keys(t.contents))o.push(s);return o},symlink(t,o,s){var m=z.createNode(t,o,41471,0);return m.link=s,m},readlink(t){if(!l.isLink(t.mode))throw new l.ErrnoError(28);return t.link}},stream_ops:{read(t,o,s,m,c){var g=t.node.contents;if(c>=t.node.usedBytes)return 0;var p=Math.min(t.node.usedBytes-c,m);if(C(p>=0),p>8&&g.subarray)o.set(g.subarray(c,c+p),s);else for(var E=0;E<p;E++)o[s+E]=g[c+E];return p},write(t,o,s,m,c,g){if(C(!(o instanceof ArrayBuffer)),o.buffer===H.buffer&&(g=!1),!m)return 0;var p=t.node;if(p.timestamp=Date.now(),o.subarray&&(!p.contents||p.contents.subarray)){if(g)return C(c===0,"canOwn must imply no weird position inside the file"),p.contents=o.subarray(s,s+m),p.usedBytes=m,m;if(p.usedBytes===0&&c===0)return p.contents=o.slice(s,s+m),p.usedBytes=m,m;if(c+m<=p.usedBytes)return p.contents.set(o.subarray(s,s+m),c),m}if(z.expandFileStorage(p,c+m),p.contents.subarray&&o.subarray)p.contents.set(o.subarray(s,s+m),c);else for(var E=0;E<m;E++)p.contents[c+E]=o[s+E];return p.usedBytes=Math.max(p.usedBytes,c+m),m},llseek(t,o,s){var m=o;if(s===1?m+=t.position:s===2&&l.isFile(t.node.mode)&&(m+=t.node.usedBytes),m<0)throw new l.ErrnoError(28);return m},allocate(t,o,s){z.expandFileStorage(t.node,o+s),t.node.usedBytes=Math.max(t.node.usedBytes,o+s)},mmap(t,o,s,m,c){if(!l.isFile(t.node.mode))throw new l.ErrnoError(43);var g,p,E=t.node.contents;if(!(c&2)&&E&&E.buffer===H.buffer)p=!1,g=E.byteOffset;else{if(p=!0,g=jt(o),!g)throw new l.ErrnoError(48);E&&((s>0||s+o<E.length)&&(E.subarray?E=E.subarray(s,s+o):E=Array.prototype.slice.call(E,s,s+o)),H.set(E,g))}return{ptr:g,allocated:p}},msync(t,o,s,m,c){return z.stream_ops.write(t,o,0,m,s,!1),0}}},Mn=(t,o,s,m)=>{var c=yt(`al ${t}`);y(t).then(g=>{C(g,`Loading data file "${t}" failed (no arrayBuffer).`),o(new Uint8Array(g)),c&&et(c)},g=>{if(s)s();else throw`Loading data file "${t}" failed.`}),c&&st(c)},Sn=(t,o,s,m,c,g)=>{l.createDataFile(t,o,s,m,c,g)},Gn=e.preloadPlugins||[],Cn=(t,o,s,m)=>{typeof Browser<"u"&&Browser.init();var c=!1;return Gn.forEach(g=>{c||g.canHandle(o)&&(g.handle(t,o,s,m),c=!0)}),c},vn=(t,o,s,m,c,g,p,E,T,j)=>{var V=o?ye.resolve(Q.join2(t,o)):t,U=yt(`cp ${V}`);function $(w){function N(q){j==null||j(),E||Sn(t,o,q,m,c,T),g==null||g(),et(U)}Cn(w,V,N,()=>{p==null||p(),et(U)})||N(w)}st(U),typeof s=="string"?Mn(s,$,p):$(s)},Tn=t=>{var o={r:0,"r+":2,w:577,"w+":578,a:1089,"a+":1090},s=o[t];if(typeof s>"u")throw new Error(`Unknown file open mode: ${t}`);return s},lt=(t,o)=>{var s=0;return t&&(s|=365),o&&(s|=146),s},xn=t=>Oe(xr(t)),Bt={EPERM:63,ENOENT:44,ESRCH:71,EINTR:27,EIO:29,ENXIO:60,E2BIG:1,ENOEXEC:45,EBADF:8,ECHILD:12,EAGAIN:6,EWOULDBLOCK:6,ENOMEM:48,EACCES:2,EFAULT:21,ENOTBLK:105,EBUSY:10,EEXIST:20,EXDEV:75,ENODEV:43,ENOTDIR:54,EISDIR:31,EINVAL:28,ENFILE:41,EMFILE:33,ENOTTY:59,ETXTBSY:74,EFBIG:22,ENOSPC:51,ESPIPE:70,EROFS:69,EMLINK:34,EPIPE:64,EDOM:18,ERANGE:68,ENOMSG:49,EIDRM:24,ECHRNG:106,EL2NSYNC:156,EL3HLT:107,EL3RST:108,ELNRNG:109,EUNATCH:110,ENOCSI:111,EL2HLT:112,EDEADLK:16,ENOLCK:46,EBADE:113,EBADR:114,EXFULL:115,ENOANO:104,EBADRQC:103,EBADSLT:102,EDEADLOCK:16,EBFONT:101,ENOSTR:100,ENODATA:116,ETIME:117,ENOSR:118,ENONET:119,ENOPKG:120,EREMOTE:121,ENOLINK:47,EADV:122,ESRMNT:123,ECOMM:124,EPROTO:65,EMULTIHOP:36,EDOTDOT:125,EBADMSG:9,ENOTUNIQ:126,EBADFD:127,EREMCHG:128,ELIBACC:129,ELIBBAD:130,ELIBSCN:131,ELIBMAX:132,ELIBEXEC:133,ENOSYS:52,ENOTEMPTY:55,ENAMETOOLONG:37,ELOOP:32,EOPNOTSUPP:138,EPFNOSUPPORT:139,ECONNRESET:15,ENOBUFS:42,EAFNOSUPPORT:5,EPROTOTYPE:67,ENOTSOCK:57,ENOPROTOOPT:50,ESHUTDOWN:140,ECONNREFUSED:14,EADDRINUSE:3,ECONNABORTED:13,ENETUNREACH:40,ENETDOWN:38,ETIMEDOUT:73,EHOSTDOWN:142,EHOSTUNREACH:23,EINPROGRESS:26,EALREADY:7,EDESTADDRREQ:17,EMSGSIZE:35,EPROTONOSUPPORT:66,ESOCKTNOSUPPORT:137,EADDRNOTAVAIL:4,ENETRESET:39,EISCONN:30,ENOTCONN:53,ETOOMANYREFS:141,EUSERS:136,EDQUOT:19,ESTALE:72,ENOTSUP:138,ENOMEDIUM:148,EILSEQ:25,EOVERFLOW:61,ECANCELED:11,ENOTRECOVERABLE:56,EOWNERDEAD:62,ESTRPIPE:135},l={root:null,mounts:[],devices:{},streams:[],nextInode:1,nameTable:null,currentPath:"/",initialized:!1,ignorePermissions:!0,ErrnoError:class extends Error{constructor(t){super(Ie?xn(t):""),this.name="ErrnoError",this.errno=t;for(var o in Bt)if(Bt[o]===t){this.code=o;break}}},genericErrors:{},filesystems:null,syncFSRequests:0,readFiles:{},FSStream:class{constructor(){this.shared={}}get object(){return this.node}set object(t){this.node=t}get isRead(){return(this.flags&2097155)!==1}get isWrite(){return(this.flags&2097155)!==0}get isAppend(){return this.flags&1024}get flags(){return this.shared.flags}set flags(t){this.shared.flags=t}get position(){return this.shared.position}set position(t){this.shared.position=t}},FSNode:class{constructor(t,o,s,m){t||(t=this),this.parent=t,this.mount=t.mount,this.mounted=null,this.id=l.nextInode++,this.name=o,this.mode=s,this.node_ops={},this.stream_ops={},this.rdev=m,this.readMode=365,this.writeMode=146}get read(){return(this.mode&this.readMode)===this.readMode}set read(t){t?this.mode|=this.readMode:this.mode&=~this.readMode}get write(){return(this.mode&this.writeMode)===this.writeMode}set write(t){t?this.mode|=this.writeMode:this.mode&=~this.writeMode}get isFolder(){return l.isDir(this.mode)}get isDevice(){return l.isChrdev(this.mode)}},lookupPath(t,o={}){if(t=ye.resolve(t),!t)return{path:"",node:null};var s={follow_mount:!0,recurse_count:0};if(o=Object.assign(s,o),o.recurse_count>8)throw new l.ErrnoError(32);for(var m=t.split("/").filter(U=>!!U),c=l.root,g="/",p=0;p<m.length;p++){var E=p===m.length-1;if(E&&o.parent)break;if(c=l.lookupNode(c,m[p]),g=Q.join2(g,m[p]),l.isMountpoint(c)&&(!E||E&&o.follow_mount)&&(c=c.mounted.root),!E||o.follow)for(var T=0;l.isLink(c.mode);){var j=l.readlink(g);g=ye.resolve(Q.dirname(g),j);var V=l.lookupPath(g,{recurse_count:o.recurse_count+1});if(c=V.node,T++>40)throw new l.ErrnoError(32)}}return{path:g,node:c}},getPath(t){for(var o;;){if(l.isRoot(t)){var s=t.mount.mountpoint;return o?s[s.length-1]!=="/"?`${s}/${o}`:s+o:s}o=o?`${t.name}/${o}`:t.name,t=t.parent}},hashName(t,o){for(var s=0,m=0;m<o.length;m++)s=(s<<5)-s+o.charCodeAt(m)|0;return(t+s>>>0)%l.nameTable.length},hashAddNode(t){var o=l.hashName(t.parent.id,t.name);t.name_next=l.nameTable[o],l.nameTable[o]=t},hashRemoveNode(t){var o=l.hashName(t.parent.id,t.name);if(l.nameTable[o]===t)l.nameTable[o]=t.name_next;else for(var s=l.nameTable[o];s;){if(s.name_next===t){s.name_next=t.name_next;break}s=s.name_next}},lookupNode(t,o){var s=l.mayLookup(t);if(s)throw new l.ErrnoError(s);for(var m=l.hashName(t.id,o),c=l.nameTable[m];c;c=c.name_next){var g=c.name;if(c.parent.id===t.id&&g===o)return c}return l.lookup(t,o)},createNode(t,o,s,m){C(typeof t=="object");var c=new l.FSNode(t,o,s,m);return l.hashAddNode(c),c},destroyNode(t){l.hashRemoveNode(t)},isRoot(t){return t===t.parent},isMountpoint(t){return!!t.mounted},isFile(t){return(t&61440)===32768},isDir(t){return(t&61440)===16384},isLink(t){return(t&61440)===40960},isChrdev(t){return(t&61440)===8192},isBlkdev(t){return(t&61440)===24576},isFIFO(t){return(t&61440)===4096},isSocket(t){return(t&49152)===49152},flagsToPermissionString(t){var o=["r","w","rw"][t&3];return t&512&&(o+="w"),o},nodePermissions(t,o){return l.ignorePermissions?0:o.includes("r")&&!(t.mode&292)||o.includes("w")&&!(t.mode&146)||o.includes("x")&&!(t.mode&73)?2:0},mayLookup(t){if(!l.isDir(t.mode))return 54;var o=l.nodePermissions(t,"x");return o||(t.node_ops.lookup?0:2)},mayCreate(t,o){try{var s=l.lookupNode(t,o);return 20}catch{}return l.nodePermissions(t,"wx")},mayDelete(t,o,s){var m;try{m=l.lookupNode(t,o)}catch(g){return g.errno}var c=l.nodePermissions(t,"wx");if(c)return c;if(s){if(!l.isDir(m.mode))return 54;if(l.isRoot(m)||l.getPath(m)===l.cwd())return 10}else if(l.isDir(m.mode))return 31;return 0},mayOpen(t,o){return t?l.isLink(t.mode)?32:l.isDir(t.mode)&&(l.flagsToPermissionString(o)!=="r"||o&512)?31:l.nodePermissions(t,l.flagsToPermissionString(o)):44},MAX_OPEN_FDS:4096,nextfd(){for(var t=0;t<=l.MAX_OPEN_FDS;t++)if(!l.streams[t])return t;throw new l.ErrnoError(33)},getStreamChecked(t){var o=l.getStream(t);if(!o)throw new l.ErrnoError(8);return o},getStream:t=>l.streams[t],createStream(t,o=-1){return C(o>=-1),t=Object.assign(new l.FSStream,t),o==-1&&(o=l.nextfd()),t.fd=o,l.streams[o]=t,t},closeStream(t){l.streams[t]=null},dupStream(t,o=-1){var m,c;var s=l.createStream(t,o);return(c=(m=s.stream_ops)==null?void 0:m.dup)==null||c.call(m,s),s},chrdev_stream_ops:{open(t){var s,m;var o=l.getDevice(t.node.rdev);t.stream_ops=o.stream_ops,(m=(s=t.stream_ops).open)==null||m.call(s,t)},llseek(){throw new l.ErrnoError(70)}},major:t=>t>>8,minor:t=>t&255,makedev:(t,o)=>t<<8|o,registerDevice(t,o){l.devices[t]={stream_ops:o}},getDevice:t=>l.devices[t],getMounts(t){for(var o=[],s=[t];s.length;){var m=s.pop();o.push(m),s.push(...m.mounts)}return o},syncfs(t,o){typeof t=="function"&&(o=t,t=!1),l.syncFSRequests++,l.syncFSRequests>1&&v(`warning: ${l.syncFSRequests} FS.syncfs operations in flight at once, probably just doing extra work`);var s=l.getMounts(l.root.mount),m=0;function c(p){return C(l.syncFSRequests>0),l.syncFSRequests--,o(p)}function g(p){if(p)return g.errored?void 0:(g.errored=!0,c(p));++m>=s.length&&c(null)}s.forEach(p=>{if(!p.type.syncfs)return g(null);p.type.syncfs(p,t,g)})},mount(t,o,s){if(typeof t=="string")throw t;var m=s==="/",c=!s,g;if(m&&l.root)throw new l.ErrnoError(10);if(!m&&!c){var p=l.lookupPath(s,{follow_mount:!1});if(s=p.path,g=p.node,l.isMountpoint(g))throw new l.ErrnoError(10);if(!l.isDir(g.mode))throw new l.ErrnoError(54)}var E={type:t,opts:o,mountpoint:s,mounts:[]},T=t.mount(E);return T.mount=E,E.root=T,m?l.root=T:g&&(g.mounted=E,g.mount&&g.mount.mounts.push(E)),T},unmount(t){var o=l.lookupPath(t,{follow_mount:!1});if(!l.isMountpoint(o.node))throw new l.ErrnoError(28);var s=o.node,m=s.mounted,c=l.getMounts(m);Object.keys(l.nameTable).forEach(p=>{for(var E=l.nameTable[p];E;){var T=E.name_next;c.includes(E.mount)&&l.destroyNode(E),E=T}}),s.mounted=null;var g=s.mount.mounts.indexOf(m);C(g!==-1),s.mount.mounts.splice(g,1)},lookup(t,o){return t.node_ops.lookup(t,o)},mknod(t,o,s){var m=l.lookupPath(t,{parent:!0}),c=m.node,g=Q.basename(t);if(!g||g==="."||g==="..")throw new l.ErrnoError(28);var p=l.mayCreate(c,g);if(p)throw new l.ErrnoError(p);if(!c.node_ops.mknod)throw new l.ErrnoError(63);return c.node_ops.mknod(c,g,o,s)},create(t,o){return o=o!==void 0?o:438,o&=4095,o|=32768,l.mknod(t,o,0)},mkdir(t,o){return o=o!==void 0?o:511,o&=1023,o|=16384,l.mknod(t,o,0)},mkdirTree(t,o){for(var s=t.split("/"),m="",c=0;c<s.length;++c)if(s[c]){m+="/"+s[c];try{l.mkdir(m,o)}catch(g){if(g.errno!=20)throw g}}},mkdev(t,o,s){return typeof s>"u"&&(s=o,o=438),o|=8192,l.mknod(t,o,s)},symlink(t,o){if(!ye.resolve(t))throw new l.ErrnoError(44);var s=l.lookupPath(o,{parent:!0}),m=s.node;if(!m)throw new l.ErrnoError(44);var c=Q.basename(o),g=l.mayCreate(m,c);if(g)throw new l.ErrnoError(g);if(!m.node_ops.symlink)throw new l.ErrnoError(63);return m.node_ops.symlink(m,c,t)},rename(t,o){var s=Q.dirname(t),m=Q.dirname(o),c=Q.basename(t),g=Q.basename(o),p,E,T;if(p=l.lookupPath(t,{parent:!0}),E=p.node,p=l.lookupPath(o,{parent:!0}),T=p.node,!E||!T)throw new l.ErrnoError(44);if(E.mount!==T.mount)throw new l.ErrnoError(75);var j=l.lookupNode(E,c),V=ye.relative(t,m);if(V.charAt(0)!==".")throw new l.ErrnoError(28);if(V=ye.relative(o,s),V.charAt(0)!==".")throw new l.ErrnoError(55);var U;try{U=l.lookupNode(T,g)}catch{}if(j!==U){var $=l.isDir(j.mode),w=l.mayDelete(E,c,$);if(w)throw new l.ErrnoError(w);if(w=U?l.mayDelete(T,g,$):l.mayCreate(T,g),w)throw new l.ErrnoError(w);if(!E.node_ops.rename)throw new l.ErrnoError(63);if(l.isMountpoint(j)||U&&l.isMountpoint(U))throw new l.ErrnoError(10);if(T!==E&&(w=l.nodePermissions(E,"w"),w))throw new l.ErrnoError(w);l.hashRemoveNode(j);try{E.node_ops.rename(j,T,g),j.parent=T}catch(N){throw N}finally{l.hashAddNode(j)}}},rmdir(t){var o=l.lookupPath(t,{parent:!0}),s=o.node,m=Q.basename(t),c=l.lookupNode(s,m),g=l.mayDelete(s,m,!0);if(g)throw new l.ErrnoError(g);if(!s.node_ops.rmdir)throw new l.ErrnoError(63);if(l.isMountpoint(c))throw new l.ErrnoError(10);s.node_ops.rmdir(s,m),l.destroyNode(c)},readdir(t){var o=l.lookupPath(t,{follow:!0}),s=o.node;if(!s.node_ops.readdir)throw new l.ErrnoError(54);return s.node_ops.readdir(s)},unlink(t){var o=l.lookupPath(t,{parent:!0}),s=o.node;if(!s)throw new l.ErrnoError(44);var m=Q.basename(t),c=l.lookupNode(s,m),g=l.mayDelete(s,m,!1);if(g)throw new l.ErrnoError(g);if(!s.node_ops.unlink)throw new l.ErrnoError(63);if(l.isMountpoint(c))throw new l.ErrnoError(10);s.node_ops.unlink(s,m),l.destroyNode(c)},readlink(t){var o=l.lookupPath(t),s=o.node;if(!s)throw new l.ErrnoError(44);if(!s.node_ops.readlink)throw new l.ErrnoError(28);return ye.resolve(l.getPath(s.parent),s.node_ops.readlink(s))},stat(t,o){var s=l.lookupPath(t,{follow:!o}),m=s.node;if(!m)throw new l.ErrnoError(44);if(!m.node_ops.getattr)throw new l.ErrnoError(63);return m.node_ops.getattr(m)},lstat(t){return l.stat(t,!0)},chmod(t,o,s){var m;if(typeof t=="string"){var c=l.lookupPath(t,{follow:!s});m=c.node}else m=t;if(!m.node_ops.setattr)throw new l.ErrnoError(63);m.node_ops.setattr(m,{mode:o&4095|m.mode&-4096,timestamp:Date.now()})},lchmod(t,o){l.chmod(t,o,!0)},fchmod(t,o){var s=l.getStreamChecked(t);l.chmod(s.node,o)},chown(t,o,s,m){var c;if(typeof t=="string"){var g=l.lookupPath(t,{follow:!m});c=g.node}else c=t;if(!c.node_ops.setattr)throw new l.ErrnoError(63);c.node_ops.setattr(c,{timestamp:Date.now()})},lchown(t,o,s){l.chown(t,o,s,!0)},fchown(t,o,s){var m=l.getStreamChecked(t);l.chown(m.node,o,s)},truncate(t,o){if(o<0)throw new l.ErrnoError(28);var s;if(typeof t=="string"){var m=l.lookupPath(t,{follow:!0});s=m.node}else s=t;if(!s.node_ops.setattr)throw new l.ErrnoError(63);if(l.isDir(s.mode))throw new l.ErrnoError(31);if(!l.isFile(s.mode))throw new l.ErrnoError(28);var c=l.nodePermissions(s,"w");if(c)throw new l.ErrnoError(c);s.node_ops.setattr(s,{size:o,timestamp:Date.now()})},ftruncate(t,o){var s=l.getStreamChecked(t);if((s.flags&2097155)===0)throw new l.ErrnoError(28);l.truncate(s.node,o)},utime(t,o,s){var m=l.lookupPath(t,{follow:!0}),c=m.node;c.node_ops.setattr(c,{timestamp:Math.max(o,s)})},open(t,o,s){if(t==="")throw new l.ErrnoError(44);o=typeof o=="string"?Tn(o):o,o&64?(s=typeof s>"u"?438:s,s=s&4095|32768):s=0;var m;if(typeof t=="object")m=t;else{t=Q.normalize(t);try{var c=l.lookupPath(t,{follow:!(o&131072)});m=c.node}catch{}}var g=!1;if(o&64)if(m){if(o&128)throw new l.ErrnoError(20)}else m=l.mknod(t,s,0),g=!0;if(!m)throw new l.ErrnoError(44);if(l.isChrdev(m.mode)&&(o&=-513),o&65536&&!l.isDir(m.mode))throw new l.ErrnoError(54);if(!g){var p=l.mayOpen(m,o);if(p)throw new l.ErrnoError(p)}o&512&&!g&&l.truncate(m,0),o&=-131713;var E=l.createStream({node:m,path:l.getPath(m),flags:o,seekable:!0,position:0,stream_ops:m.stream_ops,ungotten:[],error:!1});return E.stream_ops.open&&E.stream_ops.open(E),e.logReadFiles&&!(o&1)&&(t in l.readFiles||(l.readFiles[t]=1)),E},close(t){if(l.isClosed(t))throw new l.ErrnoError(8);t.getdents&&(t.getdents=null);try{t.stream_ops.close&&t.stream_ops.close(t)}catch(o){throw o}finally{l.closeStream(t.fd)}t.fd=null},isClosed(t){return t.fd===null},llseek(t,o,s){if(l.isClosed(t))throw new l.ErrnoError(8);if(!t.seekable||!t.stream_ops.llseek)throw new l.ErrnoError(70);if(s!=0&&s!=1&&s!=2)throw new l.ErrnoError(28);return t.position=t.stream_ops.llseek(t,o,s),t.ungotten=[],t.position},read(t,o,s,m,c){if(C(s>=0),m<0||c<0)throw new l.ErrnoError(28);if(l.isClosed(t))throw new l.ErrnoError(8);if((t.flags&2097155)===1)throw new l.ErrnoError(8);if(l.isDir(t.node.mode))throw new l.ErrnoError(31);if(!t.stream_ops.read)throw new l.ErrnoError(28);var g=typeof c<"u";if(!g)c=t.position;else if(!t.seekable)throw new l.ErrnoError(70);var p=t.stream_ops.read(t,o,s,m,c);return g||(t.position+=p),p},write(t,o,s,m,c,g){if(C(s>=0),m<0||c<0)throw new l.ErrnoError(28);if(l.isClosed(t))throw new l.ErrnoError(8);if((t.flags&2097155)===0)throw new l.ErrnoError(8);if(l.isDir(t.node.mode))throw new l.ErrnoError(31);if(!t.stream_ops.write)throw new l.ErrnoError(28);t.seekable&&t.flags&1024&&l.llseek(t,0,2);var p=typeof c<"u";if(!p)c=t.position;else if(!t.seekable)throw new l.ErrnoError(70);var E=t.stream_ops.write(t,o,s,m,c,g);return p||(t.position+=E),E},allocate(t,o,s){if(l.isClosed(t))throw new l.ErrnoError(8);if(o<0||s<=0)throw new l.ErrnoError(28);if((t.flags&2097155)===0)throw new l.ErrnoError(8);if(!l.isFile(t.node.mode)&&!l.isDir(t.node.mode))throw new l.ErrnoError(43);if(!t.stream_ops.allocate)throw new l.ErrnoError(138);t.stream_ops.allocate(t,o,s)},mmap(t,o,s,m,c){if((m&2)!==0&&(c&2)===0&&(t.flags&2097155)!==2)throw new l.ErrnoError(2);if((t.flags&2097155)===1)throw new l.ErrnoError(2);if(!t.stream_ops.mmap)throw new l.ErrnoError(43);if(!o)throw new l.ErrnoError(28);return t.stream_ops.mmap(t,o,s,m,c)},msync(t,o,s,m,c){return C(s>=0),t.stream_ops.msync?t.stream_ops.msync(t,o,s,m,c):0},ioctl(t,o,s){if(!t.stream_ops.ioctl)throw new l.ErrnoError(59);return t.stream_ops.ioctl(t,o,s)},readFile(t,o={}){if(o.flags=o.flags||0,o.encoding=o.encoding||"binary",o.encoding!=="utf8"&&o.encoding!=="binary")throw new Error(`Invalid encoding type "${o.encoding}"`);var s,m=l.open(t,o.flags),c=l.stat(t),g=c.size,p=new Uint8Array(g);return l.read(m,p,0,g,0),o.encoding==="utf8"?s=Be(p):o.encoding==="binary"&&(s=p),l.close(m),s},writeFile(t,o,s={}){s.flags=s.flags||577;var m=l.open(t,s.flags,s.mode);if(typeof o=="string"){var c=new Uint8Array(Xe(o)+1),g=Ft(o,c,0,c.length);l.write(m,c,0,g,void 0,s.canOwn)}else if(ArrayBuffer.isView(o))l.write(m,o,0,o.byteLength,void 0,s.canOwn);else throw new Error("Unsupported data type");l.close(m)},cwd:()=>l.currentPath,chdir(t){var o=l.lookupPath(t,{follow:!0});if(o.node===null)throw new l.ErrnoError(44);if(!l.isDir(o.node.mode))throw new l.ErrnoError(54);var s=l.nodePermissions(o.node,"x");if(s)throw new l.ErrnoError(s);l.currentPath=o.path},createDefaultDirectories(){l.mkdir("/tmp"),l.mkdir("/home"),l.mkdir("/home/web_user")},createDefaultDevices(){l.mkdir("/dev"),l.registerDevice(l.makedev(1,3),{read:()=>0,write:(m,c,g,p,E)=>p}),l.mkdev("/dev/null",l.makedev(1,3)),ke.register(l.makedev(5,0),ke.default_tty_ops),ke.register(l.makedev(6,0),ke.default_tty1_ops),l.mkdev("/dev/tty",l.makedev(5,0)),l.mkdev("/dev/tty1",l.makedev(6,0));var t=new Uint8Array(1024),o=0,s=()=>(o===0&&(o=wt(t).byteLength),t[--o]);l.createDevice("/dev","random",s),l.createDevice("/dev","urandom",s),l.mkdir("/dev/shm"),l.mkdir("/dev/shm/tmp")},createSpecialDirectories(){l.mkdir("/proc");var t=l.mkdir("/proc/self");l.mkdir("/proc/self/fd"),l.mount({mount(){var o=l.createNode(t,"fd",16895,73);return o.node_ops={lookup(s,m){var c=+m,g=l.getStreamChecked(c),p={parent:null,mount:{mountpoint:"fake"},node_ops:{readlink:()=>g.path}};return p.parent=p,p}},o}},{},"/proc/self/fd")},createStandardStreams(t,o,s){t?l.createDevice("/dev","stdin",t):l.symlink("/dev/tty","/dev/stdin"),o?l.createDevice("/dev","stdout",null,o):l.symlink("/dev/tty","/dev/stdout"),s?l.createDevice("/dev","stderr",null,s):l.symlink("/dev/tty1","/dev/stderr");var m=l.open("/dev/stdin",0),c=l.open("/dev/stdout",1),g=l.open("/dev/stderr",1);C(m.fd===0,`invalid handle for stdin (${m.fd})`),C(c.fd===1,`invalid handle for stdout (${c.fd})`),C(g.fd===2,`invalid handle for stderr (${g.fd})`)},staticInit(){[44].forEach(t=>{l.genericErrors[t]=new l.ErrnoError(t),l.genericErrors[t].stack="<generic error, no stack>"}),l.nameTable=new Array(4096),l.mount(z,{},"/"),l.createDefaultDirectories(),l.createDefaultDevices(),l.createSpecialDirectories(),l.filesystems={MEMFS:z}},init(t,o,s){C(!l.initialized,"FS.init was previously called. If you want to initialize later with custom parameters, remove any earlier calls (note that one is automatically added to the generated code)"),l.initialized=!0,t??(t=e.stdin),o??(o=e.stdout),s??(s=e.stderr),l.createStandardStreams(t,o,s)},quit(){l.initialized=!1,vr(0);for(var t=0;t<l.streams.length;t++){var o=l.streams[t];o&&l.close(o)}},findObject(t,o){var s=l.analyzePath(t,o);return s.exists?s.object:null},analyzePath(t,o){try{var s=l.lookupPath(t,{follow:!o});t=s.path}catch{}var m={isRoot:!1,exists:!1,error:0,name:null,path:null,object:null,parentExists:!1,parentPath:null,parentObject:null};try{var s=l.lookupPath(t,{parent:!0});m.parentExists=!0,m.parentPath=s.path,m.parentObject=s.node,m.name=Q.basename(t),s=l.lookupPath(t,{follow:!o}),m.exists=!0,m.path=s.path,m.object=s.node,m.name=s.node.name,m.isRoot=s.path==="/"}catch(c){m.error=c.errno}return m},createPath(t,o,s,m){t=typeof t=="string"?t:l.getPath(t);for(var c=o.split("/").reverse();c.length;){var g=c.pop();if(g){var p=Q.join2(t,g);try{l.mkdir(p)}catch{}t=p}}return p},createFile(t,o,s,m,c){var g=Q.join2(typeof t=="string"?t:l.getPath(t),o),p=lt(m,c);return l.create(g,p)},createDataFile(t,o,s,m,c,g){var p=o;t&&(t=typeof t=="string"?t:l.getPath(t),p=o?Q.join2(t,o):t);var E=lt(m,c),T=l.create(p,E);if(s){if(typeof s=="string"){for(var j=new Array(s.length),V=0,U=s.length;V<U;++V)j[V]=s.charCodeAt(V);s=j}l.chmod(T,E|146);var $=l.open(T,577);l.write($,s,0,s.length,0,g),l.close($),l.chmod(T,E)}},createDevice(t,o,s,m){var E;var c=Q.join2(typeof t=="string"?t:l.getPath(t),o),g=lt(!!s,!!m);(E=l.createDevice).major??(E.major=64);var p=l.makedev(l.createDevice.major++,0);return l.registerDevice(p,{open(T){T.seekable=!1},close(T){var j;(j=m==null?void 0:m.buffer)!=null&&j.length&&m(10)},read(T,j,V,U,$){for(var w=0,N=0;N<U;N++){var q;try{q=s()}catch{throw new l.ErrnoError(29)}if(q===void 0&&w===0)throw new l.ErrnoError(6);if(q==null)break;w++,j[V+N]=q}return w&&(T.node.timestamp=Date.now()),w},write(T,j,V,U,$){for(var w=0;w<U;w++)try{m(j[V+w])}catch{throw new l.ErrnoError(29)}return U&&(T.node.timestamp=Date.now()),w}}),l.mkdev(c,g,p)},forceLoadFile(t){if(t.isDevice||t.isFolder||t.link||t.contents)return!0;if(typeof XMLHttpRequest<"u")throw new Error("Lazy loading should have been performed (contents set) in createLazyFile, but it was not. Lazy loading only works in web workers. Use --embed-file or --preload-file in emcc on the main thread.");try{t.contents=S(t.url),t.usedBytes=t.contents.length}catch{throw new l.ErrnoError(29)}},createLazyFile(t,o,s,m,c){class g{constructor(){this.lengthKnown=!1,this.chunks=[]}get(w){if(!(w>this.length-1||w<0)){var N=w%this.chunkSize,q=w/this.chunkSize|0;return this.getter(q)[N]}}setDataGetter(w){this.getter=w}cacheLength(){var w=new XMLHttpRequest;if(w.open("HEAD",s,!1),w.send(null),!(w.status>=200&&w.status<300||w.status===304))throw new Error("Couldn't load "+s+". Status: "+w.status);var N=Number(w.getResponseHeader("Content-length")),q,ce=(q=w.getResponseHeader("Accept-Ranges"))&&q==="bytes",de=(q=w.getResponseHeader("Content-Encoding"))&&q==="gzip",_e=1024*1024;ce||(_e=N);var ge=(pe,Ne)=>{if(pe>Ne)throw new Error("invalid range ("+pe+", "+Ne+") or no bytes requested!");if(Ne>N-1)throw new Error("only "+N+" bytes available! programmer error!");var ie=new XMLHttpRequest;if(ie.open("GET",s,!1),N!==_e&&ie.setRequestHeader("Range","bytes="+pe+"-"+Ne),ie.responseType="arraybuffer",ie.overrideMimeType&&ie.overrideMimeType("text/plain; charset=x-user-defined"),ie.send(null),!(ie.status>=200&&ie.status<300||ie.status===304))throw new Error("Couldn't load "+s+". Status: "+ie.status);return ie.response!==void 0?new Uint8Array(ie.response||[]):Rt(ie.responseText||"")},qe=this;qe.setDataGetter(pe=>{var Ne=pe*_e,ie=(pe+1)*_e-1;if(ie=Math.min(ie,N-1),typeof qe.chunks[pe]>"u"&&(qe.chunks[pe]=ge(Ne,ie)),typeof qe.chunks[pe]>"u")throw new Error("doXHR failed!");return qe.chunks[pe]}),(de||!N)&&(_e=N=1,N=this.getter(0).length,_e=N,x("LazyFiles on gzip forces download of the whole file when length is accessed")),this._length=N,this._chunkSize=_e,this.lengthKnown=!0}get length(){return this.lengthKnown||this.cacheLength(),this._length}get chunkSize(){return this.lengthKnown||this.cacheLength(),this._chunkSize}}if(typeof XMLHttpRequest<"u"){if(!_)throw"Cannot do synchronous binary XHRs outside webworkers in modern browsers. Use --embed-file or --preload-file in emcc";var p=new g,E={isDevice:!1,contents:p}}else var E={isDevice:!1,url:s};var T=l.createFile(t,o,E,m,c);E.contents?T.contents=E.contents:E.url&&(T.contents=null,T.url=E.url),Object.defineProperties(T,{usedBytes:{get:function(){return this.contents.length}}});var j={},V=Object.keys(T.stream_ops);V.forEach($=>{var w=T.stream_ops[$];j[$]=(...N)=>(l.forceLoadFile(T),w(...N))});function U($,w,N,q,ce){var de=$.node.contents;if(ce>=de.length)return 0;var _e=Math.min(de.length-ce,q);if(C(_e>=0),de.slice)for(var ge=0;ge<_e;ge++)w[N+ge]=de[ce+ge];else for(var ge=0;ge<_e;ge++)w[N+ge]=de.get(ce+ge);return _e}return j.read=($,w,N,q,ce)=>(l.forceLoadFile(T),U($,w,N,q,ce)),j.mmap=($,w,N,q,ce)=>{l.forceLoadFile(T);var de=jt(w);if(!de)throw new l.ErrnoError(48);return U($,H,de,w,N),{ptr:de,allocated:!0}},T.stream_ops=j,T},absolutePath(){Z("FS.absolutePath has been removed; use PATH_FS.resolve instead")},createFolder(){Z("FS.createFolder has been removed; use FS.mkdir instead")},createLink(){Z("FS.createLink has been removed; use FS.symlink instead")},joinPath(){Z("FS.joinPath has been removed; use PATH.join instead")},mmapAlloc(){Z("FS.mmapAlloc has been replaced by the top level function mmapAlloc")},standardizePath(){Z("FS.standardizePath has been removed; use PATH.normalize instead")}},J={DEFAULT_POLLMASK:5,calculateAt(t,o,s){if(Q.isAbs(o))return o;var m;if(t===-100)m=l.cwd();else{var c=J.getStreamFromFD(t);m=c.path}if(o.length==0){if(!s)throw new l.ErrnoError(44);return m}return Q.join2(m,o)},doStat(t,o,s){var m=t(o);k[s>>2]=m.dev,k[s+4>>2]=m.mode,K[s+8>>2]=m.nlink,k[s+12>>2]=m.uid,k[s+16>>2]=m.gid,k[s+20>>2]=m.rdev,ee=[m.size>>>0,(L=m.size,+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[s+24>>2]=ee[0],k[s+28>>2]=ee[1],k[s+32>>2]=4096,k[s+36>>2]=m.blocks;var c=m.atime.getTime(),g=m.mtime.getTime(),p=m.ctime.getTime();return ee=[Math.floor(c/1e3)>>>0,(L=Math.floor(c/1e3),+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[s+40>>2]=ee[0],k[s+44>>2]=ee[1],K[s+48>>2]=c%1e3*1e3*1e3,ee=[Math.floor(g/1e3)>>>0,(L=Math.floor(g/1e3),+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[s+56>>2]=ee[0],k[s+60>>2]=ee[1],K[s+64>>2]=g%1e3*1e3*1e3,ee=[Math.floor(p/1e3)>>>0,(L=Math.floor(p/1e3),+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[s+72>>2]=ee[0],k[s+76>>2]=ee[1],K[s+80>>2]=p%1e3*1e3*1e3,ee=[m.ino>>>0,(L=m.ino,+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[s+88>>2]=ee[0],k[s+92>>2]=ee[1],0},doMsync(t,o,s,m,c){if(!l.isFile(o.node.mode))throw new l.ErrnoError(43);if(m&2)return 0;var g=te.slice(t,t+s);l.msync(o,g,c,s,m)},getStreamFromFD(t){var o=l.getStreamChecked(t);return o},varargs:void 0,getStr(t){var o=Oe(t);return o}};function On(t,o,s){J.varargs=s;try{var m=J.getStreamFromFD(t);switch(o){case 0:{var c=tt();if(c<0)return-28;for(;l.streams[c];)c++;var g;return g=l.dupStream(m,c),g.fd}case 1:case 2:return 0;case 3:return m.flags;case 4:{var c=tt();return m.flags|=c,0}case 12:{var c=Le(),p=0;return X[c+p>>1]=2,0}case 13:case 14:return 0}return-28}catch(E){if(typeof l>"u"||E.name!=="ErrnoError")throw E;return-E.errno}}function kn(t,o){try{var s=J.getStreamFromFD(t);return J.doStat(l.stat,s.path,o)}catch(m){if(typeof l>"u"||m.name!=="ErrnoError")throw m;return-m.errno}}var nt=(t,o)=>(C(t==t>>>0||t==(t|0)),C(o===(o|0)),o+2097152>>>0<4194305-!!t?(t>>>0)+o*4294967296:NaN);function wn(t,o,s){var m=nt(o,s);try{return isNaN(m)?61:(l.ftruncate(t,m),0)}catch(c){if(typeof l>"u"||c.name!=="ErrnoError")throw c;return-c.errno}}var we=(t,o,s)=>(C(typeof s=="number","stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),Ft(t,te,o,s));function Rn(t,o,s){try{var m=J.getStreamFromFD(t);m.getdents||(m.getdents=l.readdir(m.path));for(var c=280,g=0,p=l.llseek(m,0,1),E=Math.floor(p/c);E<m.getdents.length&&g+c<=s;){var T,j,V=m.getdents[E];if(V===".")T=m.node.id,j=4;else if(V===".."){var U=l.lookupPath(m.path,{parent:!0});T=U.node.id,j=4}else{var $=l.lookupNode(m.node,V);T=$.id,j=l.isChrdev($.mode)?2:l.isDir($.mode)?4:l.isLink($.mode)?10:8}C(T),ee=[T>>>0,(L=T,+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[o+g>>2]=ee[0],k[o+g+4>>2]=ee[1],ee=[(E+1)*c>>>0,(L=(E+1)*c,+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[o+g+8>>2]=ee[0],k[o+g+12>>2]=ee[1],X[o+g+16>>1]=280,H[o+g+18]=j,we(V,o+g+19,256),g+=c,E+=1}return l.llseek(m,E*c,0),g}catch(w){if(typeof l>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}function In(t,o,s){J.varargs=s;try{var m=J.getStreamFromFD(t);switch(o){case 21509:return m.tty?0:-59;case 21505:{if(!m.tty)return-59;if(m.tty.ops.ioctl_tcgets){var c=m.tty.ops.ioctl_tcgets(m),g=Le();k[g>>2]=c.c_iflag||0,k[g+4>>2]=c.c_oflag||0,k[g+8>>2]=c.c_cflag||0,k[g+12>>2]=c.c_lflag||0;for(var p=0;p<32;p++)H[g+p+17]=c.c_cc[p]||0;return 0}return 0}case 21510:case 21511:case 21512:return m.tty?0:-59;case 21506:case 21507:case 21508:{if(!m.tty)return-59;if(m.tty.ops.ioctl_tcsets){for(var g=Le(),E=k[g>>2],T=k[g+4>>2],j=k[g+8>>2],V=k[g+12>>2],U=[],p=0;p<32;p++)U.push(H[g+p+17]);return m.tty.ops.ioctl_tcsets(m.tty,o,{c_iflag:E,c_oflag:T,c_cflag:j,c_lflag:V,c_cc:U})}return 0}case 21519:{if(!m.tty)return-59;var g=Le();return k[g>>2]=0,0}case 21520:return m.tty?-28:-59;case 21531:{var g=Le();return l.ioctl(m,o,g)}case 21523:{if(!m.tty)return-59;if(m.tty.ops.ioctl_tiocgwinsz){var $=m.tty.ops.ioctl_tiocgwinsz(m.tty),g=Le();X[g>>1]=$[0],X[g+2>>1]=$[1]}return 0}case 21524:return m.tty?0:-59;case 21515:return m.tty?0:-59;default:return-28}}catch(w){if(typeof l>"u"||w.name!=="ErrnoError")throw w;return-w.errno}}function jn(t,o){try{return t=J.getStr(t),J.doStat(l.lstat,t,o)}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Bn(t,o,s,m){try{o=J.getStr(o);var c=m&256,g=m&4096;return m=m&-6401,C(!m,`unknown flags in __syscall_newfstatat: ${m}`),o=J.calculateAt(t,o,g),J.doStat(c?l.lstat:l.stat,o,s)}catch(p){if(typeof l>"u"||p.name!=="ErrnoError")throw p;return-p.errno}}function Ln(t,o,s,m){J.varargs=m;try{o=J.getStr(o),o=J.calculateAt(t,o);var c=m?tt():0;return l.open(o,s,c).fd}catch(g){if(typeof l>"u"||g.name!=="ErrnoError")throw g;return-g.errno}}function Nn(t){try{return t=J.getStr(t),l.rmdir(t),0}catch(o){if(typeof l>"u"||o.name!=="ErrnoError")throw o;return-o.errno}}function Vn(t,o){try{return t=J.getStr(t),J.doStat(l.stat,t,o)}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return-s.errno}}function Un(t,o,s){try{return o=J.getStr(o),o=J.calculateAt(t,o),s===0?l.unlink(o):s===512?l.rmdir(o):Z("Invalid flags passed to unlinkat"),0}catch(m){if(typeof l>"u"||m.name!=="ErrnoError")throw m;return-m.errno}}var Wn=()=>{Z("native code called abort()")},zn=(t,o,s)=>te.copyWithin(t,o,o+s),Hn=()=>{throw 1/0};function $n(t,o,s){var m=nt(t,o),c=new Date(m*1e3);k[s>>2]=c.getUTCSeconds(),k[s+4>>2]=c.getUTCMinutes(),k[s+8>>2]=c.getUTCHours(),k[s+12>>2]=c.getUTCDate(),k[s+16>>2]=c.getUTCMonth(),k[s+20>>2]=c.getUTCFullYear()-1900,k[s+24>>2]=c.getUTCDay();var g=Date.UTC(c.getUTCFullYear(),0,1,0,0,0,0),p=(c.getTime()-g)/(1e3*60*60*24)|0;k[s+28>>2]=p}var Yn=t=>t%4===0&&(t%100!==0||t%400===0),Xn=[0,31,60,91,121,152,182,213,244,274,305,335],Kn=[0,31,59,90,120,151,181,212,243,273,304,334],Jn=t=>{var o=Yn(t.getFullYear()),s=o?Xn:Kn,m=s[t.getMonth()]+t.getDate()-1;return m};function qn(t,o,s){var m=nt(t,o),c=new Date(m*1e3);k[s>>2]=c.getSeconds(),k[s+4>>2]=c.getMinutes(),k[s+8>>2]=c.getHours(),k[s+12>>2]=c.getDate(),k[s+16>>2]=c.getMonth(),k[s+20>>2]=c.getFullYear()-1900,k[s+24>>2]=c.getDay();var g=Jn(c)|0;k[s+28>>2]=g,k[s+36>>2]=-(c.getTimezoneOffset()*60);var p=new Date(c.getFullYear(),0,1),E=new Date(c.getFullYear(),6,1).getTimezoneOffset(),T=p.getTimezoneOffset(),j=(E!=T&&c.getTimezoneOffset()==Math.min(T,E))|0;k[s+32>>2]=j}var Qn=(t,o,s,m)=>{var c=new Date().getFullYear(),g=new Date(c,0,1),p=new Date(c,6,1),E=g.getTimezoneOffset(),T=p.getTimezoneOffset(),j=Math.max(E,T);K[t>>2]=j*60,k[o>>2]=+(E!=T);var V=w=>{var N=w>=0?"-":"+",q=Math.abs(w),ce=String(Math.floor(q/60)).padStart(2,"0"),de=String(q%60).padStart(2,"0");return`UTC${N}${ce}${de}`},U=V(E),$=V(T);C(U),C($),C(Xe(U)<=16,`timezone name truncated to fit in TZNAME_MAX (${U})`),C(Xe($)<=16,`timezone name truncated to fit in TZNAME_MAX (${$})`),T<E?(we(U,s,17),we($,m,17)):(we(U,m,17),we($,s,17))},Zn=()=>Date.now(),er=()=>2147483648,tr=t=>{var o=B.buffer,s=(t-o.byteLength+65535)/65536|0;try{return B.grow(s),ue(),1}catch(m){v(`growMemory: Attempted to grow heap from ${o.byteLength} bytes to ${t} bytes, but got error: ${m}`)}},nr=t=>{var o=te.length;t>>>=0,C(t>o);var s=er();if(t>s)return v(`Cannot enlarge memory, requested ${t} bytes, but the limit is ${s} bytes!`),!1;for(var m=1;m<=4;m*=2){var c=o*(1+.2/m);c=Math.min(c,t+100663296);var g=Math.min(s,It(Math.max(t,c),65536)),p=tr(g);if(p)return!0}return v(`Failed to grow the heap from ${o} bytes to ${g} bytes, not enough memory!`),!1},dt={},rr=()=>b||"./this.program",Ke=()=>{if(!Ke.strings){var t=(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",o={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:t,_:rr()};for(var s in dt)dt[s]===void 0?delete o[s]:o[s]=dt[s];var m=[];for(var s in o)m.push(`${s}=${o[s]}`);Ke.strings=m}return Ke.strings},or=(t,o)=>{for(var s=0;s<t.length;++s)C(t.charCodeAt(s)===(t.charCodeAt(s)&255)),H[o++]=t.charCodeAt(s);H[o]=0},ir=(t,o)=>{var s=0;return Ke().forEach((m,c)=>{var g=o+s;K[t+c*4>>2]=g,or(m,g),s+=m.length+1}),0},ar=(t,o)=>{var s=Ke();K[t>>2]=s.length;var m=0;return s.forEach(c=>m+=c.length+1),K[o>>2]=m,0};function sr(t){try{var o=J.getStreamFromFD(t);return l.close(o),0}catch(s){if(typeof l>"u"||s.name!=="ErrnoError")throw s;return s.errno}}var ur=(t,o,s,m)=>{for(var c=0,g=0;g<s;g++){var p=K[o>>2],E=K[o+4>>2];o+=8;var T=l.read(t,H,p,E,m);if(T<0)return-1;if(c+=T,T<E)break}return c};function mr(t,o,s,m){try{var c=J.getStreamFromFD(t),g=ur(c,o,s);return K[m>>2]=g,0}catch(p){if(typeof l>"u"||p.name!=="ErrnoError")throw p;return p.errno}}function Fr(t,o,s,m,c){var g=nt(o,s);try{if(isNaN(g))return 61;var p=J.getStreamFromFD(t);return l.llseek(p,g,m),ee=[p.position>>>0,(L=p.position,+Math.abs(L)>=1?L>0?+Math.floor(L/4294967296)>>>0:~~+Math.ceil((L-+(~~L>>>0))/4294967296)>>>0:0)],k[c>>2]=ee[0],k[c+4>>2]=ee[1],p.getdents&&g===0&&m===0&&(p.getdents=null),0}catch(E){if(typeof l>"u"||E.name!=="ErrnoError")throw E;return E.errno}}function lr(t){var s;try{var o=J.getStreamFromFD(t);return(s=o.stream_ops)!=null&&s.fsync?o.stream_ops.fsync(o):0}catch(m){if(typeof l>"u"||m.name!=="ErrnoError")throw m;return m.errno}}var dr=(t,o,s,m)=>{for(var c=0,g=0;g<s;g++){var p=K[o>>2],E=K[o+4>>2];o+=8;var T=l.write(t,H,p,E,m);if(T<0)return-1;if(c+=T,T<E)break}return c};function cr(t,o,s,m){try{var c=J.getStreamFromFD(t),g=dr(c,o,s);return K[m>>2]=g,0}catch(p){if(typeof l>"u"||p.name!=="ErrnoError")throw p;return p.errno}}var Je=[],Me,Pe=t=>{var o=Je[t];return o||(t>=Je.length&&(Je.length=t+1),Je[t]=o=Me.get(t)),C(Me.get(t)==o,"JavaScript-side Wasm function table mirror is out of date!"),o},Lt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,_r=(t,o)=>{C(t%2==0,"Pointer passed to UTF16ToString must be aligned to two bytes!");for(var s=t,m=s>>1,c=m+o/2;!(m>=c)&&re[m];)++m;if(s=m<<1,s-t>32&&Lt)return Lt.decode(te.subarray(t,s));for(var g="",p=0;!(p>=o/2);++p){var E=X[t+p*2>>1];if(E==0)break;g+=String.fromCharCode(E)}return g},Nt=(t,o)=>{C(t<16384),t<128?o.push(t):o.push(t%128|128,t>>7)},Pr=t=>{C(!t.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled");for(var o={i:"i32",j:"i64",f:"f32",d:"f64",e:"externref",p:"i32"},s={parameters:[],results:t[0]=="v"?[]:[o[t[0]]]},m=1;m<t.length;++m)C(t[m]in o,"invalid signature char: "+t[m]),s.parameters.push(o[t[m]]);return s},gr=(t,o)=>{var s=t.slice(0,1),m=t.slice(1),c={i:127,p:127,j:126,f:125,d:124,e:111};o.push(96),Nt(m.length,o);for(var g=0;g<m.length;++g)C(m[g]in c,"invalid signature char: "+m[g]),o.push(c[m[g]]);s=="v"?o.push(0):o.push(1,c[s])},hr=(t,o)=>{if(C(!o.includes("j"),"i64 not permitted in function signatures when WASM_BIGINT is disabled"),typeof WebAssembly.Function=="function")return new WebAssembly.Function(Pr(o),t);var s=[1];gr(o,s);var m=[0,97,115,109,1,0,0,0,1];Nt(s.length,m),m.push(...s),m.push(2,7,1,1,101,1,102,0,0,7,5,1,1,102,0,0);var c=new WebAssembly.Module(new Uint8Array(m)),g=new WebAssembly.Instance(c,{e:{f:t}}),p=g.exports.f;return p},fr=(t,o)=>{if(Re)for(var s=t;s<t+o;s++){var m=Pe(s);m&&Re.set(m,s)}},Re,Dr=t=>(Re||(Re=new WeakMap,fr(0,Me.length)),Re.get(t)||0),ct=[],br=()=>{if(ct.length)return ct.pop();try{Me.grow(1)}catch(t){throw t instanceof RangeError?"Unable to grow wasm table. Set ALLOW_TABLE_GROWTH.":t}return Me.length-1},_t=(t,o)=>{Me.set(t,o),Je[t]=Me.get(t)},pr=(t,o)=>{C(typeof t<"u");var s=Dr(t);if(s)return s;var m=br();try{_t(m,t)}catch(g){if(!(g instanceof TypeError))throw g;C(typeof o<"u","Missing signature argument to addFunction: "+t);var c=hr(t,o);_t(m,c)}return Re.set(t,m),m},Ar=t=>{var o=e["_"+t];return C(o,"Cannot call unknown function "+t+", make sure it is exported"),o},Er=(t,o)=>{C(t.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),H.set(t,o)},Vt=t=>$t(t),yr=t=>{var o=Xe(t)+1,s=Vt(o);return we(t,s,o),s},Ut=(t,o,s,m,c)=>{var g={string:N=>{var q=0;return N!=null&&N!==0&&(q=yr(N)),q},array:N=>{var q=Vt(N.length);return Er(N,q),q}};function p(N){return o==="string"?Oe(N):o==="boolean"?!!N:N}var E=Ar(t),T=[],j=0;if(C(o!=="array",'Return type should not be "array".'),m)for(var V=0;V<m.length;V++){var U=g[s[V]];U?(j===0&&(j=be()),T[V]=U(m[V])):T[V]=m[V]}var $=E(...T);function w(N){return j!==0&&De(j),p(N)}return $=w($),$},Mr=(t,o,s,m)=>(...c)=>Ut(t,o,s,c),Sr=t=>{Re.delete(Pe(t)),_t(t,null),ct.push(t)},Gr=(t,o,s)=>{if(C(o%2==0,"Pointer passed to stringToUTF16 must be aligned to two bytes!"),C(typeof s=="number","stringToUTF16(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),s??(s=2147483647),s<2)return 0;s-=2;for(var m=o,c=s<t.length*2?s/2:t.length,g=0;g<c;++g){var p=t.charCodeAt(g);X[o>>1]=p,o+=2}return X[o>>1]=0,o-m};l.createPreloadedFile=vn,l.staticInit();function Cr(){hn("fetchSettings")}var Wt={__assert_fail:pn,__syscall_fcntl64:On,__syscall_fstat64:kn,__syscall_ftruncate64:wn,__syscall_getdents64:Rn,__syscall_ioctl:In,__syscall_lstat64:jn,__syscall_newfstatat:Bn,__syscall_openat:Ln,__syscall_rmdir:Nn,__syscall_stat64:Vn,__syscall_unlinkat:Un,_abort_js:Wn,_emscripten_memcpy_js:zn,_emscripten_throw_longjmp:Hn,_gmtime_js:$n,_localtime_js:qn,_tzset_js:Qn,emscripten_date_now:Zn,emscripten_resize_heap:nr,environ_get:ir,environ_sizes_get:ar,fd_close:sr,fd_read:mr,fd_seek:Fr,fd_sync:lr,fd_write:cr,invoke_ii:kr,invoke_iii:wr,invoke_iiii:Rr,invoke_iiiii:jr,invoke_v:Br,invoke_vii:Lr,invoke_viii:Or,invoke_viiii:Ir,invoke_viiiiiiiii:Nr},le=gn();e._PDFiumExt_Init=a("PDFiumExt_Init",0),e._FPDF_InitLibraryWithConfig=a("FPDF_InitLibraryWithConfig",1),e._PDFiumExt_OpenFileWriter=a("PDFiumExt_OpenFileWriter",0),e._PDFiumExt_GetFileWriterSize=a("PDFiumExt_GetFileWriterSize",1),e._PDFiumExt_GetFileWriterData=a("PDFiumExt_GetFileWriterData",3),e._PDFiumExt_CloseFileWriter=a("PDFiumExt_CloseFileWriter",1),e._PDFiumExt_SaveAsCopy=a("PDFiumExt_SaveAsCopy",2),e._FPDF_SaveAsCopy=a("FPDF_SaveAsCopy",3),e._PDFiumExt_OpenFormFillInfo=a("PDFiumExt_OpenFormFillInfo",0),e._PDFiumExt_CloseFormFillInfo=a("PDFiumExt_CloseFormFillInfo",1),e._PDFiumExt_InitFormFillEnvironment=a("PDFiumExt_InitFormFillEnvironment",2),e._FPDFDOC_InitFormFillEnvironment=a("FPDFDOC_InitFormFillEnvironment",2),e._PDFiumExt_ExitFormFillEnvironment=a("PDFiumExt_ExitFormFillEnvironment",1),e._FPDFDOC_ExitFormFillEnvironment=a("FPDFDOC_ExitFormFillEnvironment",1),e._EPDFNamedDest_SetDest=a("EPDFNamedDest_SetDest",3),e._EPDFNamedDest_Remove=a("EPDFNamedDest_Remove",2),e._EPDFDest_CreateView=a("EPDFDest_CreateView",4),e._EPDFDest_CreateXYZ=a("EPDFDest_CreateXYZ",7),e._EPDFDest_CreateRemoteView=a("EPDFDest_CreateRemoteView",5),e._EPDFDest_CreateRemoteXYZ=a("EPDFDest_CreateRemoteXYZ",8),e._EPDFAction_CreateGoTo=a("EPDFAction_CreateGoTo",2),e._EPDFAction_CreateGoToNamed=a("EPDFAction_CreateGoToNamed",2),e._EPDFAction_CreateLaunch=a("EPDFAction_CreateLaunch",2),e._EPDFAction_CreateRemoteGoToByName=a("EPDFAction_CreateRemoteGoToByName",3),e._EPDFAction_CreateRemoteGoToDest=a("EPDFAction_CreateRemoteGoToDest",3),e._EPDFAction_CreateURI=a("EPDFAction_CreateURI",2),e._EPDFBookmark_Create=a("EPDFBookmark_Create",2),e._EPDFBookmark_Delete=a("EPDFBookmark_Delete",2),e._EPDFBookmark_AppendChild=a("EPDFBookmark_AppendChild",3),e._EPDFBookmark_InsertAfter=a("EPDFBookmark_InsertAfter",4),e._EPDFBookmark_Clear=a("EPDFBookmark_Clear",1),e._EPDFBookmark_SetTitle=a("EPDFBookmark_SetTitle",2),e._EPDFBookmark_SetDest=a("EPDFBookmark_SetDest",3),e._EPDFBookmark_SetAction=a("EPDFBookmark_SetAction",3),e._EPDFBookmark_ClearTarget=a("EPDFBookmark_ClearTarget",1),e._EPDF_PNG_EncodeRGBA=a("EPDF_PNG_EncodeRGBA",6),e._FPDFAnnot_IsSupportedSubtype=a("FPDFAnnot_IsSupportedSubtype",1),e._FPDFPage_CreateAnnot=a("FPDFPage_CreateAnnot",2),e._FPDFPage_GetAnnotCount=a("FPDFPage_GetAnnotCount",1),e._FPDFPage_GetAnnot=a("FPDFPage_GetAnnot",2),e._FPDFPage_GetAnnotIndex=a("FPDFPage_GetAnnotIndex",2),e._FPDFPage_CloseAnnot=a("FPDFPage_CloseAnnot",1),e._FPDFPage_RemoveAnnot=a("FPDFPage_RemoveAnnot",2),e._FPDFAnnot_GetSubtype=a("FPDFAnnot_GetSubtype",1),e._FPDFAnnot_IsObjectSupportedSubtype=a("FPDFAnnot_IsObjectSupportedSubtype",1),e._FPDFAnnot_UpdateObject=a("FPDFAnnot_UpdateObject",2),e._FPDFAnnot_AddInkStroke=a("FPDFAnnot_AddInkStroke",3),e._FPDFAnnot_RemoveInkList=a("FPDFAnnot_RemoveInkList",1),e._FPDFAnnot_AppendObject=a("FPDFAnnot_AppendObject",2),e._FPDFAnnot_GetObjectCount=a("FPDFAnnot_GetObjectCount",1),e._FPDFAnnot_GetObject=a("FPDFAnnot_GetObject",2),e._FPDFAnnot_RemoveObject=a("FPDFAnnot_RemoveObject",2),e._FPDFAnnot_SetColor=a("FPDFAnnot_SetColor",6),e._FPDFAnnot_GetColor=a("FPDFAnnot_GetColor",6),e._FPDFAnnot_HasAttachmentPoints=a("FPDFAnnot_HasAttachmentPoints",1),e._FPDFAnnot_SetAttachmentPoints=a("FPDFAnnot_SetAttachmentPoints",3),e._FPDFAnnot_AppendAttachmentPoints=a("FPDFAnnot_AppendAttachmentPoints",2),e._FPDFAnnot_CountAttachmentPoints=a("FPDFAnnot_CountAttachmentPoints",1),e._FPDFAnnot_GetAttachmentPoints=a("FPDFAnnot_GetAttachmentPoints",3),e._FPDFAnnot_SetRect=a("FPDFAnnot_SetRect",2),e._FPDFAnnot_GetRect=a("FPDFAnnot_GetRect",2),e._FPDFAnnot_GetVertices=a("FPDFAnnot_GetVertices",3),e._FPDFAnnot_GetInkListCount=a("FPDFAnnot_GetInkListCount",1),e._FPDFAnnot_GetInkListPath=a("FPDFAnnot_GetInkListPath",4),e._FPDFAnnot_GetLine=a("FPDFAnnot_GetLine",3),e._FPDFAnnot_SetBorder=a("FPDFAnnot_SetBorder",4),e._FPDFAnnot_GetBorder=a("FPDFAnnot_GetBorder",4),e._FPDFAnnot_HasKey=a("FPDFAnnot_HasKey",2),e._FPDFAnnot_GetValueType=a("FPDFAnnot_GetValueType",2),e._FPDFAnnot_SetStringValue=a("FPDFAnnot_SetStringValue",3),e._FPDFAnnot_GetStringValue=a("FPDFAnnot_GetStringValue",4),e._FPDFAnnot_GetNumberValue=a("FPDFAnnot_GetNumberValue",3),e._FPDFAnnot_SetAP=a("FPDFAnnot_SetAP",3),e._FPDFAnnot_GetAP=a("FPDFAnnot_GetAP",4),e._FPDFAnnot_GetLinkedAnnot=a("FPDFAnnot_GetLinkedAnnot",2),e._FPDFAnnot_GetFlags=a("FPDFAnnot_GetFlags",1),e._FPDFAnnot_SetFlags=a("FPDFAnnot_SetFlags",2),e._FPDFAnnot_GetFormFieldFlags=a("FPDFAnnot_GetFormFieldFlags",2),e._FPDFAnnot_SetFormFieldFlags=a("FPDFAnnot_SetFormFieldFlags",3),e._FPDFAnnot_GetFormFieldAtPoint=a("FPDFAnnot_GetFormFieldAtPoint",3),e._FPDFAnnot_GetFormFieldName=a("FPDFAnnot_GetFormFieldName",4),e._FPDFAnnot_GetFormFieldType=a("FPDFAnnot_GetFormFieldType",2),e._FPDFAnnot_GetFormAdditionalActionJavaScript=a("FPDFAnnot_GetFormAdditionalActionJavaScript",5),e._FPDFAnnot_GetFormFieldAlternateName=a("FPDFAnnot_GetFormFieldAlternateName",4),e._FPDFAnnot_GetFormFieldValue=a("FPDFAnnot_GetFormFieldValue",4),e._FPDFAnnot_GetOptionCount=a("FPDFAnnot_GetOptionCount",2),e._FPDFAnnot_GetOptionLabel=a("FPDFAnnot_GetOptionLabel",5),e._FPDFAnnot_IsOptionSelected=a("FPDFAnnot_IsOptionSelected",3),e._FPDFAnnot_GetFontSize=a("FPDFAnnot_GetFontSize",3),e._FPDFAnnot_SetFontColor=a("FPDFAnnot_SetFontColor",5),e._FPDFAnnot_GetFontColor=a("FPDFAnnot_GetFontColor",5),e._FPDFAnnot_IsChecked=a("FPDFAnnot_IsChecked",2),e._FPDFAnnot_SetFocusableSubtypes=a("FPDFAnnot_SetFocusableSubtypes",3),e._FPDFAnnot_GetFocusableSubtypesCount=a("FPDFAnnot_GetFocusableSubtypesCount",1),e._FPDFAnnot_GetFocusableSubtypes=a("FPDFAnnot_GetFocusableSubtypes",3),e._FPDFAnnot_GetLink=a("FPDFAnnot_GetLink",1),e._FPDFAnnot_GetFormControlCount=a("FPDFAnnot_GetFormControlCount",2),e._FPDFAnnot_GetFormControlIndex=a("FPDFAnnot_GetFormControlIndex",2),e._FPDFAnnot_GetFormFieldExportValue=a("FPDFAnnot_GetFormFieldExportValue",4),e._FPDFAnnot_SetURI=a("FPDFAnnot_SetURI",2),e._FPDFAnnot_GetFileAttachment=a("FPDFAnnot_GetFileAttachment",1),e._FPDFAnnot_AddFileAttachment=a("FPDFAnnot_AddFileAttachment",2),e._EPDFAnnot_SetColor=a("EPDFAnnot_SetColor",5),e._EPDFAnnot_GetColor=a("EPDFAnnot_GetColor",5),e._EPDFAnnot_ClearColor=a("EPDFAnnot_ClearColor",2),e._EPDFAnnot_SetOpacity=a("EPDFAnnot_SetOpacity",2),e._EPDFAnnot_GetOpacity=a("EPDFAnnot_GetOpacity",2),e._EPDFAnnot_GetBorderEffect=a("EPDFAnnot_GetBorderEffect",2),e._EPDFAnnot_GetRectangleDifferences=a("EPDFAnnot_GetRectangleDifferences",5),e._EPDFAnnot_GetBorderDashPatternCount=a("EPDFAnnot_GetBorderDashPatternCount",1),e._EPDFAnnot_GetBorderDashPattern=a("EPDFAnnot_GetBorderDashPattern",3),e._EPDFAnnot_SetBorderDashPattern=a("EPDFAnnot_SetBorderDashPattern",3),e._EPDFAnnot_GetBorderStyle=a("EPDFAnnot_GetBorderStyle",2),e._EPDFAnnot_SetBorderStyle=a("EPDFAnnot_SetBorderStyle",3),e._EPDFAnnot_GenerateAppearance=a("EPDFAnnot_GenerateAppearance",1),e._EPDFAnnot_GenerateAppearanceWithBlend=a("EPDFAnnot_GenerateAppearanceWithBlend",2),e._EPDFAnnot_GetBlendMode=a("EPDFAnnot_GetBlendMode",1),e._EPDFAnnot_SetIntent=a("EPDFAnnot_SetIntent",2),e._EPDFAnnot_GetIntent=a("EPDFAnnot_GetIntent",3),e._EPDFAnnot_GetRichContent=a("EPDFAnnot_GetRichContent",3),e._EPDFAnnot_SetLineEndings=a("EPDFAnnot_SetLineEndings",3),e._EPDFAnnot_GetLineEndings=a("EPDFAnnot_GetLineEndings",3),e._EPDFAnnot_SetVertices=a("EPDFAnnot_SetVertices",3),e._EPDFAnnot_SetLine=a("EPDFAnnot_SetLine",3),e._EPDFAnnot_SetDefaultAppearance=a("EPDFAnnot_SetDefaultAppearance",6),e._EPDFAnnot_GetDefaultAppearance=a("EPDFAnnot_GetDefaultAppearance",6),e._EPDFAnnot_SetTextAlignment=a("EPDFAnnot_SetTextAlignment",2),e._EPDFAnnot_GetTextAlignment=a("EPDFAnnot_GetTextAlignment",1),e._EPDFAnnot_SetVerticalAlignment=a("EPDFAnnot_SetVerticalAlignment",2),e._EPDFAnnot_GetVerticalAlignment=a("EPDFAnnot_GetVerticalAlignment",1),e._EPDFPage_GetAnnotByName=a("EPDFPage_GetAnnotByName",2),e._EPDFPage_RemoveAnnotByName=a("EPDFPage_RemoveAnnotByName",2),e._EPDFAnnot_SetLinkedAnnot=a("EPDFAnnot_SetLinkedAnnot",3),e._EPDFPage_GetAnnotCountRaw=a("EPDFPage_GetAnnotCountRaw",2),e._EPDFPage_GetAnnotRaw=a("EPDFPage_GetAnnotRaw",3),e._EPDFPage_RemoveAnnotRaw=a("EPDFPage_RemoveAnnotRaw",3),e._EPDFAnnot_SetIcon=a("EPDFAnnot_SetIcon",2),e._EPDFAnnot_GetIcon=a("EPDFAnnot_GetIcon",1),e._EPDFAnnot_UpdateAppearanceToRect=a("EPDFAnnot_UpdateAppearanceToRect",2),e._EPDFPage_CreateAnnot=a("EPDFPage_CreateAnnot",2),e._FPDFDoc_GetAttachmentCount=a("FPDFDoc_GetAttachmentCount",1),e._FPDFDoc_AddAttachment=a("FPDFDoc_AddAttachment",2),e._FPDFDoc_GetAttachment=a("FPDFDoc_GetAttachment",2),e._FPDFDoc_DeleteAttachment=a("FPDFDoc_DeleteAttachment",2),e._FPDFAttachment_GetName=a("FPDFAttachment_GetName",3),e._FPDFAttachment_HasKey=a("FPDFAttachment_HasKey",2),e._FPDFAttachment_GetValueType=a("FPDFAttachment_GetValueType",2),e._FPDFAttachment_SetStringValue=a("FPDFAttachment_SetStringValue",3),e._FPDFAttachment_GetStringValue=a("FPDFAttachment_GetStringValue",4),e._FPDFAttachment_SetFile=a("FPDFAttachment_SetFile",4),e._FPDFAttachment_GetFile=a("FPDFAttachment_GetFile",4),e._FPDFAttachment_GetSubtype=a("FPDFAttachment_GetSubtype",3),e._EPDFAttachment_SetSubtype=a("EPDFAttachment_SetSubtype",2),e._EPDFAttachment_SetDescription=a("EPDFAttachment_SetDescription",2),e._EPDFAttachment_GetDescription=a("EPDFAttachment_GetDescription",3),e._EPDFAttachment_GetIntegerValue=a("EPDFAttachment_GetIntegerValue",3),e._FPDFCatalog_IsTagged=a("FPDFCatalog_IsTagged",1),e._FPDFCatalog_SetLanguage=a("FPDFCatalog_SetLanguage",2),e._EPDFCatalog_GetLanguage=a("EPDFCatalog_GetLanguage",3),e._FPDFAvail_Create=a("FPDFAvail_Create",2),e._FPDFAvail_Destroy=a("FPDFAvail_Destroy",1),e._FPDFAvail_IsDocAvail=a("FPDFAvail_IsDocAvail",2),e._FPDFAvail_GetDocument=a("FPDFAvail_GetDocument",2),e._FPDFAvail_GetFirstPageNum=a("FPDFAvail_GetFirstPageNum",1),e._FPDFAvail_IsPageAvail=a("FPDFAvail_IsPageAvail",3),e._FPDFAvail_IsFormAvail=a("FPDFAvail_IsFormAvail",2),e._FPDFAvail_IsLinearized=a("FPDFAvail_IsLinearized",1),e._FPDFBookmark_GetFirstChild=a("FPDFBookmark_GetFirstChild",2),e._FPDFBookmark_GetNextSibling=a("FPDFBookmark_GetNextSibling",2),e._FPDFBookmark_GetTitle=a("FPDFBookmark_GetTitle",3),e._FPDFBookmark_GetCount=a("FPDFBookmark_GetCount",1),e._FPDFBookmark_Find=a("FPDFBookmark_Find",2),e._FPDFBookmark_GetDest=a("FPDFBookmark_GetDest",2),e._FPDFBookmark_GetAction=a("FPDFBookmark_GetAction",1),e._FPDFAction_GetType=a("FPDFAction_GetType",1),e._FPDFAction_GetDest=a("FPDFAction_GetDest",2),e._FPDFAction_GetFilePath=a("FPDFAction_GetFilePath",3),e._FPDFAction_GetURIPath=a("FPDFAction_GetURIPath",4),e._FPDFDest_GetDestPageIndex=a("FPDFDest_GetDestPageIndex",2),e._FPDFDest_GetView=a("FPDFDest_GetView",3),e._FPDFDest_GetLocationInPage=a("FPDFDest_GetLocationInPage",7),e._FPDFLink_GetLinkAtPoint=a("FPDFLink_GetLinkAtPoint",3),e._FPDFLink_GetLinkZOrderAtPoint=a("FPDFLink_GetLinkZOrderAtPoint",3),e._FPDFLink_GetDest=a("FPDFLink_GetDest",2),e._FPDFLink_GetAction=a("FPDFLink_GetAction",1),e._FPDFLink_Enumerate=a("FPDFLink_Enumerate",3),e._FPDFLink_GetAnnot=a("FPDFLink_GetAnnot",2),e._FPDFLink_GetAnnotRect=a("FPDFLink_GetAnnotRect",2),e._FPDFLink_CountQuadPoints=a("FPDFLink_CountQuadPoints",1),e._FPDFLink_GetQuadPoints=a("FPDFLink_GetQuadPoints",3),e._FPDF_GetPageAAction=a("FPDF_GetPageAAction",2),e._FPDF_GetFileIdentifier=a("FPDF_GetFileIdentifier",4),e._FPDF_GetMetaText=a("FPDF_GetMetaText",4),e._FPDF_GetPageLabel=a("FPDF_GetPageLabel",4),e._EPDF_SetMetaText=a("EPDF_SetMetaText",3),e._EPDF_HasMetaText=a("EPDF_HasMetaText",2),e._EPDF_GetMetaTrapped=a("EPDF_GetMetaTrapped",1),e._EPDF_SetMetaTrapped=a("EPDF_SetMetaTrapped",2),e._EPDF_GetMetaKeyCount=a("EPDF_GetMetaKeyCount",2),e._EPDF_GetMetaKeyName=a("EPDF_GetMetaKeyName",5),e._FPDFPageObj_NewImageObj=a("FPDFPageObj_NewImageObj",1),e._FPDFImageObj_LoadJpegFile=a("FPDFImageObj_LoadJpegFile",4),e._FPDFImageObj_LoadJpegFileInline=a("FPDFImageObj_LoadJpegFileInline",4),e._FPDFImageObj_SetMatrix=a("FPDFImageObj_SetMatrix",7),e._FPDFImageObj_SetBitmap=a("FPDFImageObj_SetBitmap",4),e._FPDFImageObj_GetBitmap=a("FPDFImageObj_GetBitmap",1),e._FPDFImageObj_GetRenderedBitmap=a("FPDFImageObj_GetRenderedBitmap",3),e._FPDFImageObj_GetImageDataDecoded=a("FPDFImageObj_GetImageDataDecoded",3),e._FPDFImageObj_GetImageDataRaw=a("FPDFImageObj_GetImageDataRaw",3),e._FPDFImageObj_GetImageFilterCount=a("FPDFImageObj_GetImageFilterCount",1),e._FPDFImageObj_GetImageFilter=a("FPDFImageObj_GetImageFilter",4),e._FPDFImageObj_GetImageMetadata=a("FPDFImageObj_GetImageMetadata",3),e._FPDFImageObj_GetImagePixelSize=a("FPDFImageObj_GetImagePixelSize",3),e._FPDFImageObj_GetIccProfileDataDecoded=a("FPDFImageObj_GetIccProfileDataDecoded",5),e._FPDF_CreateNewDocument=a("FPDF_CreateNewDocument",0),e._FPDFPage_Delete=a("FPDFPage_Delete",2),e._FPDF_MovePages=a("FPDF_MovePages",4),e._FPDFPage_New=a("FPDFPage_New",4),e._FPDFPage_GetRotation=a("FPDFPage_GetRotation",1),e._FPDFPage_InsertObject=a("FPDFPage_InsertObject",2),e._FPDFPage_InsertObjectAtIndex=a("FPDFPage_InsertObjectAtIndex",3),e._FPDFPage_RemoveObject=a("FPDFPage_RemoveObject",2),e._FPDFPage_CountObjects=a("FPDFPage_CountObjects",1),e._FPDFPage_GetObject=a("FPDFPage_GetObject",2),e._FPDFPage_HasTransparency=a("FPDFPage_HasTransparency",1),e._FPDFPageObj_Destroy=a("FPDFPageObj_Destroy",1),e._FPDFPageObj_GetMarkedContentID=a("FPDFPageObj_GetMarkedContentID",1),e._FPDFPageObj_CountMarks=a("FPDFPageObj_CountMarks",1),e._FPDFPageObj_GetMark=a("FPDFPageObj_GetMark",2),e._FPDFPageObj_AddMark=a("FPDFPageObj_AddMark",2),e._FPDFPageObj_RemoveMark=a("FPDFPageObj_RemoveMark",2),e._FPDFPageObjMark_GetName=a("FPDFPageObjMark_GetName",4),e._FPDFPageObjMark_CountParams=a("FPDFPageObjMark_CountParams",1),e._FPDFPageObjMark_GetParamKey=a("FPDFPageObjMark_GetParamKey",5),e._FPDFPageObjMark_GetParamValueType=a("FPDFPageObjMark_GetParamValueType",2),e._FPDFPageObjMark_GetParamIntValue=a("FPDFPageObjMark_GetParamIntValue",3),e._FPDFPageObjMark_GetParamStringValue=a("FPDFPageObjMark_GetParamStringValue",5),e._FPDFPageObjMark_GetParamBlobValue=a("FPDFPageObjMark_GetParamBlobValue",5),e._FPDFPageObj_HasTransparency=a("FPDFPageObj_HasTransparency",1),e._FPDFPageObjMark_SetIntParam=a("FPDFPageObjMark_SetIntParam",5),e._FPDFPageObjMark_SetStringParam=a("FPDFPageObjMark_SetStringParam",5),e._FPDFPageObjMark_SetBlobParam=a("FPDFPageObjMark_SetBlobParam",6),e._FPDFPageObjMark_RemoveParam=a("FPDFPageObjMark_RemoveParam",3),e._FPDFPageObj_GetType=a("FPDFPageObj_GetType",1),e._FPDFPageObj_GetIsActive=a("FPDFPageObj_GetIsActive",2),e._FPDFPageObj_SetIsActive=a("FPDFPageObj_SetIsActive",2),e._FPDFPage_GenerateContent=a("FPDFPage_GenerateContent",1),e._FPDFPageObj_Transform=a("FPDFPageObj_Transform",7),e._FPDFPageObj_TransformF=a("FPDFPageObj_TransformF",2),e._FPDFPageObj_GetMatrix=a("FPDFPageObj_GetMatrix",2),e._FPDFPageObj_SetMatrix=a("FPDFPageObj_SetMatrix",2),e._FPDFPageObj_SetBlendMode=a("FPDFPageObj_SetBlendMode",2),e._FPDFPage_TransformAnnots=a("FPDFPage_TransformAnnots",7),e._FPDFPage_SetRotation=a("FPDFPage_SetRotation",2),e._FPDFPageObj_SetFillColor=a("FPDFPageObj_SetFillColor",5),e._FPDFPageObj_GetFillColor=a("FPDFPageObj_GetFillColor",5),e._FPDFPageObj_GetBounds=a("FPDFPageObj_GetBounds",5),e._FPDFPageObj_GetRotatedBounds=a("FPDFPageObj_GetRotatedBounds",2),e._FPDFPageObj_SetStrokeColor=a("FPDFPageObj_SetStrokeColor",5),e._FPDFPageObj_GetStrokeColor=a("FPDFPageObj_GetStrokeColor",5),e._FPDFPageObj_SetStrokeWidth=a("FPDFPageObj_SetStrokeWidth",2),e._FPDFPageObj_GetStrokeWidth=a("FPDFPageObj_GetStrokeWidth",2),e._FPDFPageObj_GetLineJoin=a("FPDFPageObj_GetLineJoin",1),e._FPDFPageObj_SetLineJoin=a("FPDFPageObj_SetLineJoin",2),e._FPDFPageObj_GetLineCap=a("FPDFPageObj_GetLineCap",1),e._FPDFPageObj_SetLineCap=a("FPDFPageObj_SetLineCap",2),e._FPDFPageObj_GetDashPhase=a("FPDFPageObj_GetDashPhase",2),e._FPDFPageObj_SetDashPhase=a("FPDFPageObj_SetDashPhase",2),e._FPDFPageObj_GetDashCount=a("FPDFPageObj_GetDashCount",1),e._FPDFPageObj_GetDashArray=a("FPDFPageObj_GetDashArray",3),e._FPDFPageObj_SetDashArray=a("FPDFPageObj_SetDashArray",4),e._FPDFFormObj_CountObjects=a("FPDFFormObj_CountObjects",1),e._FPDFFormObj_GetObject=a("FPDFFormObj_GetObject",2),e._FPDFFormObj_RemoveObject=a("FPDFFormObj_RemoveObject",2),e._FPDFPageObj_CreateNewPath=a("FPDFPageObj_CreateNewPath",2),e._FPDFPageObj_CreateNewRect=a("FPDFPageObj_CreateNewRect",4),e._FPDFPath_CountSegments=a("FPDFPath_CountSegments",1),e._FPDFPath_GetPathSegment=a("FPDFPath_GetPathSegment",2),e._FPDFPath_MoveTo=a("FPDFPath_MoveTo",3),e._FPDFPath_LineTo=a("FPDFPath_LineTo",3),e._FPDFPath_BezierTo=a("FPDFPath_BezierTo",7),e._FPDFPath_Close=a("FPDFPath_Close",1),e._FPDFPath_SetDrawMode=a("FPDFPath_SetDrawMode",3),e._FPDFPath_GetDrawMode=a("FPDFPath_GetDrawMode",3),e._FPDFPathSegment_GetPoint=a("FPDFPathSegment_GetPoint",3),e._FPDFPathSegment_GetType=a("FPDFPathSegment_GetType",1),e._FPDFPathSegment_GetClose=a("FPDFPathSegment_GetClose",1),e._FPDFPageObj_NewTextObj=a("FPDFPageObj_NewTextObj",3),e._FPDFText_SetText=a("FPDFText_SetText",2),e._FPDFText_SetCharcodes=a("FPDFText_SetCharcodes",3),e._FPDFText_LoadFont=a("FPDFText_LoadFont",5),e._FPDFText_LoadStandardFont=a("FPDFText_LoadStandardFont",2),e._FPDFText_LoadCidType2Font=a("FPDFText_LoadCidType2Font",6),e._FPDFTextObj_GetFontSize=a("FPDFTextObj_GetFontSize",2),e._FPDFTextObj_GetText=a("FPDFTextObj_GetText",4),e._FPDFTextObj_GetRenderedBitmap=a("FPDFTextObj_GetRenderedBitmap",4),e._FPDFFont_Close=a("FPDFFont_Close",1),e._FPDFPageObj_CreateTextObj=a("FPDFPageObj_CreateTextObj",3),e._FPDFTextObj_GetTextRenderMode=a("FPDFTextObj_GetTextRenderMode",1),e._FPDFTextObj_SetTextRenderMode=a("FPDFTextObj_SetTextRenderMode",2),e._FPDFTextObj_GetFont=a("FPDFTextObj_GetFont",1),e._FPDFFont_GetBaseFontName=a("FPDFFont_GetBaseFontName",3),e._FPDFFont_GetFamilyName=a("FPDFFont_GetFamilyName",3),e._FPDFFont_GetFontData=a("FPDFFont_GetFontData",4),e._FPDFFont_GetIsEmbedded=a("FPDFFont_GetIsEmbedded",1),e._FPDFFont_GetFlags=a("FPDFFont_GetFlags",1),e._FPDFFont_GetWeight=a("FPDFFont_GetWeight",1),e._FPDFFont_GetItalicAngle=a("FPDFFont_GetItalicAngle",2),e._FPDFFont_GetAscent=a("FPDFFont_GetAscent",3),e._FPDFFont_GetDescent=a("FPDFFont_GetDescent",3),e._FPDFFont_GetGlyphWidth=a("FPDFFont_GetGlyphWidth",4),e._FPDFFont_GetGlyphPath=a("FPDFFont_GetGlyphPath",3),e._FPDFGlyphPath_CountGlyphSegments=a("FPDFGlyphPath_CountGlyphSegments",1),e._FPDFGlyphPath_GetGlyphPathSegment=a("FPDFGlyphPath_GetGlyphPathSegment",2),e._EPDFText_RedactInRect=a("EPDFText_RedactInRect",4),e._EPDFText_RedactInQuads=a("EPDFText_RedactInQuads",5),e._FPDFDoc_GetPageMode=a("FPDFDoc_GetPageMode",1),e._FPDFPage_Flatten=a("FPDFPage_Flatten",2),e._FPDFPage_HasFormFieldAtPoint=a("FPDFPage_HasFormFieldAtPoint",4),e._FPDFPage_FormFieldZOrderAtPoint=a("FPDFPage_FormFieldZOrderAtPoint",4),e._malloc=a("malloc",1),e._free=a("free",1),e._FORM_OnMouseMove=a("FORM_OnMouseMove",5),e._FORM_OnMouseWheel=a("FORM_OnMouseWheel",6),e._FORM_OnFocus=a("FORM_OnFocus",5),e._FORM_OnLButtonDown=a("FORM_OnLButtonDown",5),e._FORM_OnLButtonUp=a("FORM_OnLButtonUp",5),e._FORM_OnLButtonDoubleClick=a("FORM_OnLButtonDoubleClick",5),e._FORM_OnRButtonDown=a("FORM_OnRButtonDown",5),e._FORM_OnRButtonUp=a("FORM_OnRButtonUp",5),e._FORM_OnKeyDown=a("FORM_OnKeyDown",4),e._FORM_OnKeyUp=a("FORM_OnKeyUp",4),e._FORM_OnChar=a("FORM_OnChar",4),e._FORM_GetFocusedText=a("FORM_GetFocusedText",4),e._FORM_GetSelectedText=a("FORM_GetSelectedText",4),e._FORM_ReplaceAndKeepSelection=a("FORM_ReplaceAndKeepSelection",3),e._FORM_ReplaceSelection=a("FORM_ReplaceSelection",3),e._FORM_SelectAllText=a("FORM_SelectAllText",2),e._FORM_CanUndo=a("FORM_CanUndo",2),e._FORM_CanRedo=a("FORM_CanRedo",2),e._FORM_Undo=a("FORM_Undo",2),e._FORM_Redo=a("FORM_Redo",2),e._FORM_ForceToKillFocus=a("FORM_ForceToKillFocus",1),e._FORM_GetFocusedAnnot=a("FORM_GetFocusedAnnot",3),e._FORM_SetFocusedAnnot=a("FORM_SetFocusedAnnot",2),e._FPDF_FFLDraw=a("FPDF_FFLDraw",9),e._FPDF_SetFormFieldHighlightColor=a("FPDF_SetFormFieldHighlightColor",3),e._FPDF_SetFormFieldHighlightAlpha=a("FPDF_SetFormFieldHighlightAlpha",2),e._FPDF_RemoveFormFieldHighlight=a("FPDF_RemoveFormFieldHighlight",1),e._FORM_OnAfterLoadPage=a("FORM_OnAfterLoadPage",2),e._FORM_OnBeforeClosePage=a("FORM_OnBeforeClosePage",2),e._FORM_DoDocumentJSAction=a("FORM_DoDocumentJSAction",1),e._FORM_DoDocumentOpenAction=a("FORM_DoDocumentOpenAction",1),e._FORM_DoDocumentAAction=a("FORM_DoDocumentAAction",2),e._FORM_DoPageAAction=a("FORM_DoPageAAction",3),e._FORM_SetIndexSelected=a("FORM_SetIndexSelected",4),e._FORM_IsIndexSelected=a("FORM_IsIndexSelected",3),e._FPDFDoc_GetJavaScriptActionCount=a("FPDFDoc_GetJavaScriptActionCount",1),e._FPDFDoc_GetJavaScriptAction=a("FPDFDoc_GetJavaScriptAction",2),e._FPDFDoc_CloseJavaScriptAction=a("FPDFDoc_CloseJavaScriptAction",1),e._FPDFJavaScriptAction_GetName=a("FPDFJavaScriptAction_GetName",3),e._FPDFJavaScriptAction_GetScript=a("FPDFJavaScriptAction_GetScript",3),e._FPDF_ImportPagesByIndex=a("FPDF_ImportPagesByIndex",5),e._FPDF_ImportPages=a("FPDF_ImportPages",4),e._FPDF_ImportNPagesToOne=a("FPDF_ImportNPagesToOne",5),e._FPDF_NewXObjectFromPage=a("FPDF_NewXObjectFromPage",3),e._FPDF_CloseXObject=a("FPDF_CloseXObject",1),e._FPDF_NewFormObjectFromXObject=a("FPDF_NewFormObjectFromXObject",1),e._FPDF_CopyViewerPreferences=a("FPDF_CopyViewerPreferences",2),e._FPDF_RenderPageBitmapWithColorScheme_Start=a("FPDF_RenderPageBitmapWithColorScheme_Start",10),e._FPDF_RenderPageBitmap_Start=a("FPDF_RenderPageBitmap_Start",9),e._FPDF_RenderPage_Continue=a("FPDF_RenderPage_Continue",2),e._FPDF_RenderPage_Close=a("FPDF_RenderPage_Close",1),e._FPDF_SaveWithVersion=a("FPDF_SaveWithVersion",4),e._FPDFText_GetCharIndexFromTextIndex=a("FPDFText_GetCharIndexFromTextIndex",2),e._FPDFText_GetTextIndexFromCharIndex=a("FPDFText_GetTextIndexFromCharIndex",2),e._FPDF_GetSignatureCount=a("FPDF_GetSignatureCount",1),e._FPDF_GetSignatureObject=a("FPDF_GetSignatureObject",2),e._FPDFSignatureObj_GetContents=a("FPDFSignatureObj_GetContents",3),e._FPDFSignatureObj_GetByteRange=a("FPDFSignatureObj_GetByteRange",3),e._FPDFSignatureObj_GetSubFilter=a("FPDFSignatureObj_GetSubFilter",3),e._FPDFSignatureObj_GetReason=a("FPDFSignatureObj_GetReason",3),e._FPDFSignatureObj_GetTime=a("FPDFSignatureObj_GetTime",3),e._FPDFSignatureObj_GetDocMDPPermission=a("FPDFSignatureObj_GetDocMDPPermission",1),e._FPDF_StructTree_GetForPage=a("FPDF_StructTree_GetForPage",1),e._FPDF_StructTree_Close=a("FPDF_StructTree_Close",1),e._FPDF_StructTree_CountChildren=a("FPDF_StructTree_CountChildren",1),e._FPDF_StructTree_GetChildAtIndex=a("FPDF_StructTree_GetChildAtIndex",2),e._FPDF_StructElement_GetAltText=a("FPDF_StructElement_GetAltText",3),e._FPDF_StructElement_GetActualText=a("FPDF_StructElement_GetActualText",3),e._FPDF_StructElement_GetID=a("FPDF_StructElement_GetID",3),e._FPDF_StructElement_GetLang=a("FPDF_StructElement_GetLang",3),e._FPDF_StructElement_GetAttributeCount=a("FPDF_StructElement_GetAttributeCount",1),e._FPDF_StructElement_GetAttributeAtIndex=a("FPDF_StructElement_GetAttributeAtIndex",2),e._FPDF_StructElement_GetStringAttribute=a("FPDF_StructElement_GetStringAttribute",4),e._FPDF_StructElement_GetMarkedContentID=a("FPDF_StructElement_GetMarkedContentID",1),e._FPDF_StructElement_GetType=a("FPDF_StructElement_GetType",3),e._FPDF_StructElement_GetObjType=a("FPDF_StructElement_GetObjType",3),e._FPDF_StructElement_GetTitle=a("FPDF_StructElement_GetTitle",3),e._FPDF_StructElement_CountChildren=a("FPDF_StructElement_CountChildren",1),e._FPDF_StructElement_GetChildAtIndex=a("FPDF_StructElement_GetChildAtIndex",2),e._FPDF_StructElement_GetChildMarkedContentID=a("FPDF_StructElement_GetChildMarkedContentID",2),e._FPDF_StructElement_GetParent=a("FPDF_StructElement_GetParent",1),e._FPDF_StructElement_Attr_GetCount=a("FPDF_StructElement_Attr_GetCount",1),e._FPDF_StructElement_Attr_GetName=a("FPDF_StructElement_Attr_GetName",5),e._FPDF_StructElement_Attr_GetValue=a("FPDF_StructElement_Attr_GetValue",2),e._FPDF_StructElement_Attr_GetType=a("FPDF_StructElement_Attr_GetType",1),e._FPDF_StructElement_Attr_GetBooleanValue=a("FPDF_StructElement_Attr_GetBooleanValue",2),e._FPDF_StructElement_Attr_GetNumberValue=a("FPDF_StructElement_Attr_GetNumberValue",2),e._FPDF_StructElement_Attr_GetStringValue=a("FPDF_StructElement_Attr_GetStringValue",4),e._FPDF_StructElement_Attr_GetBlobValue=a("FPDF_StructElement_Attr_GetBlobValue",4),e._FPDF_StructElement_Attr_CountChildren=a("FPDF_StructElement_Attr_CountChildren",1),e._FPDF_StructElement_Attr_GetChildAtIndex=a("FPDF_StructElement_Attr_GetChildAtIndex",2),e._FPDF_StructElement_GetMarkedContentIdCount=a("FPDF_StructElement_GetMarkedContentIdCount",1),e._FPDF_StructElement_GetMarkedContentIdAtIndex=a("FPDF_StructElement_GetMarkedContentIdAtIndex",2),e._FPDF_AddInstalledFont=a("FPDF_AddInstalledFont",3),e._FPDF_SetSystemFontInfo=a("FPDF_SetSystemFontInfo",1),e._FPDF_GetDefaultTTFMap=a("FPDF_GetDefaultTTFMap",0),e._FPDF_GetDefaultTTFMapCount=a("FPDF_GetDefaultTTFMapCount",0),e._FPDF_GetDefaultTTFMapEntry=a("FPDF_GetDefaultTTFMapEntry",1),e._FPDF_GetDefaultSystemFontInfo=a("FPDF_GetDefaultSystemFontInfo",0),e._FPDF_FreeDefaultSystemFontInfo=a("FPDF_FreeDefaultSystemFontInfo",1),e._FPDFText_LoadPage=a("FPDFText_LoadPage",1),e._FPDFText_ClosePage=a("FPDFText_ClosePage",1),e._FPDFText_CountChars=a("FPDFText_CountChars",1),e._FPDFText_GetUnicode=a("FPDFText_GetUnicode",2),e._FPDFText_GetTextObject=a("FPDFText_GetTextObject",2),e._FPDFText_IsGenerated=a("FPDFText_IsGenerated",2),e._FPDFText_IsHyphen=a("FPDFText_IsHyphen",2),e._FPDFText_HasUnicodeMapError=a("FPDFText_HasUnicodeMapError",2),e._FPDFText_GetFontSize=a("FPDFText_GetFontSize",2),e._FPDFText_GetFontInfo=a("FPDFText_GetFontInfo",5),e._FPDFText_GetFontWeight=a("FPDFText_GetFontWeight",2),e._FPDFText_GetFillColor=a("FPDFText_GetFillColor",6),e._FPDFText_GetStrokeColor=a("FPDFText_GetStrokeColor",6),e._FPDFText_GetCharAngle=a("FPDFText_GetCharAngle",2),e._FPDFText_GetCharBox=a("FPDFText_GetCharBox",6),e._FPDFText_GetLooseCharBox=a("FPDFText_GetLooseCharBox",3),e._FPDFText_GetMatrix=a("FPDFText_GetMatrix",3),e._FPDFText_GetCharOrigin=a("FPDFText_GetCharOrigin",4),e._FPDFText_GetCharIndexAtPos=a("FPDFText_GetCharIndexAtPos",5),e._FPDFText_GetText=a("FPDFText_GetText",4),e._FPDFText_CountRects=a("FPDFText_CountRects",3),e._FPDFText_GetRect=a("FPDFText_GetRect",6),e._FPDFText_GetBoundedText=a("FPDFText_GetBoundedText",7),e._FPDFText_FindStart=a("FPDFText_FindStart",4),e._FPDFText_FindNext=a("FPDFText_FindNext",1),e._FPDFText_FindPrev=a("FPDFText_FindPrev",1),e._FPDFText_GetSchResultIndex=a("FPDFText_GetSchResultIndex",1),e._FPDFText_GetSchCount=a("FPDFText_GetSchCount",1),e._FPDFText_FindClose=a("FPDFText_FindClose",1),e._FPDFLink_LoadWebLinks=a("FPDFLink_LoadWebLinks",1),e._FPDFLink_CountWebLinks=a("FPDFLink_CountWebLinks",1),e._FPDFLink_GetURL=a("FPDFLink_GetURL",4),e._FPDFLink_CountRects=a("FPDFLink_CountRects",2),e._FPDFLink_GetRect=a("FPDFLink_GetRect",7),e._FPDFLink_GetTextRange=a("FPDFLink_GetTextRange",4),e._FPDFLink_CloseWebLinks=a("FPDFLink_CloseWebLinks",1),e._FPDFPage_GetDecodedThumbnailData=a("FPDFPage_GetDecodedThumbnailData",3),e._FPDFPage_GetRawThumbnailData=a("FPDFPage_GetRawThumbnailData",3),e._FPDFPage_GetThumbnailAsBitmap=a("FPDFPage_GetThumbnailAsBitmap",1),e._FPDFPage_SetMediaBox=a("FPDFPage_SetMediaBox",5),e._FPDFPage_SetCropBox=a("FPDFPage_SetCropBox",5),e._FPDFPage_SetBleedBox=a("FPDFPage_SetBleedBox",5),e._FPDFPage_SetTrimBox=a("FPDFPage_SetTrimBox",5),e._FPDFPage_SetArtBox=a("FPDFPage_SetArtBox",5),e._FPDFPage_GetMediaBox=a("FPDFPage_GetMediaBox",5),e._FPDFPage_GetCropBox=a("FPDFPage_GetCropBox",5),e._FPDFPage_GetBleedBox=a("FPDFPage_GetBleedBox",5),e._FPDFPage_GetTrimBox=a("FPDFPage_GetTrimBox",5),e._FPDFPage_GetArtBox=a("FPDFPage_GetArtBox",5),e._FPDFPage_TransFormWithClip=a("FPDFPage_TransFormWithClip",3),e._FPDFPageObj_TransformClipPath=a("FPDFPageObj_TransformClipPath",7),e._FPDFPageObj_GetClipPath=a("FPDFPageObj_GetClipPath",1),e._FPDFClipPath_CountPaths=a("FPDFClipPath_CountPaths",1),e._FPDFClipPath_CountPathSegments=a("FPDFClipPath_CountPathSegments",2),e._FPDFClipPath_GetPathSegment=a("FPDFClipPath_GetPathSegment",3),e._FPDF_CreateClipPath=a("FPDF_CreateClipPath",4),e._FPDF_DestroyClipPath=a("FPDF_DestroyClipPath",1),e._FPDFPage_InsertClipPath=a("FPDFPage_InsertClipPath",2),e._FPDF_InitLibrary=a("FPDF_InitLibrary",0),e._FPDF_DestroyLibrary=a("FPDF_DestroyLibrary",0),e._FPDF_SetSandBoxPolicy=a("FPDF_SetSandBoxPolicy",2),e._FPDF_LoadDocument=a("FPDF_LoadDocument",2),e._FPDF_GetFormType=a("FPDF_GetFormType",1),e._FPDF_LoadXFA=a("FPDF_LoadXFA",1),e._FPDF_LoadMemDocument=a("FPDF_LoadMemDocument",3),e._FPDF_LoadMemDocument64=a("FPDF_LoadMemDocument64",3),e._FPDF_LoadCustomDocument=a("FPDF_LoadCustomDocument",2),e._FPDF_GetFileVersion=a("FPDF_GetFileVersion",2),e._FPDF_DocumentHasValidCrossReferenceTable=a("FPDF_DocumentHasValidCrossReferenceTable",1),e._FPDF_GetDocPermissions=a("FPDF_GetDocPermissions",1),e._FPDF_GetDocUserPermissions=a("FPDF_GetDocUserPermissions",1),e._FPDF_GetSecurityHandlerRevision=a("FPDF_GetSecurityHandlerRevision",1),e._FPDF_GetPageCount=a("FPDF_GetPageCount",1),e._FPDF_LoadPage=a("FPDF_LoadPage",2),e._FPDF_GetPageWidthF=a("FPDF_GetPageWidthF",1),e._FPDF_GetPageWidth=a("FPDF_GetPageWidth",1),e._FPDF_GetPageHeightF=a("FPDF_GetPageHeightF",1),e._FPDF_GetPageHeight=a("FPDF_GetPageHeight",1),e._FPDF_GetPageBoundingBox=a("FPDF_GetPageBoundingBox",2),e._FPDF_RenderPageBitmap=a("FPDF_RenderPageBitmap",8),e._FPDF_RenderPageBitmapWithMatrix=a("FPDF_RenderPageBitmapWithMatrix",5),e._EPDF_RenderAnnotBitmap=a("EPDF_RenderAnnotBitmap",6),e._FPDF_ClosePage=a("FPDF_ClosePage",1),e._FPDF_CloseDocument=a("FPDF_CloseDocument",1),e._FPDF_GetLastError=a("FPDF_GetLastError",0),e._FPDF_DeviceToPage=a("FPDF_DeviceToPage",10),e._FPDF_PageToDevice=a("FPDF_PageToDevice",10),e._FPDFBitmap_Create=a("FPDFBitmap_Create",3),e._FPDFBitmap_CreateEx=a("FPDFBitmap_CreateEx",5),e._FPDFBitmap_GetFormat=a("FPDFBitmap_GetFormat",1),e._FPDFBitmap_FillRect=a("FPDFBitmap_FillRect",6),e._FPDFBitmap_GetBuffer=a("FPDFBitmap_GetBuffer",1),e._FPDFBitmap_GetWidth=a("FPDFBitmap_GetWidth",1),e._FPDFBitmap_GetHeight=a("FPDFBitmap_GetHeight",1),e._FPDFBitmap_GetStride=a("FPDFBitmap_GetStride",1),e._FPDFBitmap_Destroy=a("FPDFBitmap_Destroy",1),e._FPDF_GetPageSizeByIndexF=a("FPDF_GetPageSizeByIndexF",3),e._EPDF_GetPageRotationByIndex=a("EPDF_GetPageRotationByIndex",2),e._FPDF_GetPageSizeByIndex=a("FPDF_GetPageSizeByIndex",4),e._FPDF_VIEWERREF_GetPrintScaling=a("FPDF_VIEWERREF_GetPrintScaling",1),e._FPDF_VIEWERREF_GetNumCopies=a("FPDF_VIEWERREF_GetNumCopies",1),e._FPDF_VIEWERREF_GetPrintPageRange=a("FPDF_VIEWERREF_GetPrintPageRange",1),e._FPDF_VIEWERREF_GetPrintPageRangeCount=a("FPDF_VIEWERREF_GetPrintPageRangeCount",1),e._FPDF_VIEWERREF_GetPrintPageRangeElement=a("FPDF_VIEWERREF_GetPrintPageRangeElement",2),e._FPDF_VIEWERREF_GetDuplex=a("FPDF_VIEWERREF_GetDuplex",1),e._FPDF_VIEWERREF_GetName=a("FPDF_VIEWERREF_GetName",4),e._FPDF_CountNamedDests=a("FPDF_CountNamedDests",1),e._FPDF_GetNamedDestByName=a("FPDF_GetNamedDestByName",2),e._FPDF_GetNamedDest=a("FPDF_GetNamedDest",4),e._FPDF_GetXFAPacketCount=a("FPDF_GetXFAPacketCount",1),e._FPDF_GetXFAPacketName=a("FPDF_GetXFAPacketName",4),e._FPDF_GetXFAPacketContent=a("FPDF_GetXFAPacketContent",5),e._FPDF_GetTrailerEnds=a("FPDF_GetTrailerEnds",3);var vr=a("fflush",1),Tr=a("emscripten_builtin_memalign",2),xr=a("strerror",1),Se=a("setThrew",2),zt=()=>(zt=le.emscripten_stack_init)(),Pt=()=>(Pt=le.emscripten_stack_get_end)(),Ht=t=>(Ht=le._emscripten_stack_restore)(t),$t=t=>($t=le._emscripten_stack_alloc)(t),Yt=()=>(Yt=le.emscripten_stack_get_current)();e.dynCall_ji=a("dynCall_ji",2),e.dynCall_jij=a("dynCall_jij",4),e.dynCall_iiij=a("dynCall_iiij",5),e.dynCall_iij=a("dynCall_iij",4),e.dynCall_j=a("dynCall_j",1),e.dynCall_jji=a("dynCall_jji",4),e.dynCall_iji=a("dynCall_iji",4),e.dynCall_viijii=a("dynCall_viijii",7),e.dynCall_iiji=a("dynCall_iiji",5),e.dynCall_jiji=a("dynCall_jiji",5),e.dynCall_iiiiij=a("dynCall_iiiiij",7),e.dynCall_iiiiijj=a("dynCall_iiiiijj",9),e.dynCall_iiiiiijj=a("dynCall_iiiiiijj",10),e.dynCall_viji=a("dynCall_viji",5);function Or(t,o,s,m){var c=be();try{Pe(t)(o,s,m)}catch(g){if(De(c),g!==g+0)throw g;Se(1,0)}}function kr(t,o){var s=be();try{return Pe(t)(o)}catch(m){if(De(s),m!==m+0)throw m;Se(1,0)}}function wr(t,o,s){var m=be();try{return Pe(t)(o,s)}catch(c){if(De(m),c!==c+0)throw c;Se(1,0)}}function Rr(t,o,s,m){var c=be();try{return Pe(t)(o,s,m)}catch(g){if(De(c),g!==g+0)throw g;Se(1,0)}}function Ir(t,o,s,m,c){var g=be();try{Pe(t)(o,s,m,c)}catch(p){if(De(g),p!==p+0)throw p;Se(1,0)}}function jr(t,o,s,m,c){var g=be();try{return Pe(t)(o,s,m,c)}catch(p){if(De(g),p!==p+0)throw p;Se(1,0)}}function Br(t){var o=be();try{Pe(t)()}catch(s){if(De(o),s!==s+0)throw s;Se(1,0)}}function Lr(t,o,s){var m=be();try{Pe(t)(o,s)}catch(c){if(De(m),c!==c+0)throw c;Se(1,0)}}function Nr(t,o,s,m,c,g,p,E,T,j){var V=be();try{Pe(t)(o,s,m,c,g,p,E,T,j)}catch(U){if(De(V),U!==U+0)throw U;Se(1,0)}}e.wasmExports=le,e.ccall=Ut,e.cwrap=Mr,e.addFunction=pr,e.removeFunction=Sr,e.setValue=bn,e.getValue=Dn,e.UTF8ToString=Oe,e.stringToUTF8=we,e.UTF16ToString=_r,e.stringToUTF16=Gr;var Vr=["writeI53ToI64","writeI53ToI64Clamped","writeI53ToI64Signaling","writeI53ToU64Clamped","writeI53ToU64Signaling","readI53FromI64","readI53FromU64","convertI32PairToI53","convertU32PairToI53","getTempRet0","setTempRet0","exitJS","inetPton4","inetNtop4","inetPton6","inetNtop6","readSockaddr","writeSockaddr","emscriptenLog","readEmAsmArgs","jstoi_q","listenOnce","autoResumeAudioContext","dynCallLegacy","getDynCaller","dynCall","handleException","keepRuntimeAlive","runtimeKeepalivePush","runtimeKeepalivePop","callUserCallback","maybeExit","asmjsMangle","HandleAllocator","getNativeTypeSize","STACK_SIZE","STACK_ALIGN","POINTER_SIZE","ASSERTIONS","reallyNegative","unSign","strLen","reSign","formatString","intArrayToString","AsciiToString","lengthBytesUTF16","UTF32ToString","stringToUTF32","lengthBytesUTF32","stringToNewUTF8","registerKeyEventCallback","maybeCStringToJsString","findEventTarget","getBoundingClientRect","fillMouseEventData","registerMouseEventCallback","registerWheelEventCallback","registerUiEventCallback","registerFocusEventCallback","fillDeviceOrientationEventData","registerDeviceOrientationEventCallback","fillDeviceMotionEventData","registerDeviceMotionEventCallback","screenOrientation","fillOrientationChangeEventData","registerOrientationChangeEventCallback","fillFullscreenChangeEventData","registerFullscreenChangeEventCallback","JSEvents_requestFullscreen","JSEvents_resizeCanvasForFullscreen","registerRestoreOldStyle","hideEverythingExceptGivenElement","restoreHiddenElements","setLetterbox","softFullscreenResizeWebGLRenderTarget","doRequestFullscreen","fillPointerlockChangeEventData","registerPointerlockChangeEventCallback","registerPointerlockErrorEventCallback","requestPointerLock","fillVisibilityChangeEventData","registerVisibilityChangeEventCallback","registerTouchEventCallback","fillGamepadEventData","registerGamepadEventCallback","registerBeforeUnloadEventCallback","fillBatteryEventData","battery","registerBatteryEventCallback","setCanvasElementSize","getCanvasElementSize","jsStackTrace","getCallstack","convertPCtoSourceLocation","checkWasiClock","wasiRightsToMuslOFlags","wasiOFlagsToMuslOFlags","createDyncallWrapper","safeSetTimeout","setImmediateWrapped","clearImmediateWrapped","polyfillSetImmediate","registerPostMainLoop","registerPreMainLoop","getPromise","makePromise","idsToPromises","makePromiseCallback","ExceptionInfo","findMatchingCatch","Browser_asyncPrepareDataCounter","safeRequestAnimationFrame","arraySum","addDays","getSocketFromFD","getSocketAddress","FS_unlink","FS_mkdirTree","_setNetworkCallback","heapObjectForWebGLType","toTypedArrayIndex","webgl_enable_ANGLE_instanced_arrays","webgl_enable_OES_vertex_array_object","webgl_enable_WEBGL_draw_buffers","webgl_enable_WEBGL_multi_draw","webgl_enable_EXT_polygon_offset_clamp","webgl_enable_EXT_clip_control","webgl_enable_WEBGL_polygon_mode","emscriptenWebGLGet","computeUnpackAlignedImageSize","colorChannelsInGlTextureFormat","emscriptenWebGLGetTexPixelData","emscriptenWebGLGetUniform","webglGetUniformLocation","webglPrepareUniformLocationsBeforeFirstUse","webglGetLeftBracePos","emscriptenWebGLGetVertexAttrib","__glGetActiveAttribOrUniform","writeGLArray","registerWebGlEventCallback","runAndAbortIfError","ALLOC_NORMAL","ALLOC_STACK","allocate","writeStringToMemory","writeAsciiToMemory","setErrNo","demangle","stackTrace"];Vr.forEach(fn);var Ur=["run","addOnPreRun","addOnInit","addOnPreMain","addOnExit","addOnPostRun","addRunDependency","removeRunDependency","out","err","callMain","abort","wasmMemory","writeStackCookie","checkStackCookie","convertI32PairToI53Checked","stackSave","stackRestore","stackAlloc","ptrToString","zeroMemory","getHeapMax","growMemory","ENV","ERRNO_CODES","strError","DNS","Protocols","Sockets","initRandomFill","randomFill","timers","warnOnce","readEmAsmArgsArray","jstoi_s","getExecutableName","asyncLoad","alignMemory","mmapAlloc","wasmTable","noExitRuntime","getCFunc","uleb128Encode","sigToWasmTypes","generateFuncType","convertJsFunctionToWasm","freeTableIndexes","functionsInTableMap","getEmptyTableSlot","updateTableMap","getFunctionAddress","PATH","PATH_FS","UTF8Decoder","UTF8ArrayToString","stringToUTF8Array","lengthBytesUTF8","intArrayFromString","stringToAscii","UTF16Decoder","stringToUTF8OnStack","writeArrayToMemory","JSEvents","specialHTMLTargets","findCanvasEventTarget","currentFullscreenStrategy","restoreOldWindowedStyle","UNWIND_CACHE","ExitStatus","getEnvStrings","doReadv","doWritev","promiseMap","uncaughtExceptionCount","exceptionLast","exceptionCaught","Browser","getPreloadedImageData__data","wget","MONTH_DAYS_REGULAR","MONTH_DAYS_LEAP","MONTH_DAYS_REGULAR_CUMULATIVE","MONTH_DAYS_LEAP_CUMULATIVE","isLeapYear","ydayFromDate","SYSCALLS","preloadPlugins","FS_createPreloadedFile","FS_modeStringToFlags","FS_getMode","FS_stdin_getChar_buffer","FS_stdin_getChar","FS_createPath","FS_createDevice","FS_readFile","FS","FS_createDataFile","FS_createLazyFile","MEMFS","TTY","PIPEFS","SOCKFS","tempFixedLengthArray","miniTempWebGLFloatBuffers","miniTempWebGLIntBuffers","GL","AL","GLUT","EGL","GLEW","IDBStore","SDL","SDL_gfx","allocateUTF8","allocateUTF8OnStack","print","printErr"];Ur.forEach(Ot);var rt,Xt;He=function t(){rt||Kt(),rt||(He=t)};function Wr(){zt(),fe()}function Kt(){if(ve>0||(Wr(),!Xt&&(Xt=1,At(),ve>0)))return;function t(){var o;rt||(rt=1,e.calledRun=1,!Y&&(Et(),i(e),(o=e.onRuntimeInitialized)==null||o.call(e),C(!e._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),sn()))}e.setStatus?(e.setStatus("Running..."),setTimeout(()=>{setTimeout(()=>e.setStatus(""),1),t()},1)):t(),oe()}if(e.preInit)for(typeof e.preInit=="function"&&(e.preInit=[e.preInit]);e.preInit.length>0;)e.preInit.pop()();Kt(),n=F;for(const t of Object.keys(e))t in r||Object.defineProperty(r,t,{configurable:!0,get(){Z(`Access to module property ('${t}') is no longer possible via the module constructor argument; Instead, use the result of the module constructor.`)}});return n}})();const ht={EPDF_GetMetaKeyCount:[["number","boolean"],"number"],EPDF_GetMetaKeyName:[["number","number","boolean","number","number"],"number"],EPDF_GetMetaTrapped:[["number"],"number"],EPDF_GetPageRotationByIndex:[["number","number"],"number"],EPDF_HasMetaText:[["number","string"],"boolean"],EPDF_PNG_EncodeRGBA:[["number","number","number","number","number","number"],"number"],EPDF_RenderAnnotBitmap:[["number","number","number","number","number","number"],"boolean"],EPDF_SetMetaText:[["number","string","number"],"boolean"],EPDF_SetMetaTrapped:[["number","number"],"boolean"],EPDFAction_CreateGoTo:[["number","number"],"number"],EPDFAction_CreateGoToNamed:[["number","string"],"number"],EPDFAction_CreateLaunch:[["number","number"],"number"],EPDFAction_CreateRemoteGoToByName:[["number","number","number"],"number"],EPDFAction_CreateRemoteGoToDest:[["number","number","number"],"number"],EPDFAction_CreateURI:[["number","string"],"number"],EPDFAnnot_ClearColor:[["number","number"],"boolean"],EPDFAnnot_GenerateAppearance:[["number"],"boolean"],EPDFAnnot_GenerateAppearanceWithBlend:[["number","number"],"boolean"],EPDFAnnot_GetBlendMode:[["number"],"number"],EPDFAnnot_GetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_GetBorderDashPatternCount:[["number"],"number"],EPDFAnnot_GetBorderEffect:[["number","number"],"boolean"],EPDFAnnot_GetBorderStyle:[["number","number"],"number"],EPDFAnnot_GetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_GetIcon:[["number"],"number"],EPDFAnnot_GetIntent:[["number","number","number"],"number"],EPDFAnnot_GetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_GetOpacity:[["number","number"],"boolean"],EPDFAnnot_GetRectangleDifferences:[["number","number","number","number","number"],"boolean"],EPDFAnnot_GetRichContent:[["number","number","number"],"number"],EPDFAnnot_GetTextAlignment:[["number"],"number"],EPDFAnnot_GetVerticalAlignment:[["number"],"number"],EPDFAnnot_SetBorderDashPattern:[["number","number","number"],"boolean"],EPDFAnnot_SetBorderStyle:[["number","number","number"],"boolean"],EPDFAnnot_SetColor:[["number","number","number","number","number"],"boolean"],EPDFAnnot_SetDefaultAppearance:[["number","number","number","number","number","number"],"boolean"],EPDFAnnot_SetIcon:[["number","number"],"boolean"],EPDFAnnot_SetIntent:[["number","string"],"boolean"],EPDFAnnot_SetLine:[["number","number","number"],"boolean"],EPDFAnnot_SetLineEndings:[["number","number","number"],"boolean"],EPDFAnnot_SetLinkedAnnot:[["number","string","number"],"boolean"],EPDFAnnot_SetOpacity:[["number","number"],"boolean"],EPDFAnnot_SetTextAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVerticalAlignment:[["number","number"],"boolean"],EPDFAnnot_SetVertices:[["number","number","number"],"boolean"],EPDFAnnot_UpdateAppearanceToRect:[["number","number"],"boolean"],EPDFAttachment_GetDescription:[["number","number","number"],"number"],EPDFAttachment_GetIntegerValue:[["number","string","number"],"boolean"],EPDFAttachment_SetDescription:[["number","number"],"boolean"],EPDFAttachment_SetSubtype:[["number","string"],"boolean"],EPDFBookmark_AppendChild:[["number","number","number"],"number"],EPDFBookmark_Clear:[["number"],"boolean"],EPDFBookmark_ClearTarget:[["number"],"boolean"],EPDFBookmark_Create:[["number","number"],"number"],EPDFBookmark_Delete:[["number","number"],"boolean"],EPDFBookmark_InsertAfter:[["number","number","number","number"],"number"],EPDFBookmark_SetAction:[["number","number","number"],"boolean"],EPDFBookmark_SetDest:[["number","number","number"],"boolean"],EPDFBookmark_SetTitle:[["number","number"],"boolean"],EPDFCatalog_GetLanguage:[["number","number","number"],"number"],EPDFDest_CreateRemoteView:[["number","number","number","number","number"],"number"],EPDFDest_CreateRemoteXYZ:[["number","number","boolean","number","boolean","number","boolean","number"],"number"],EPDFDest_CreateView:[["number","number","number","number"],"number"],EPDFDest_CreateXYZ:[["number","boolean","number","boolean","number","boolean","number"],"number"],EPDFNamedDest_Remove:[["number","string"],"boolean"],EPDFNamedDest_SetDest:[["number","string","number"],"boolean"],EPDFPage_CreateAnnot:[["number","number"],"number"],EPDFPage_GetAnnotByName:[["number","number"],"number"],EPDFPage_GetAnnotCountRaw:[["number","number"],"number"],EPDFPage_GetAnnotRaw:[["number","number","number"],"number"],EPDFPage_RemoveAnnotByName:[["number","number"],"boolean"],EPDFPage_RemoveAnnotRaw:[["number","number","number"],"boolean"],EPDFText_RedactInQuads:[["number","number","number","boolean","boolean"],"boolean"],EPDFText_RedactInRect:[["number","number","boolean","boolean"],"boolean"],FORM_CanRedo:[["number","number"],"boolean"],FORM_CanUndo:[["number","number"],"boolean"],FORM_DoDocumentAAction:[["number","number"],null],FORM_DoDocumentJSAction:[["number"],null],FORM_DoDocumentOpenAction:[["number"],null],FORM_DoPageAAction:[["number","number","number"],null],FORM_ForceToKillFocus:[["number"],"boolean"],FORM_GetFocusedAnnot:[["number","number","number"],"boolean"],FORM_GetFocusedText:[["number","number","number","number"],"number"],FORM_GetSelectedText:[["number","number","number","number"],"number"],FORM_IsIndexSelected:[["number","number","number"],"boolean"],FORM_OnAfterLoadPage:[["number","number"],null],FORM_OnBeforeClosePage:[["number","number"],null],FORM_OnChar:[["number","number","number","number"],"boolean"],FORM_OnFocus:[["number","number","number","number","number"],"boolean"],FORM_OnKeyDown:[["number","number","number","number"],"boolean"],FORM_OnKeyUp:[["number","number","number","number"],"boolean"],FORM_OnLButtonDoubleClick:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnLButtonUp:[["number","number","number","number","number"],"boolean"],FORM_OnMouseMove:[["number","number","number","number","number"],"boolean"],FORM_OnMouseWheel:[["number","number","number","number","number","number"],"boolean"],FORM_OnRButtonDown:[["number","number","number","number","number"],"boolean"],FORM_OnRButtonUp:[["number","number","number","number","number"],"boolean"],FORM_Redo:[["number","number"],"boolean"],FORM_ReplaceAndKeepSelection:[["number","number","number"],null],FORM_ReplaceSelection:[["number","number","number"],null],FORM_SelectAllText:[["number","number"],"boolean"],FORM_SetFocusedAnnot:[["number","number"],"boolean"],FORM_SetIndexSelected:[["number","number","number","boolean"],"boolean"],FORM_Undo:[["number","number"],"boolean"],FPDF_AddInstalledFont:[["number","number","number"],null],FPDF_CloseDocument:[["number"],null],FPDF_ClosePage:[["number"],null],FPDF_CloseXObject:[["number"],null],FPDF_CopyViewerPreferences:[["number","number"],"boolean"],FPDF_CountNamedDests:[["number"],"number"],FPDF_CreateClipPath:[["number","number","number","number"],"number"],FPDF_CreateNewDocument:[[],"number"],FPDF_DestroyClipPath:[["number"],null],FPDF_DestroyLibrary:[[],null],FPDF_DeviceToPage:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_DocumentHasValidCrossReferenceTable:[["number"],"boolean"],FPDF_FFLDraw:[["number","number","number","number","number","number","number","number","number"],null],FPDF_FreeDefaultSystemFontInfo:[["number"],null],FPDF_GetDefaultSystemFontInfo:[[],"number"],FPDF_GetDefaultTTFMap:[[],"number"],FPDF_GetDefaultTTFMapCount:[[],"number"],FPDF_GetDefaultTTFMapEntry:[["number"],"number"],FPDF_GetDocPermissions:[["number"],"number"],FPDF_GetDocUserPermissions:[["number"],"number"],FPDF_GetFileIdentifier:[["number","number","number","number"],"number"],FPDF_GetFileVersion:[["number","number"],"boolean"],FPDF_GetFormType:[["number"],"number"],FPDF_GetLastError:[[],"number"],FPDF_GetMetaText:[["number","string","number","number"],"number"],FPDF_GetNamedDest:[["number","number","number","number"],"number"],FPDF_GetNamedDestByName:[["number","string"],"number"],FPDF_GetPageAAction:[["number","number"],"number"],FPDF_GetPageBoundingBox:[["number","number"],"boolean"],FPDF_GetPageCount:[["number"],"number"],FPDF_GetPageHeight:[["number"],"number"],FPDF_GetPageHeightF:[["number"],"number"],FPDF_GetPageLabel:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndex:[["number","number","number","number"],"number"],FPDF_GetPageSizeByIndexF:[["number","number","number"],"boolean"],FPDF_GetPageWidth:[["number"],"number"],FPDF_GetPageWidthF:[["number"],"number"],FPDF_GetSecurityHandlerRevision:[["number"],"number"],FPDF_GetSignatureCount:[["number"],"number"],FPDF_GetSignatureObject:[["number","number"],"number"],FPDF_GetTrailerEnds:[["number","number","number"],"number"],FPDF_GetXFAPacketContent:[["number","number","number","number","number"],"boolean"],FPDF_GetXFAPacketCount:[["number"],"number"],FPDF_GetXFAPacketName:[["number","number","number","number"],"number"],FPDF_ImportNPagesToOne:[["number","number","number","number","number"],"number"],FPDF_ImportPages:[["number","number","string","number"],"boolean"],FPDF_ImportPagesByIndex:[["number","number","number","number","number"],"boolean"],FPDF_InitLibrary:[[],null],FPDF_InitLibraryWithConfig:[["number"],null],FPDF_LoadCustomDocument:[["number","string"],"number"],FPDF_LoadDocument:[["number","string"],"number"],FPDF_LoadMemDocument:[["number","number","string"],"number"],FPDF_LoadMemDocument64:[["number","number","string"],"number"],FPDF_LoadPage:[["number","number"],"number"],FPDF_LoadXFA:[["number"],"boolean"],FPDF_MovePages:[["number","number","number","number"],"boolean"],FPDF_NewFormObjectFromXObject:[["number"],"number"],FPDF_NewXObjectFromPage:[["number","number","number"],"number"],FPDF_PageToDevice:[["number","number","number","number","number","number","number","number","number","number"],"boolean"],FPDF_RemoveFormFieldHighlight:[["number"],null],FPDF_RenderPage_Close:[["number"],null],FPDF_RenderPage_Continue:[["number","number"],"number"],FPDF_RenderPageBitmap:[["number","number","number","number","number","number","number","number"],null],FPDF_RenderPageBitmap_Start:[["number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithColorScheme_Start:[["number","number","number","number","number","number","number","number","number","number"],"number"],FPDF_RenderPageBitmapWithMatrix:[["number","number","number","number","number"],null],FPDF_SaveAsCopy:[["number","number","number"],"boolean"],FPDF_SaveWithVersion:[["number","number","number","number"],"boolean"],FPDF_SetFormFieldHighlightAlpha:[["number","number"],null],FPDF_SetFormFieldHighlightColor:[["number","number","number"],null],FPDF_SetSandBoxPolicy:[["number","boolean"],null],FPDF_SetSystemFontInfo:[["number"],null],FPDF_StructElement_Attr_CountChildren:[["number"],"number"],FPDF_StructElement_Attr_GetBlobValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetBooleanValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_Attr_GetCount:[["number"],"number"],FPDF_StructElement_Attr_GetName:[["number","number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetNumberValue:[["number","number"],"boolean"],FPDF_StructElement_Attr_GetStringValue:[["number","number","number","number"],"boolean"],FPDF_StructElement_Attr_GetType:[["number"],"number"],FPDF_StructElement_Attr_GetValue:[["number","string"],"number"],FPDF_StructElement_CountChildren:[["number"],"number"],FPDF_StructElement_GetActualText:[["number","number","number"],"number"],FPDF_StructElement_GetAltText:[["number","number","number"],"number"],FPDF_StructElement_GetAttributeAtIndex:[["number","number"],"number"],FPDF_StructElement_GetAttributeCount:[["number"],"number"],FPDF_StructElement_GetChildAtIndex:[["number","number"],"number"],FPDF_StructElement_GetChildMarkedContentID:[["number","number"],"number"],FPDF_StructElement_GetID:[["number","number","number"],"number"],FPDF_StructElement_GetLang:[["number","number","number"],"number"],FPDF_StructElement_GetMarkedContentID:[["number"],"number"],FPDF_StructElement_GetMarkedContentIdAtIndex:[["number","number"],"number"],FPDF_StructElement_GetMarkedContentIdCount:[["number"],"number"],FPDF_StructElement_GetObjType:[["number","number","number"],"number"],FPDF_StructElement_GetParent:[["number"],"number"],FPDF_StructElement_GetStringAttribute:[["number","string","number","number"],"number"],FPDF_StructElement_GetTitle:[["number","number","number"],"number"],FPDF_StructElement_GetType:[["number","number","number"],"number"],FPDF_StructTree_Close:[["number"],null],FPDF_StructTree_CountChildren:[["number"],"number"],FPDF_StructTree_GetChildAtIndex:[["number","number"],"number"],FPDF_StructTree_GetForPage:[["number"],"number"],FPDF_VIEWERREF_GetDuplex:[["number"],"number"],FPDF_VIEWERREF_GetName:[["number","string","number","number"],"number"],FPDF_VIEWERREF_GetNumCopies:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRange:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeCount:[["number"],"number"],FPDF_VIEWERREF_GetPrintPageRangeElement:[["number","number"],"number"],FPDF_VIEWERREF_GetPrintScaling:[["number"],"boolean"],FPDFAction_GetDest:[["number","number"],"number"],FPDFAction_GetFilePath:[["number","number","number"],"number"],FPDFAction_GetType:[["number"],"number"],FPDFAction_GetURIPath:[["number","number","number","number"],"number"],FPDFAnnot_AddFileAttachment:[["number","number"],"number"],FPDFAnnot_AddInkStroke:[["number","number","number"],"number"],FPDFAnnot_AppendAttachmentPoints:[["number","number"],"boolean"],FPDFAnnot_AppendObject:[["number","number"],"boolean"],FPDFAnnot_CountAttachmentPoints:[["number"],"number"],FPDFAnnot_GetAP:[["number","number","number","number"],"number"],FPDFAnnot_GetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_GetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_GetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_GetFileAttachment:[["number"],"number"],FPDFAnnot_GetFlags:[["number"],"number"],FPDFAnnot_GetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_GetFocusableSubtypesCount:[["number"],"number"],FPDFAnnot_GetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_GetFontSize:[["number","number","number"],"boolean"],FPDFAnnot_GetFormAdditionalActionJavaScript:[["number","number","number","number","number"],"number"],FPDFAnnot_GetFormControlCount:[["number","number"],"number"],FPDFAnnot_GetFormControlIndex:[["number","number"],"number"],FPDFAnnot_GetFormFieldAlternateName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldAtPoint:[["number","number","number"],"number"],FPDFAnnot_GetFormFieldExportValue:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldFlags:[["number","number"],"number"],FPDFAnnot_GetFormFieldName:[["number","number","number","number"],"number"],FPDFAnnot_GetFormFieldType:[["number","number"],"number"],FPDFAnnot_GetFormFieldValue:[["number","number","number","number"],"number"],FPDFAnnot_GetInkListCount:[["number"],"number"],FPDFAnnot_GetInkListPath:[["number","number","number","number"],"number"],FPDFAnnot_GetLine:[["number","number","number"],"boolean"],FPDFAnnot_GetLink:[["number"],"number"],FPDFAnnot_GetLinkedAnnot:[["number","string"],"number"],FPDFAnnot_GetNumberValue:[["number","string","number"],"boolean"],FPDFAnnot_GetObject:[["number","number"],"number"],FPDFAnnot_GetObjectCount:[["number"],"number"],FPDFAnnot_GetOptionCount:[["number","number"],"number"],FPDFAnnot_GetOptionLabel:[["number","number","number","number","number"],"number"],FPDFAnnot_GetRect:[["number","number"],"boolean"],FPDFAnnot_GetStringValue:[["number","string","number","number"],"number"],FPDFAnnot_GetSubtype:[["number"],"number"],FPDFAnnot_GetValueType:[["number","string"],"number"],FPDFAnnot_GetVertices:[["number","number","number"],"number"],FPDFAnnot_HasAttachmentPoints:[["number"],"boolean"],FPDFAnnot_HasKey:[["number","string"],"boolean"],FPDFAnnot_IsChecked:[["number","number"],"boolean"],FPDFAnnot_IsObjectSupportedSubtype:[["number"],"boolean"],FPDFAnnot_IsOptionSelected:[["number","number","number"],"boolean"],FPDFAnnot_IsSupportedSubtype:[["number"],"boolean"],FPDFAnnot_RemoveInkList:[["number"],"boolean"],FPDFAnnot_RemoveObject:[["number","number"],"boolean"],FPDFAnnot_SetAP:[["number","number","number"],"boolean"],FPDFAnnot_SetAttachmentPoints:[["number","number","number"],"boolean"],FPDFAnnot_SetBorder:[["number","number","number","number"],"boolean"],FPDFAnnot_SetColor:[["number","number","number","number","number","number"],"boolean"],FPDFAnnot_SetFlags:[["number","number"],"boolean"],FPDFAnnot_SetFocusableSubtypes:[["number","number","number"],"boolean"],FPDFAnnot_SetFontColor:[["number","number","number","number","number"],"boolean"],FPDFAnnot_SetFormFieldFlags:[["number","number","number"],"boolean"],FPDFAnnot_SetRect:[["number","number"],"boolean"],FPDFAnnot_SetStringValue:[["number","string","number"],"boolean"],FPDFAnnot_SetURI:[["number","number"],"boolean"],FPDFAnnot_UpdateObject:[["number","number"],"boolean"],FPDFAttachment_GetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_GetName:[["number","number","number"],"number"],FPDFAttachment_GetStringValue:[["number","string","number","number"],"number"],FPDFAttachment_GetSubtype:[["number","number","number"],"number"],FPDFAttachment_GetValueType:[["number","string"],"number"],FPDFAttachment_HasKey:[["number","string"],"boolean"],FPDFAttachment_SetFile:[["number","number","number","number"],"boolean"],FPDFAttachment_SetStringValue:[["number","string","number"],"boolean"],FPDFAvail_Create:[["number","number"],"number"],FPDFAvail_Destroy:[["number"],null],FPDFAvail_GetDocument:[["number","string"],"number"],FPDFAvail_GetFirstPageNum:[["number"],"number"],FPDFAvail_IsDocAvail:[["number","number"],"number"],FPDFAvail_IsFormAvail:[["number","number"],"number"],FPDFAvail_IsLinearized:[["number"],"number"],FPDFAvail_IsPageAvail:[["number","number","number"],"number"],FPDFBitmap_Create:[["number","number","number"],"number"],FPDFBitmap_CreateEx:[["number","number","number","number","number"],"number"],FPDFBitmap_Destroy:[["number"],null],FPDFBitmap_FillRect:[["number","number","number","number","number","number"],"boolean"],FPDFBitmap_GetBuffer:[["number"],"number"],FPDFBitmap_GetFormat:[["number"],"number"],FPDFBitmap_GetHeight:[["number"],"number"],FPDFBitmap_GetStride:[["number"],"number"],FPDFBitmap_GetWidth:[["number"],"number"],FPDFBookmark_Find:[["number","number"],"number"],FPDFBookmark_GetAction:[["number"],"number"],FPDFBookmark_GetCount:[["number"],"number"],FPDFBookmark_GetDest:[["number","number"],"number"],FPDFBookmark_GetFirstChild:[["number","number"],"number"],FPDFBookmark_GetNextSibling:[["number","number"],"number"],FPDFBookmark_GetTitle:[["number","number","number"],"number"],FPDFCatalog_IsTagged:[["number"],"boolean"],FPDFCatalog_SetLanguage:[["number","string"],"boolean"],FPDFClipPath_CountPaths:[["number"],"number"],FPDFClipPath_CountPathSegments:[["number","number"],"number"],FPDFClipPath_GetPathSegment:[["number","number","number"],"number"],FPDFDest_GetDestPageIndex:[["number","number"],"number"],FPDFDest_GetLocationInPage:[["number","number","number","number","number","number","number"],"boolean"],FPDFDest_GetView:[["number","number","number"],"number"],FPDFDoc_AddAttachment:[["number","number"],"number"],FPDFDoc_CloseJavaScriptAction:[["number"],null],FPDFDoc_DeleteAttachment:[["number","number"],"boolean"],FPDFDOC_ExitFormFillEnvironment:[["number"],null],FPDFDoc_GetAttachment:[["number","number"],"number"],FPDFDoc_GetAttachmentCount:[["number"],"number"],FPDFDoc_GetJavaScriptAction:[["number","number"],"number"],FPDFDoc_GetJavaScriptActionCount:[["number"],"number"],FPDFDoc_GetPageMode:[["number"],"number"],FPDFDOC_InitFormFillEnvironment:[["number","number"],"number"],FPDFFont_Close:[["number"],null],FPDFFont_GetAscent:[["number","number","number"],"boolean"],FPDFFont_GetBaseFontName:[["number","number","number"],"number"],FPDFFont_GetDescent:[["number","number","number"],"boolean"],FPDFFont_GetFamilyName:[["number","number","number"],"number"],FPDFFont_GetFlags:[["number"],"number"],FPDFFont_GetFontData:[["number","number","number","number"],"boolean"],FPDFFont_GetGlyphPath:[["number","number","number"],"number"],FPDFFont_GetGlyphWidth:[["number","number","number","number"],"boolean"],FPDFFont_GetIsEmbedded:[["number"],"number"],FPDFFont_GetItalicAngle:[["number","number"],"boolean"],FPDFFont_GetWeight:[["number"],"number"],FPDFFormObj_CountObjects:[["number"],"number"],FPDFFormObj_GetObject:[["number","number"],"number"],FPDFFormObj_RemoveObject:[["number","number"],"boolean"],FPDFGlyphPath_CountGlyphSegments:[["number"],"number"],FPDFGlyphPath_GetGlyphPathSegment:[["number","number"],"number"],FPDFImageObj_GetBitmap:[["number"],"number"],FPDFImageObj_GetIccProfileDataDecoded:[["number","number","number","number","number"],"boolean"],FPDFImageObj_GetImageDataDecoded:[["number","number","number"],"number"],FPDFImageObj_GetImageDataRaw:[["number","number","number"],"number"],FPDFImageObj_GetImageFilter:[["number","number","number","number"],"number"],FPDFImageObj_GetImageFilterCount:[["number"],"number"],FPDFImageObj_GetImageMetadata:[["number","number","number"],"boolean"],FPDFImageObj_GetImagePixelSize:[["number","number","number"],"boolean"],FPDFImageObj_GetRenderedBitmap:[["number","number","number"],"number"],FPDFImageObj_LoadJpegFile:[["number","number","number","number"],"boolean"],FPDFImageObj_LoadJpegFileInline:[["number","number","number","number"],"boolean"],FPDFImageObj_SetBitmap:[["number","number","number","number"],"boolean"],FPDFImageObj_SetMatrix:[["number","number","number","number","number","number","number"],"boolean"],FPDFJavaScriptAction_GetName:[["number","number","number"],"number"],FPDFJavaScriptAction_GetScript:[["number","number","number"],"number"],FPDFLink_CloseWebLinks:[["number"],null],FPDFLink_CountQuadPoints:[["number"],"number"],FPDFLink_CountRects:[["number","number"],"number"],FPDFLink_CountWebLinks:[["number"],"number"],FPDFLink_Enumerate:[["number","number","number"],"boolean"],FPDFLink_GetAction:[["number"],"number"],FPDFLink_GetAnnot:[["number","number"],"number"],FPDFLink_GetAnnotRect:[["number","number"],"boolean"],FPDFLink_GetDest:[["number","number"],"number"],FPDFLink_GetLinkAtPoint:[["number","number","number"],"number"],FPDFLink_GetLinkZOrderAtPoint:[["number","number","number"],"number"],FPDFLink_GetQuadPoints:[["number","number","number"],"boolean"],FPDFLink_GetRect:[["number","number","number","number","number","number","number"],"boolean"],FPDFLink_GetTextRange:[["number","number","number","number"],"boolean"],FPDFLink_GetURL:[["number","number","number","number"],"number"],FPDFLink_LoadWebLinks:[["number"],"number"],FPDFPage_CloseAnnot:[["number"],null],FPDFPage_CountObjects:[["number"],"number"],FPDFPage_CreateAnnot:[["number","number"],"number"],FPDFPage_Delete:[["number","number"],null],FPDFPage_Flatten:[["number","number"],"number"],FPDFPage_FormFieldZOrderAtPoint:[["number","number","number","number"],"number"],FPDFPage_GenerateContent:[["number"],"boolean"],FPDFPage_GetAnnot:[["number","number"],"number"],FPDFPage_GetAnnotCount:[["number"],"number"],FPDFPage_GetAnnotIndex:[["number","number"],"number"],FPDFPage_GetArtBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetBleedBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetCropBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetDecodedThumbnailData:[["number","number","number"],"number"],FPDFPage_GetMediaBox:[["number","number","number","number","number"],"boolean"],FPDFPage_GetObject:[["number","number"],"number"],FPDFPage_GetRawThumbnailData:[["number","number","number"],"number"],FPDFPage_GetRotation:[["number"],"number"],FPDFPage_GetThumbnailAsBitmap:[["number"],"number"],FPDFPage_GetTrimBox:[["number","number","number","number","number"],"boolean"],FPDFPage_HasFormFieldAtPoint:[["number","number","number","number"],"number"],FPDFPage_HasTransparency:[["number"],"boolean"],FPDFPage_InsertClipPath:[["number","number"],null],FPDFPage_InsertObject:[["number","number"],null],FPDFPage_InsertObjectAtIndex:[["number","number","number"],"boolean"],FPDFPage_New:[["number","number","number","number"],"number"],FPDFPage_RemoveAnnot:[["number","number"],"boolean"],FPDFPage_RemoveObject:[["number","number"],"boolean"],FPDFPage_SetArtBox:[["number","number","number","number","number"],null],FPDFPage_SetBleedBox:[["number","number","number","number","number"],null],FPDFPage_SetCropBox:[["number","number","number","number","number"],null],FPDFPage_SetMediaBox:[["number","number","number","number","number"],null],FPDFPage_SetRotation:[["number","number"],null],FPDFPage_SetTrimBox:[["number","number","number","number","number"],null],FPDFPage_TransformAnnots:[["number","number","number","number","number","number","number"],null],FPDFPage_TransFormWithClip:[["number","number","number"],"boolean"],FPDFPageObj_AddMark:[["number","string"],"number"],FPDFPageObj_CountMarks:[["number"],"number"],FPDFPageObj_CreateNewPath:[["number","number"],"number"],FPDFPageObj_CreateNewRect:[["number","number","number","number"],"number"],FPDFPageObj_CreateTextObj:[["number","number","number"],"number"],FPDFPageObj_Destroy:[["number"],null],FPDFPageObj_GetBounds:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetClipPath:[["number"],"number"],FPDFPageObj_GetDashArray:[["number","number","number"],"boolean"],FPDFPageObj_GetDashCount:[["number"],"number"],FPDFPageObj_GetDashPhase:[["number","number"],"boolean"],FPDFPageObj_GetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetIsActive:[["number","number"],"boolean"],FPDFPageObj_GetLineCap:[["number"],"number"],FPDFPageObj_GetLineJoin:[["number"],"number"],FPDFPageObj_GetMark:[["number","number"],"number"],FPDFPageObj_GetMarkedContentID:[["number"],"number"],FPDFPageObj_GetMatrix:[["number","number"],"boolean"],FPDFPageObj_GetRotatedBounds:[["number","number"],"boolean"],FPDFPageObj_GetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_GetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_GetType:[["number"],"number"],FPDFPageObj_HasTransparency:[["number"],"boolean"],FPDFPageObj_NewImageObj:[["number"],"number"],FPDFPageObj_NewTextObj:[["number","string","number"],"number"],FPDFPageObj_RemoveMark:[["number","number"],"boolean"],FPDFPageObj_SetBlendMode:[["number","string"],null],FPDFPageObj_SetDashArray:[["number","number","number","number"],"boolean"],FPDFPageObj_SetDashPhase:[["number","number"],"boolean"],FPDFPageObj_SetFillColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetIsActive:[["number","boolean"],"boolean"],FPDFPageObj_SetLineCap:[["number","number"],"boolean"],FPDFPageObj_SetLineJoin:[["number","number"],"boolean"],FPDFPageObj_SetMatrix:[["number","number"],"boolean"],FPDFPageObj_SetStrokeColor:[["number","number","number","number","number"],"boolean"],FPDFPageObj_SetStrokeWidth:[["number","number"],"boolean"],FPDFPageObj_Transform:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformClipPath:[["number","number","number","number","number","number","number"],null],FPDFPageObj_TransformF:[["number","number"],"boolean"],FPDFPageObjMark_CountParams:[["number"],"number"],FPDFPageObjMark_GetName:[["number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamBlobValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamIntValue:[["number","string","number"],"boolean"],FPDFPageObjMark_GetParamKey:[["number","number","number","number","number"],"boolean"],FPDFPageObjMark_GetParamStringValue:[["number","string","number","number","number"],"boolean"],FPDFPageObjMark_GetParamValueType:[["number","string"],"number"],FPDFPageObjMark_RemoveParam:[["number","number","string"],"boolean"],FPDFPageObjMark_SetBlobParam:[["number","number","number","string","number","number"],"boolean"],FPDFPageObjMark_SetIntParam:[["number","number","number","string","number"],"boolean"],FPDFPageObjMark_SetStringParam:[["number","number","number","string","string"],"boolean"],FPDFPath_BezierTo:[["number","number","number","number","number","number","number"],"boolean"],FPDFPath_Close:[["number"],"boolean"],FPDFPath_CountSegments:[["number"],"number"],FPDFPath_GetDrawMode:[["number","number","number"],"boolean"],FPDFPath_GetPathSegment:[["number","number"],"number"],FPDFPath_LineTo:[["number","number","number"],"boolean"],FPDFPath_MoveTo:[["number","number","number"],"boolean"],FPDFPath_SetDrawMode:[["number","number","boolean"],"boolean"],FPDFPathSegment_GetClose:[["number"],"boolean"],FPDFPathSegment_GetPoint:[["number","number","number"],"boolean"],FPDFPathSegment_GetType:[["number"],"number"],FPDFSignatureObj_GetByteRange:[["number","number","number"],"number"],FPDFSignatureObj_GetContents:[["number","number","number"],"number"],FPDFSignatureObj_GetDocMDPPermission:[["number"],"number"],FPDFSignatureObj_GetReason:[["number","number","number"],"number"],FPDFSignatureObj_GetSubFilter:[["number","number","number"],"number"],FPDFSignatureObj_GetTime:[["number","number","number"],"number"],FPDFText_ClosePage:[["number"],null],FPDFText_CountChars:[["number"],"number"],FPDFText_CountRects:[["number","number","number"],"number"],FPDFText_FindClose:[["number"],null],FPDFText_FindNext:[["number"],"boolean"],FPDFText_FindPrev:[["number"],"boolean"],FPDFText_FindStart:[["number","number","number","number"],"number"],FPDFText_GetBoundedText:[["number","number","number","number","number","number","number"],"number"],FPDFText_GetCharAngle:[["number","number"],"number"],FPDFText_GetCharBox:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetCharIndexAtPos:[["number","number","number","number","number"],"number"],FPDFText_GetCharIndexFromTextIndex:[["number","number"],"number"],FPDFText_GetCharOrigin:[["number","number","number","number"],"boolean"],FPDFText_GetFillColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetFontInfo:[["number","number","number","number","number"],"number"],FPDFText_GetFontSize:[["number","number"],"number"],FPDFText_GetFontWeight:[["number","number"],"number"],FPDFText_GetLooseCharBox:[["number","number","number"],"boolean"],FPDFText_GetMatrix:[["number","number","number"],"boolean"],FPDFText_GetRect:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetSchCount:[["number"],"number"],FPDFText_GetSchResultIndex:[["number"],"number"],FPDFText_GetStrokeColor:[["number","number","number","number","number","number"],"boolean"],FPDFText_GetText:[["number","number","number","number"],"number"],FPDFText_GetTextIndexFromCharIndex:[["number","number"],"number"],FPDFText_GetTextObject:[["number","number"],"number"],FPDFText_GetUnicode:[["number","number"],"number"],FPDFText_HasUnicodeMapError:[["number","number"],"number"],FPDFText_IsGenerated:[["number","number"],"number"],FPDFText_IsHyphen:[["number","number"],"number"],FPDFText_LoadCidType2Font:[["number","number","number","string","number","number"],"number"],FPDFText_LoadFont:[["number","number","number","number","boolean"],"number"],FPDFText_LoadPage:[["number"],"number"],FPDFText_LoadStandardFont:[["number","string"],"number"],FPDFText_SetCharcodes:[["number","number","number"],"boolean"],FPDFText_SetText:[["number","number"],"boolean"],FPDFTextObj_GetFont:[["number"],"number"],FPDFTextObj_GetFontSize:[["number","number"],"boolean"],FPDFTextObj_GetRenderedBitmap:[["number","number","number","number"],"number"],FPDFTextObj_GetText:[["number","number","number","number"],"number"],FPDFTextObj_GetTextRenderMode:[["number"],"number"],FPDFTextObj_SetTextRenderMode:[["number","number"],"boolean"],PDFiumExt_CloseFileWriter:[["number"],null],PDFiumExt_CloseFormFillInfo:[["number"],null],PDFiumExt_ExitFormFillEnvironment:[["number"],null],PDFiumExt_GetFileWriterData:[["number","number","number"],"number"],PDFiumExt_GetFileWriterSize:[["number"],"number"],PDFiumExt_Init:[[],null],PDFiumExt_InitFormFillEnvironment:[["number","number"],"number"],PDFiumExt_OpenFileWriter:[[],"number"],PDFiumExt_OpenFormFillInfo:[[],"number"],PDFiumExt_SaveAsCopy:[["number","number"],"number"]};async function oo(W){const r={pdfium:W};for(const n in ht){const e=n,i=ht[e][0],u=ht[e][1];r[e]=W.cwrap(n,u,i)}return r}async function io(W){const r=await ro(W);return oo(r)}function se(W,r,n,e=100){let i=W.wasmExports.malloc(e);for(let d=0;d<e;d++)W.HEAP8[i+d]=0;const u=r(i,e);let F;if(u>e){W.wasmExports.free(i),i=W.wasmExports.malloc(u);for(let d=0;d<u;d++)W.HEAP8[i+d]=0;r(i,u),F=n(i)}else F=n(i);return W.wasmExports.free(i),F}function ft(W,r){const n=r(0,0),e=W.wasmExports.malloc(n);r(e,n);const i=new ArrayBuffer(n),u=new DataView(i);for(let F=0;F<n;F++)u.setInt8(F,W.getValue(e+F,"i8"));return W.wasmExports.free(e),i}const ao=new Set(["Title","Author","Subject","Keywords","Producer","Creator","CreationDate","ModDate","Trapped"]);function so(W){if(!W||W.length>127||ao.has(W)||W[0]==="/")return!1;for(let r=0;r<W.length;r++){const n=W.charCodeAt(r);if(n<32||n>126)return!1}return!0}function uo(W,r,n,e){const i=r.origin.x,u=r.origin.y,F=i+r.size.width,d=u+r.size.height,_=n.width,P=n.height,h=Math.hypot(W.a,W.b),b=Math.hypot(W.c,W.d),A=(e&1)===1,M=A?Math.max(1,Math.round(P*h)):Math.max(1,Math.round(_*h)),y=A?Math.max(1,Math.round(_*b)):Math.max(1,Math.round(P*b));let S,x;switch(e){case ze.Degree0:S=-Math.round(i*h),x=-Math.round(u*b);break;case ze.Degree90:S=Math.round((d-P)*h),x=-Math.round(i*b);break;case ze.Degree180:S=Math.round((F-_)*h),x=Math.round((d-P)*b);break;case ze.Degree270:S=-Math.round(u*h),x=Math.round((F-_)*b);break;default:S=-Math.round(i*h),x=-Math.round(u*b);break}return{startX:S,startY:x,formsWidth:M,formsHeight:y,scaleX:h,scaleY:b}}const mo={pageTtl:5e3,maxPagesPerDocument:10};class Fo{constructor(r,n={}){this.pdfium=r,this.docs=new Map,this.config={...mo,...n}}setDocument(r,n,e){let i=this.docs.get(r);i||(i=new lo(n,e,this.pdfium,this.config),this.docs.set(r,i))}getContext(r){return this.docs.get(r)}closeDocument(r){const n=this.docs.get(r);return n?(n.dispose(),this.docs.delete(r),!0):!1}closeAllDocuments(){for(const r of this.docs.values())r.dispose();this.docs.clear()}updateConfig(r){Object.assign(this.config,r);for(const n of this.docs.values())n.updateConfig(this.config)}getCacheStats(){const r={};let n=0;for(const[e,i]of this.docs.entries()){const u=i.getCacheSize();r[e]=u,n+=u}return{documents:this.docs.size,totalPages:n,pagesByDocument:r}}}class lo{constructor(r,n,e,i){this.filePtr=r,this.docPtr=n,this.pageCache=new co(e,n,i)}acquirePage(r){return this.pageCache.acquire(r)}borrowPage(r,n){return this.pageCache.borrowPage(r,n)}updateConfig(r){this.pageCache.updateConfig(r)}getCacheSize(){return this.pageCache.size()}dispose(){this.pageCache.forceReleaseAll(),this.pageCache.pdf.FPDF_CloseDocument(this.docPtr),this.pageCache.pdf.pdfium.wasmExports.free(this.filePtr)}}class co{constructor(r,n,e){this.pdf=r,this.docPtr=n,this.cache=new Map,this.accessOrder=[],this.config=e}acquire(r){let n=this.cache.get(r);if(!n){this.evictIfNeeded();const e=this.pdf.FPDF_LoadPage(this.docPtr,r);n=new _o(this.pdf,this.docPtr,r,e,this.config.pageTtl,()=>{this.cache.delete(r),this.removeFromAccessOrder(r)}),this.cache.set(r,n)}return this.updateAccessOrder(r),n.clearExpiryTimer(),n.bumpRefCount(),n}borrowPage(r,n){const e=this.cache.has(r),i=this.acquire(r);try{return n(i)}finally{e?i.release():i.disposeImmediate()}}forceReleaseAll(){for(const r of this.cache.values())r.disposeImmediate();this.cache.clear(),this.accessOrder.length=0}updateConfig(r){this.config=r;for(const n of this.cache.values())n.updateTtl(r.pageTtl);this.evictIfNeeded()}size(){return this.cache.size}evictIfNeeded(){for(;this.cache.size>=this.config.maxPagesPerDocument;){const r=this.accessOrder[0];if(r!==void 0){const n=this.cache.get(r);if(n)if(n.getRefCount()===0)n.disposeImmediate();else break;else this.removeFromAccessOrder(r)}else break}}updateAccessOrder(r){this.removeFromAccessOrder(r),this.accessOrder.push(r)}removeFromAccessOrder(r){const n=this.accessOrder.indexOf(r);n>-1&&this.accessOrder.splice(n,1)}}class _o{constructor(r,n,e,i,u,F){this.pdf=r,this.docPtr=n,this.pageIdx=e,this.pagePtr=i,this.onFinalDispose=F,this.refCount=0,this.disposed=!1,this.ttl=u}bumpRefCount(){if(this.disposed)throw new Error("Context already disposed");this.refCount++}getRefCount(){return this.refCount}clearExpiryTimer(){this.expiryTimer&&(clearTimeout(this.expiryTimer),this.expiryTimer=void 0)}updateTtl(r){this.ttl=r,this.expiryTimer&&this.refCount===0&&(this.clearExpiryTimer(),this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl))}release(){this.disposed||(this.refCount--,this.refCount===0&&(this.expiryTimer=setTimeout(()=>this.disposeImmediate(),this.ttl)))}disposeImmediate(){this.disposed||(this.disposed=!0,this.clearExpiryTimer(),this.textPagePtr!==void 0&&this.pdf.FPDFText_ClosePage(this.textPagePtr),this.formHandle!==void 0&&(this.pdf.FORM_OnBeforeClosePage(this.pagePtr,this.formHandle),this.pdf.PDFiumExt_ExitFormFillEnvironment(this.formHandle)),this.formInfoPtr!==void 0&&this.pdf.PDFiumExt_CloseFormFillInfo(this.formInfoPtr),this.pdf.FPDF_ClosePage(this.pagePtr),this.onFinalDispose())}getTextPage(){return this.ensureAlive(),this.textPagePtr===void 0&&(this.textPagePtr=this.pdf.FPDFText_LoadPage(this.pagePtr)),this.textPagePtr}getFormHandle(){return this.ensureAlive(),this.formHandle===void 0&&(this.formInfoPtr=this.pdf.PDFiumExt_OpenFormFillInfo(),this.formHandle=this.pdf.PDFiumExt_InitFormFillEnvironment(this.docPtr,this.formInfoPtr),this.pdf.FORM_OnAfterLoadPage(this.pagePtr,this.formHandle)),this.formHandle}withAnnotation(r,n){this.ensureAlive();const e=this.pdf.FPDFPage_GetAnnot(this.pagePtr,r);try{return n(e)}finally{this.pdf.FPDFPage_CloseAnnot(e)}}ensureAlive(){if(this.disposed)throw new Error("PageContext already disposed")}}const at=W=>W,Po={MAX_TOTAL_MEMORY:2*1024*1024*1024},an={MEMORY:Po},Dt="PDFiumEngine",bt="MemoryManager";class go{constructor(r,n){this.pdfiumModule=r,this.logger=n,this.allocations=new Map,this.totalAllocated=0}malloc(r){if(this.totalAllocated+r>an.MEMORY.MAX_TOTAL_MEMORY)throw new Error(`Total memory usage would exceed limit: ${this.totalAllocated+r} > ${an.MEMORY.MAX_TOTAL_MEMORY}`);const n=this.pdfiumModule.pdfium.wasmExports.malloc(r);if(!n)throw new Error(`Failed to allocate ${r} bytes`);const e={ptr:at(n),size:r,timestamp:Date.now(),stack:this.logger.isEnabled("debug")?new Error().stack:void 0};return this.allocations.set(n,e),this.totalAllocated+=r,at(n)}free(r){const n=this.allocations.get(r);n?(this.totalAllocated-=n.size,this.allocations.delete(r)):this.logger.warn(Dt,bt,`Freeing untracked pointer: ${r}`),this.pdfiumModule.pdfium.wasmExports.free(r)}getStats(){return{totalAllocated:this.totalAllocated,allocationCount:this.allocations.size,allocations:this.logger.isEnabled("debug")?Array.from(this.allocations.values()):[]}}checkLeaks(){if(this.allocations.size>0){this.logger.warn(Dt,bt,`Potential memory leak: ${this.allocations.size} unfreed allocations`);for(const[r,n]of this.allocations)this.logger.warn(Dt,bt,`  - ${r}: ${n.size} bytes`,n.stack)}}}const f="PDFiumEngine",D="Engine";class pt extends Error{constructor(r){super(r),this.name="OffscreenCanvasError"}}const ho=(W,r="image/webp",n)=>{if(typeof OffscreenCanvas>"u")return Promise.reject(new pt("OffscreenCanvas is not available in this environment. This converter is intended for browser use only. Falling back to WASM-based image encoding."));const e=W(),i=new ImageData(e.data,e.width,e.height),u=new OffscreenCanvas(i.width,i.height);return u.getContext("2d").putImageData(i,0,0),u.convertToBlob({type:r,quality:n})};class fo{constructor(r,n={}){this.pdfiumModule=r,this.memoryLeakCheckInterval=null;const{logger:e=new zr,imageDataConverter:i=ho}=n;this.cache=new Fo(this.pdfiumModule),this.logger=e,this.imageDataConverter=i,this.memoryManager=new go(this.pdfiumModule,this.logger),this.logger.isEnabled("debug")&&(this.memoryLeakCheckInterval=setInterval(()=>{this.memoryManager.checkLeaks()},1e4))}initialize(){return this.logger.debug(f,D,"initialize"),this.logger.perf(f,D,"Initialize","Begin","General"),this.pdfiumModule.PDFiumExt_Init(),this.logger.perf(f,D,"Initialize","End","General"),G.resolve(!0)}destroy(){return this.logger.debug(f,D,"destroy"),this.logger.perf(f,D,"Destroy","Begin","General"),this.pdfiumModule.FPDF_DestroyLibrary(),this.memoryLeakCheckInterval&&(clearInterval(this.memoryLeakCheckInterval),this.memoryLeakCheckInterval=null),this.logger.perf(f,D,"Destroy","End","General"),G.resolve(!0)}withWString(r,n){const e=(r.length+1)*2,i=this.memoryManager.malloc(e);try{return this.pdfiumModule.pdfium.stringToUTF16(r,i,e),n(i)}finally{this.memoryManager.free(i)}}withFloatArray(r,n){const e=r??[],i=e.length*4,u=i?this.memoryManager.malloc(i):at(0);try{if(i)for(let F=0;F<e.length;F++)this.pdfiumModule.pdfium.setValue(u+F*4,e[F],"float");return n(u,e.length)}finally{i&&this.memoryManager.free(u)}}openDocumentUrl(r,n){const e=(n==null?void 0:n.mode)??"auto",i=(n==null?void 0:n.password)??"";this.logger.debug(f,D,"openDocumentUrl called",r.url,e);const u=G.create();return(async()=>{try{(await this.fetchFullAndOpen(r,i)).wait(d=>u.resolve(d),d=>u.reject(d.reason))}catch(F){this.logger.error(f,D,"openDocumentUrl error",F),u.reject({code:O.Unknown,message:String(F)})}})(),u}async checkRangeSupport(r){try{this.logger.debug(f,D,"checkRangeSupport",r);const n=await fetch(r,{method:"HEAD"}),e=n.headers.get("Content-Length");if(n.headers.get("Accept-Ranges")==="bytes")return{supportsRanges:!0,fileLength:parseInt(e??"0"),content:null};const u=await fetch(r,{headers:{Range:"bytes=0-1"}});if(u.status===200){const F=await u.arrayBuffer();return{supportsRanges:!1,fileLength:parseInt(e??"0"),content:F}}return{supportsRanges:u.status===206,fileLength:parseInt(e??"0"),content:null}}catch(n){throw this.logger.error(f,D,"checkRangeSupport failed",n),new Error("Failed to check range support: "+n)}}async fetchFullAndOpen(r,n){this.logger.debug(f,D,"fetchFullAndOpen",r.url);const e=await fetch(r.url);if(!e.ok)throw new Error(`Could not fetch PDF: ${e.statusText}`);const i=await e.arrayBuffer(),u={id:r.id,name:r.name,content:i};return this.openDocumentBuffer(u,{password:n})}async openDocumentWithRangeRequest(r,n,e){this.logger.debug(f,D,"openDocumentWithRangeRequest",r.url);const i=e??(await this.retrieveFileLength(r.url)).fileLength,u=(F,d)=>{const _=new XMLHttpRequest;if(_.open("GET",r.url,!1),_.overrideMimeType("text/plain; charset=x-user-defined"),_.setRequestHeader("Range",`bytes=${F}-${F+d-1}`),_.send(null),_.status===206||_.status===200)return this.convertResponseToUint8Array(_.responseText);throw new Error(`Range request failed with status ${_.status}`)};return this.openDocumentFromLoader({id:r.id,fileLength:i,callback:u},n)}async retrieveFileLength(r){this.logger.debug(f,D,"retrieveFileLength",r);const n=await fetch(r,{method:"HEAD"});if(!n.ok)throw new Error(`Failed HEAD request for file length: ${n.statusText}`);const e=n.headers.get("Content-Length")||"0",i=parseInt(e,10)||0;if(!i)throw new Error("Content-Length not found or zero.");return{fileLength:i}}convertResponseToUint8Array(r){const n=new Uint8Array(r.length);for(let e=0;e<r.length;e++)n[e]=r.charCodeAt(e)&255;return n}openDocumentBuffer(r,n){this.logger.debug(f,D,"openDocumentBuffer",r,n),this.logger.perf(f,D,"OpenDocumentBuffer","Begin",r.id);const e=new Uint8Array(r.content),i=e.length,u=this.memoryManager.malloc(i);this.pdfiumModule.pdfium.HEAPU8.set(e,u);const F=this.pdfiumModule.FPDF_LoadMemDocument(u,i,(n==null?void 0:n.password)??"");if(!F){const b=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(f,D,`FPDF_LoadMemDocument failed with ${b}`),this.memoryManager.free(u),this.logger.perf(f,D,"OpenDocumentBuffer","End",r.id),G.reject({code:b,message:"FPDF_LoadMemDocument failed"})}const d=this.pdfiumModule.FPDF_GetPageCount(F),_=[],P=this.memoryManager.malloc(8);for(let b=0;b<d;b++){if(!this.pdfiumModule.FPDF_GetPageSizeByIndexF(F,b,P)){const S=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(f,D,`FPDF_GetPageSizeByIndexF failed with ${S}`),this.memoryManager.free(P),this.pdfiumModule.FPDF_CloseDocument(F),this.memoryManager.free(u),this.logger.perf(f,D,"OpenDocumentBuffer","End",r.id),G.reject({code:S,message:"FPDF_GetPageSizeByIndexF failed"})}const M=this.pdfiumModule.EPDF_GetPageRotationByIndex(F,b),y={index:b,size:{width:this.pdfiumModule.pdfium.getValue(P,"float"),height:this.pdfiumModule.pdfium.getValue(P+4,"float")},rotation:M};_.push(y)}this.memoryManager.free(P);const h={id:r.id,name:r.name,pageCount:d,pages:_};return this.cache.setDocument(r.id,u,F),this.logger.perf(f,D,"OpenDocumentBuffer","End",r.id),G.resolve(h)}openDocumentFromLoader(r,n=""){const{fileLength:e,callback:i,...u}=r;this.logger.debug(f,D,"openDocumentFromLoader",u,n),this.logger.perf(f,D,"OpenDocumentFromLoader","Begin",u.id);const F=(S,x,v,I)=>{try{if(this.logger.debug(f,D,"readBlock",x,I,v),x<0||x>=e)return this.logger.error(f,D,"Offset out of bounds:",x),0;const B=i(x,I);return new Uint8Array(this.pdfiumModule.pdfium.HEAPU8.buffer,v,B.length).set(B),B.length}catch(B){return this.logger.error(f,D,"ReadBlock error:",B),0}},d=this.pdfiumModule.pdfium.addFunction(F,"iiiii"),P=this.memoryManager.malloc(12);this.pdfiumModule.pdfium.setValue(P,e,"i32"),this.pdfiumModule.pdfium.setValue(P+4,d,"i32"),this.pdfiumModule.pdfium.setValue(P+8,0,"i32");const h=this.pdfiumModule.FPDF_LoadCustomDocument(P,n);if(!h){const S=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(f,D,`FPDF_LoadCustomDocument failed with ${S}`),this.memoryManager.free(P),this.logger.perf(f,D,"OpenDocumentFromLoader","End",u.id),G.reject({code:S,message:"FPDF_LoadCustomDocument failed"})}const b=this.pdfiumModule.FPDF_GetPageCount(h),A=[],M=this.memoryManager.malloc(8);for(let S=0;S<b;S++){if(!this.pdfiumModule.FPDF_GetPageSizeByIndexF(h,S,M)){const B=this.pdfiumModule.FPDF_GetLastError();return this.logger.error(f,D,`FPDF_GetPageSizeByIndexF failed with ${B}`),this.memoryManager.free(M),this.pdfiumModule.FPDF_CloseDocument(h),this.memoryManager.free(P),this.logger.perf(f,D,"OpenDocumentFromLoader","End",u.id),G.reject({code:B,message:"FPDF_GetPageSizeByIndexF failed"})}const v=this.pdfiumModule.EPDF_GetPageRotationByIndex(h,S),I={index:S,size:{width:this.pdfiumModule.pdfium.getValue(M,"float"),height:this.pdfiumModule.pdfium.getValue(M+4,"float")},rotation:v};A.push(I)}this.memoryManager.free(M);const y={id:u.id,name:u.name,pageCount:b,pages:A};return this.cache.setDocument(u.id,P,h),this.logger.perf(f,D,"OpenDocumentFromLoader","End",u.id),G.resolve(y)}getMetadata(r){this.logger.debug(f,D,"getMetadata",r),this.logger.perf(f,D,"GetMetadata","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"GetMetadata","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=this.readMetaText(n.docPtr,"CreationDate"),i=this.readMetaText(n.docPtr,"ModDate"),u={title:this.readMetaText(n.docPtr,"Title"),author:this.readMetaText(n.docPtr,"Author"),subject:this.readMetaText(n.docPtr,"Subject"),keywords:this.readMetaText(n.docPtr,"Keywords"),producer:this.readMetaText(n.docPtr,"Producer"),creator:this.readMetaText(n.docPtr,"Creator"),creationDate:e?ot(e)??null:null,modificationDate:i?ot(i)??null:null,trapped:this.getMetaTrapped(n.docPtr),custom:this.readAllMeta(n.docPtr,!0)};return this.logger.perf(f,D,"GetMetadata","End",r.id),G.resolve(u)}setMetadata(r,n){this.logger.debug(f,D,"setMetadata",r,n),this.logger.perf(f,D,"SetMetadata","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"SetMetadata","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=[["title","Title"],["author","Author"],["subject","Subject"],["keywords","Keywords"],["producer","Producer"],["creator","Creator"]];let u=!0;for(const[d,_]of i){const P=n[d];if(P===void 0)continue;const h=P===null?null:P;this.setMetaText(e.docPtr,_,h)||(u=!1)}const F=(d,_)=>{const P=n[d];if(P===void 0)return;if(P===null){this.setMetaText(e.docPtr,_,null)||(u=!1);return}const b=gt(P);this.setMetaText(e.docPtr,_,b)||(u=!1)};if(F("creationDate","CreationDate"),F("modificationDate","ModDate"),n.trapped!==void 0&&(this.setMetaTrapped(e.docPtr,n.trapped??null)||(u=!1)),n.custom!==void 0)for(const[d,_]of Object.entries(n.custom)){if(!so(d)){this.logger.warn(f,D,"Invalid custom metadata key skipped",d);continue}this.setMetaText(e.docPtr,d,_??null)||(u=!1)}return this.logger.perf(f,D,"SetMetadata","End",r.id),u?G.resolve(!0):G.reject({code:O.Unknown,message:"one or more metadata fields could not be written"})}getDocPermissions(r){this.logger.debug(f,D,"getDocPermissions",r),this.logger.perf(f,D,"getDocPermissions","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"getDocPermissions","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.FPDF_GetDocPermissions(n.docPtr);return G.resolve(e)}getDocUserPermissions(r){this.logger.debug(f,D,"getDocUserPermissions",r),this.logger.perf(f,D,"getDocUserPermissions","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"getDocUserPermissions","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.FPDF_GetDocUserPermissions(n.docPtr);return G.resolve(e)}getSignatures(r){this.logger.debug(f,D,"getSignatures",r),this.logger.perf(f,D,"GetSignatures","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"GetSignatures","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=[],i=this.pdfiumModule.FPDF_GetSignatureCount(n.docPtr);for(let u=0;u<i;u++){const F=this.pdfiumModule.FPDF_GetSignatureObject(n.docPtr,u),d=ft(this.pdfiumModule.pdfium,(M,y)=>this.pdfiumModule.FPDFSignatureObj_GetContents(F,M,y)),_=ft(this.pdfiumModule.pdfium,(M,y)=>this.pdfiumModule.FPDFSignatureObj_GetByteRange(F,M,y)*4),P=ft(this.pdfiumModule.pdfium,(M,y)=>this.pdfiumModule.FPDFSignatureObj_GetSubFilter(F,M,y)),h=se(this.pdfiumModule.pdfium,(M,y)=>this.pdfiumModule.FPDFSignatureObj_GetReason(F,M,y),this.pdfiumModule.pdfium.UTF16ToString),b=se(this.pdfiumModule.pdfium,(M,y)=>this.pdfiumModule.FPDFSignatureObj_GetTime(F,M,y),this.pdfiumModule.pdfium.UTF8ToString),A=this.pdfiumModule.FPDFSignatureObj_GetDocMDPPermission(F);e.push({contents:d,byteRange:_,subFilter:P,reason:h,time:b,docMDP:A})}return this.logger.perf(f,D,"GetSignatures","End",r.id),G.resolve(e)}getBookmarks(r){this.logger.debug(f,D,"getBookmarks",r),this.logger.perf(f,D,"GetBookmarks","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"getBookmarks","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=this.readPdfBookmarks(n.docPtr,0);return this.logger.perf(f,D,"GetBookmarks","End",r.id),G.resolve({bookmarks:e})}setBookmarks(r,n){this.logger.debug(f,D,"setBookmarks",r,n),this.logger.perf(f,D,"SetBookmarks","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"SetBookmarks","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});if(!this.pdfiumModule.EPDFBookmark_Clear(e.docPtr))return this.logger.perf(f,D,"SetBookmarks","End",r.id),G.reject({code:O.Unknown,message:"failed to clear existing bookmarks"});const i=(F,d)=>{var _;for(const P of d){const h=this.withWString(P.title??"",b=>this.pdfiumModule.EPDFBookmark_AppendChild(e.docPtr,F,b));if(!h||P.target&&!this.applyBookmarkTarget(e.docPtr,h,P.target)||(_=P.children)!=null&&_.length&&!i(h,P.children))return!1}return!0},u=i(0,n);return this.logger.perf(f,D,"SetBookmarks","End",r.id),u?G.resolve(!0):G.reject({code:O.Unknown,message:"failed to build bookmark tree"})}deleteBookmarks(r){this.logger.debug(f,D,"deleteBookmarks",r),this.logger.perf(f,D,"DeleteBookmarks","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"DeleteBookmarks","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=this.pdfiumModule.EPDFBookmark_Clear(n.docPtr);return this.logger.perf(f,D,"DeleteBookmarks","End",r.id),e?G.resolve(!0):G.reject({code:O.Unknown,message:"failed to clear bookmarks"})}renderPage(r,n,e){this.logger.debug(f,D,"renderPage",r,n,e),this.logger.perf(f,D,"RenderPage","Begin",`${r.id}-${n.index}`);const i={origin:{x:0,y:0},size:n.size},u=this.renderRectEncoded(r,n,i,e);return this.logger.perf(f,D,"RenderPage","End",`${r.id}-${n.index}`),u}renderPageRect(r,n,e,i){this.logger.debug(f,D,"renderPageRect",r,n,e,i),this.logger.perf(f,D,"RenderPageRect","Begin",`${r.id}-${n.index}`);const u=this.renderRectEncoded(r,n,e,i);return this.logger.perf(f,D,"RenderPageRect","End",`${r.id}-${n.index}`),u}getAllAnnotations(r){this.logger.debug(f,D,"getAllAnnotations-with-progress",r),this.logger.perf(f,D,"GetAllAnnotations","Begin",r.id);const n=G.create();let e=!1;n.wait(Hr,_=>{_.type==="abort"&&(e=!0)});const i=this.cache.getContext(r.id);if(!i)return this.logger.perf(f,D,"GetAllAnnotations","End",r.id),n.reject({code:O.DocNotOpen,message:"document does not open"}),n;const u=100,F={},d=_=>{if(e)return;const P=Math.min(_+u,r.pageCount);for(let h=_;h<P&&!e;++h){this.logger.debug(f,D,"GetAllAnnotations","Begin",r.id,h);const b=this.readPageAnnotationsRaw(i,r.pages[h]);F[h]=b,this.logger.debug(f,D,"GetAllAnnotations","End",r.id,h),n.progress({page:h,annotations:b})}if(!e){if(P>=r.pageCount){this.logger.perf(f,D,"GetAllAnnotations","End",r.id),n.resolve(F);return}setTimeout(()=>d(P),0)}};return d(0),n}readAllAnnotations(r,n){const e={};for(let i=0;i<r.pageCount;i++){const u=this.readPageAnnotations(n,r.pages[i]);e[i]=u}return e}getPageAnnotations(r,n){this.logger.debug(f,D,"getPageAnnotations",r,n),this.logger.perf(f,D,"GetPageAnnotations","Begin",`${r.id}-${n.index}`);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"GetPageAnnotations","End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=this.readPageAnnotations(e,n);return this.logger.perf(f,D,"GetPageAnnotations","End",`${r.id}-${n.index}`),this.logger.debug(f,D,"GetPageAnnotations",`${r.id}-${n.index}`,i),G.resolve(i)}createPageAnnotation(r,n,e,i){this.logger.debug(f,D,"createPageAnnotation",r,n,e),this.logger.perf(f,D,"CreatePageAnnotation","Begin",`${r.id}-${n.index}`);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(f,D,"CreatePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const F=u.acquirePage(n.index),d=this.pdfiumModule.EPDFPage_CreateAnnot(F.pagePtr,e.type);if(!d)return this.logger.perf(f,D,"CreatePageAnnotation","End",`${r.id}-${n.index}`),F.release(),G.reject({code:O.CantCreateAnnot,message:"can not create annotation with specified type"});if(Jt(e.id)||(e.id=qt()),!this.setAnnotString(d,"NM",e.id))return this.pdfiumModule.FPDFPage_CloseAnnot(d),F.release(),G.reject({code:O.CantSetAnnotString,message:"can not set the name of the annotation"});if(!this.setPageAnnoRect(n,d,e.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(d),F.release(),this.logger.perf(f,D,"CreatePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.CantSetAnnotRect,message:"can not set the rect of the annotation"});let _=!1;switch(e.type){case R.INK:_=this.addInkStroke(n,F.pagePtr,d,e);break;case R.STAMP:_=this.addStampContent(u.docPtr,n,F.pagePtr,d,e,i==null?void 0:i.imageData);break;case R.TEXT:_=this.addTextContent(n,F.pagePtr,d,e);break;case R.FREETEXT:_=this.addFreeTextContent(n,F.pagePtr,d,e);break;case R.LINE:_=this.addLineContent(n,F.pagePtr,d,e);break;case R.POLYLINE:case R.POLYGON:_=this.addPolyContent(n,F.pagePtr,d,e);break;case R.CIRCLE:case R.SQUARE:_=this.addShapeContent(n,F.pagePtr,d,e);break;case R.UNDERLINE:case R.STRIKEOUT:case R.SQUIGGLY:case R.HIGHLIGHT:_=this.addTextMarkupContent(n,F.pagePtr,d,e);break}return _?(e.blendMode!==void 0?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(d,e.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(d),this.pdfiumModule.FPDFPage_GenerateContent(F.pagePtr),this.pdfiumModule.FPDFPage_CloseAnnot(d),F.release(),this.logger.perf(f,D,"CreatePageAnnotation","End",`${r.id}-${n.index}`),G.resolve(e.id)):(this.pdfiumModule.FPDFPage_RemoveAnnot(F.pagePtr,d),F.release(),this.logger.perf(f,D,"CreatePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.CantSetAnnotContent,message:"can not add content of the annotation"}))}updatePageAnnotation(r,n,e){this.logger.debug(f,D,"updatePageAnnotation",r,n,e),this.logger.perf(f,D,"UpdatePageAnnotation","Begin",`${r.id}-${n.index}`);const i=this.cache.getContext(r.id);if(!i)return this.logger.perf(f,D,"UpdatePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const u=i.acquirePage(n.index),F=this.getAnnotationByName(u.pagePtr,e.id);if(!F)return u.release(),this.logger.perf(f,D,"UpdatePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.NotFound,message:"annotation not found"});if(!this.setPageAnnoRect(n,F,e.rect))return this.pdfiumModule.FPDFPage_CloseAnnot(F),u.release(),this.logger.perf(f,D,"UpdatePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.CantSetAnnotRect,message:"failed to move annotation"});let d=!1;switch(e.type){case R.INK:{if(!this.pdfiumModule.FPDFAnnot_RemoveInkList(F))break;d=this.addInkStroke(n,u.pagePtr,F,e);break}case R.STAMP:{d=this.addStampContent(i.docPtr,n,u.pagePtr,F,e);break}case R.TEXT:{d=this.addTextContent(n,u.pagePtr,F,e);break}case R.FREETEXT:{d=this.addFreeTextContent(n,u.pagePtr,F,e);break}case R.CIRCLE:case R.SQUARE:{d=this.addShapeContent(n,u.pagePtr,F,e);break}case R.LINE:{d=this.addLineContent(n,u.pagePtr,F,e);break}case R.POLYGON:case R.POLYLINE:{d=this.addPolyContent(n,u.pagePtr,F,e);break}case R.HIGHLIGHT:case R.UNDERLINE:case R.STRIKEOUT:case R.SQUIGGLY:{d=this.addTextMarkupContent(n,u.pagePtr,F,e);break}default:d=!1}return d&&(e.blendMode!==void 0?this.pdfiumModule.EPDFAnnot_GenerateAppearanceWithBlend(F,e.blendMode):this.pdfiumModule.EPDFAnnot_GenerateAppearance(F),this.pdfiumModule.FPDFPage_GenerateContent(u.pagePtr)),this.pdfiumModule.FPDFPage_CloseAnnot(F),u.release(),this.logger.perf(f,D,"UpdatePageAnnotation","End",`${r.id}-${n.index}`),d?G.resolve(!0):G.reject({code:O.CantSetAnnotContent,message:"failed to update annotation"})}removePageAnnotation(r,n,e){this.logger.debug(f,D,"removePageAnnotation",r,n,e),this.logger.perf(f,D,"RemovePageAnnotation","Begin",`${r.id}-${n.index}`);const i=this.cache.getContext(r.id);if(!i)return this.logger.perf(f,D,"RemovePageAnnotation","End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const u=i.acquirePage(n.index);let F=!1;return F=this.removeAnnotationByName(u.pagePtr,e.id),F?(F=this.pdfiumModule.FPDFPage_GenerateContent(u.pagePtr),F||this.logger.error(f,D,"FPDFPage_GenerateContent Failed",`${r.id}-${n.index}`)):this.logger.error(f,D,"FPDFPage_RemoveAnnot Failed",`${r.id}-${n.index}`),u.release(),this.logger.perf(f,D,"RemovePageAnnotation","End",`${r.id}-${n.index}`),G.resolve(F)}getPageTextRects(r,n){this.logger.debug(f,D,"getPageTextRects",r,n),this.logger.perf(f,D,"GetPageTextRects","Begin",`${r.id}-${n.index}`);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"GetPageTextRects","End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=e.acquirePage(n.index),u=this.pdfiumModule.FPDFText_LoadPage(i.pagePtr),F=this.readPageTextRects(n,i.docPtr,i.pagePtr,u);return this.pdfiumModule.FPDFText_ClosePage(u),i.release(),this.logger.perf(f,D,"GetPageTextRects","End",`${r.id}-${n.index}`),G.resolve(F)}renderThumbnail(r,n,e){const{scaleFactor:i=1,...u}=e??{};if(this.logger.debug(f,D,"renderThumbnail",r,n,e),this.logger.perf(f,D,"RenderThumbnail","Begin",`${r.id}-${n.index}`),!this.cache.getContext(r.id))return this.logger.perf(f,D,"RenderThumbnail","End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const d=this.renderPage(r,n,{scaleFactor:Math.max(i,.5),...u});return this.logger.perf(f,D,"RenderThumbnail","End",`${r.id}-${n.index}`),d}getAttachments(r){this.logger.debug(f,D,"getAttachments",r),this.logger.perf(f,D,"GetAttachments","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"GetAttachments","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=[],i=this.pdfiumModule.FPDFDoc_GetAttachmentCount(n.docPtr);for(let u=0;u<i;u++){const F=this.readPdfAttachment(n.docPtr,u);e.push(F)}return this.logger.perf(f,D,"GetAttachments","End",r.id),G.resolve(e)}addAttachment(r,n){this.logger.debug(f,D,"addAttachment",r,n==null?void 0:n.name),this.logger.perf(f,D,"AddAttachment","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"AddAttachment","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const{name:i,description:u,mimeType:F,data:d}=n??{};if(!i)return this.logger.perf(f,D,"AddAttachment","End",r.id),G.reject({code:O.NotFound,message:"attachment name is required"});if(!d||(d instanceof Uint8Array,d.byteLength===0))return this.logger.perf(f,D,"AddAttachment","End",r.id),G.reject({code:O.NotFound,message:"attachment data is empty"});const _=this.withWString(i,A=>this.pdfiumModule.FPDFDoc_AddAttachment(e.docPtr,A));if(!_)return this.logger.perf(f,D,"AddAttachment","End",r.id),G.reject({code:O.Unknown,message:`An attachment named "${i}" already exists`});this.withWString(u,A=>this.pdfiumModule.EPDFAttachment_SetDescription(_,A)),this.pdfiumModule.EPDFAttachment_SetSubtype(_,F);const P=d instanceof Uint8Array?d:new Uint8Array(d),h=P.byteLength,b=this.memoryManager.malloc(h);try{if(this.pdfiumModule.pdfium.HEAPU8.set(P,b),!this.pdfiumModule.FPDFAttachment_SetFile(_,e.docPtr,b,h))return this.logger.perf(f,D,"AddAttachment","End",r.id),G.reject({code:O.Unknown,message:"failed to write attachment bytes"})}finally{this.memoryManager.free(b)}return this.logger.perf(f,D,"AddAttachment","End",r.id),G.resolve(!0)}removeAttachment(r,n){this.logger.debug(f,D,"deleteAttachment",r,n),this.logger.perf(f,D,"DeleteAttachment","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"DeleteAttachment","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=this.pdfiumModule.FPDFDoc_GetAttachmentCount(e.docPtr);if(n.index<0||n.index>=i)return this.logger.perf(f,D,"DeleteAttachment","End",r.id),G.reject({code:O.Unknown,message:`attachment index ${n.index} out of range`});const u=this.pdfiumModule.FPDFDoc_DeleteAttachment(e.docPtr,n.index);return this.logger.perf(f,D,"DeleteAttachment","End",r.id),u?G.resolve(!0):G.reject({code:O.Unknown,message:"failed to delete attachment"})}readAttachmentContent(r,n){this.logger.debug(f,D,"readAttachmentContent",r,n),this.logger.perf(f,D,"ReadAttachmentContent","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"ReadAttachmentContent","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=this.pdfiumModule.FPDFDoc_GetAttachment(e.docPtr,n.index),u=this.memoryManager.malloc(4);if(!this.pdfiumModule.FPDFAttachment_GetFile(i,0,0,u))return this.memoryManager.free(u),this.logger.perf(f,D,"ReadAttachmentContent","End",r.id),G.reject({code:O.CantReadAttachmentSize,message:"can not read attachment size"});const F=this.pdfiumModule.pdfium.getValue(u,"i32")>>>0,d=this.memoryManager.malloc(F);if(!this.pdfiumModule.FPDFAttachment_GetFile(i,d,F,u))return this.memoryManager.free(u),this.memoryManager.free(d),this.logger.perf(f,D,"ReadAttachmentContent","End",r.id),G.reject({code:O.CantReadAttachmentContent,message:"can not read attachment content"});const _=new ArrayBuffer(F),P=new DataView(_);for(let h=0;h<F;h++)P.setInt8(h,this.pdfiumModule.pdfium.getValue(d+h,"i8"));return this.memoryManager.free(u),this.memoryManager.free(d),this.logger.perf(f,D,"ReadAttachmentContent","End",r.id),G.resolve(_)}setFormFieldValue(r,n,e,i){this.logger.debug(f,D,"SetFormFieldValue",r,e,i),this.logger.perf(f,D,"SetFormFieldValue","Begin",`${r.id}-${e.id}`);const u=this.cache.getContext(r.id);if(!u)return this.logger.debug(f,D,"SetFormFieldValue","document is not opened"),this.logger.perf(f,D,"SetFormFieldValue","End",`${r.id}-${e.id}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const F=this.pdfiumModule.PDFiumExt_OpenFormFillInfo(),d=this.pdfiumModule.PDFiumExt_InitFormFillEnvironment(u.docPtr,F),_=u.acquirePage(n.index);this.pdfiumModule.FORM_OnAfterLoadPage(_.pagePtr,d);const P=this.getAnnotationByName(_.pagePtr,e.id);if(!P)return _.release(),this.logger.perf(f,D,"SetFormFieldValue","End",`${r.id}-${n.index}`),G.reject({code:O.NotFound,message:"annotation not found"});if(!this.pdfiumModule.FORM_SetFocusedAnnot(d,P))return this.logger.debug(f,D,"SetFormFieldValue","failed to set focused annotation"),this.logger.perf(f,D,"SetFormFieldValue","End",`${r.id}-${e.id}`),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(F),G.reject({code:O.CantFocusAnnot,message:"failed to set focused annotation"});switch(i.kind){case"text":{if(!this.pdfiumModule.FORM_SelectAllText(d,_.pagePtr))return this.logger.debug(f,D,"SetFormFieldValue","failed to select all text"),this.logger.perf(f,D,"SetFormFieldValue","End",`${r.id}-${e.id}`),this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(F),G.reject({code:O.CantSelectText,message:"failed to select all text"});const h=2*(i.text.length+1),b=this.memoryManager.malloc(h);this.pdfiumModule.pdfium.stringToUTF16(i.text,b,h),this.pdfiumModule.FORM_ReplaceSelection(d,_.pagePtr,b),this.memoryManager.free(b)}break;case"selection":if(!this.pdfiumModule.FORM_SetIndexSelected(d,_.pagePtr,i.index,i.isSelected))return this.logger.debug(f,D,"SetFormFieldValue","failed to set index selected"),this.logger.perf(f,D,"SetFormFieldValue","End",`${r.id}-${e.id}`),this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(F),G.reject({code:O.CantSelectOption,message:"failed to set index selected"});break;case"checked":if(!this.pdfiumModule.FORM_OnChar(d,_.pagePtr,13,0))return this.logger.debug(f,D,"SetFormFieldValue","failed to set field checked"),this.logger.perf(f,D,"SetFormFieldValue","End",`${r.id}-${e.id}`),this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(F),G.reject({code:O.CantCheckField,message:"failed to set field checked"});break}return this.pdfiumModule.FORM_ForceToKillFocus(d),this.pdfiumModule.FPDFPage_CloseAnnot(P),this.pdfiumModule.FORM_OnBeforeClosePage(_.pagePtr,d),_.release(),this.pdfiumModule.PDFiumExt_ExitFormFillEnvironment(d),this.pdfiumModule.PDFiumExt_CloseFormFillInfo(F),G.resolve(!0)}flattenPage(r,n,e){const{flag:i=$r.Display}=e??{};this.logger.debug(f,D,"flattenPage",r,n,i),this.logger.perf(f,D,"flattenPage","Begin",r.id);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(f,D,"flattenPage","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const F=u.acquirePage(n.index),d=this.pdfiumModule.FPDFPage_Flatten(F.pagePtr,i);return F.release(),this.logger.perf(f,D,"flattenPage","End",r.id),G.resolve(d)}extractPages(r,n){this.logger.debug(f,D,"extractPages",r,n),this.logger.perf(f,D,"ExtractPages","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"ExtractPages","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=this.pdfiumModule.FPDF_CreateNewDocument();if(!i)return this.logger.perf(f,D,"ExtractPages","End",r.id),G.reject({code:O.CantCreateNewDoc,message:"can not create new document"});const u=this.memoryManager.malloc(n.length*4);for(let d=0;d<n.length;d++)this.pdfiumModule.pdfium.setValue(u+d*4,n[d],"i32");if(!this.pdfiumModule.FPDF_ImportPagesByIndex(i,e.docPtr,u,n.length,0))return this.pdfiumModule.FPDF_CloseDocument(i),this.logger.perf(f,D,"ExtractPages","End",r.id),G.reject({code:O.CantImportPages,message:"can not import pages to new document"});const F=this.saveDocument(i);return this.pdfiumModule.FPDF_CloseDocument(i),this.logger.perf(f,D,"ExtractPages","End",r.id),G.resolve(F)}extractText(r,n){this.logger.debug(f,D,"extractText",r,n),this.logger.perf(f,D,"ExtractText","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"ExtractText","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=[];for(let F=0;F<n.length;F++){const d=e.acquirePage(n[F]),_=this.pdfiumModule.FPDFText_LoadPage(d.pagePtr),P=this.pdfiumModule.FPDFText_CountChars(_),h=this.memoryManager.malloc((P+1)*2);this.pdfiumModule.FPDFText_GetText(_,0,P,h);const b=this.pdfiumModule.pdfium.UTF16ToString(h);this.memoryManager.free(h),i.push(b),this.pdfiumModule.FPDFText_ClosePage(_),d.release()}const u=i.join(`

`);return this.logger.perf(f,D,"ExtractText","End",r.id),G.resolve(u)}getTextSlices(r,n){if(this.logger.debug(f,D,"getTextSlices",r,n),this.logger.perf(f,D,"GetTextSlices","Begin",r.id),n.length===0)return this.logger.perf(f,D,"GetTextSlices","End",r.id),G.resolve([]);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"GetTextSlices","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});try{const i=new Array(n.length),u=new Map;n.forEach((F,d)=>{(u.get(F.pageIndex)??u.set(F.pageIndex,[]).get(F.pageIndex)).push({slice:F,pos:d})});for(const[F,d]of u){const _=e.acquirePage(F),P=_.getTextPage();for(const{slice:h,pos:b}of d){const A=this.memoryManager.malloc(2*(h.charCount+1));this.pdfiumModule.FPDFText_GetText(P,h.charIndex,h.charCount,A),i[b]=Yr(this.pdfiumModule.pdfium.UTF16ToString(A)),this.memoryManager.free(A)}_.release()}return this.logger.perf(f,D,"GetTextSlices","End",r.id),G.resolve(i)}catch(i){return this.logger.error(f,D,"getTextSlices error",i),this.logger.perf(f,D,"GetTextSlices","End",r.id),G.reject({code:O.Unknown,message:String(i)})}}merge(r){this.logger.debug(f,D,"merge",r);const n=r.map(d=>d.id).join(".");this.logger.perf(f,D,"Merge","Begin",n);const e=this.pdfiumModule.FPDF_CreateNewDocument();if(!e)return this.logger.perf(f,D,"Merge","End",n),G.reject({code:O.CantCreateNewDoc,message:"can not create new document"});const i=[];for(const d of r.reverse()){const _=new Uint8Array(d.content),P=_.length,h=this.memoryManager.malloc(P);this.pdfiumModule.pdfium.HEAPU8.set(_,h);const b=this.pdfiumModule.FPDF_LoadMemDocument(h,P,"");if(!b){const A=this.pdfiumModule.FPDF_GetLastError();this.logger.error(f,D,`FPDF_LoadMemDocument failed with ${A}`),this.memoryManager.free(h);for(const M of i)this.pdfiumModule.FPDF_CloseDocument(M.docPtr),this.memoryManager.free(M.filePtr);return this.logger.perf(f,D,"Merge","End",n),G.reject({code:A,message:"FPDF_LoadMemDocument failed"})}if(i.push({filePtr:h,docPtr:b}),!this.pdfiumModule.FPDF_ImportPages(e,b,"",0)){this.pdfiumModule.FPDF_CloseDocument(e);for(const A of i)this.pdfiumModule.FPDF_CloseDocument(A.docPtr),this.memoryManager.free(A.filePtr);return this.logger.perf(f,D,"Merge","End",n),G.reject({code:O.CantImportPages,message:"can not import pages to new document"})}}const u=this.saveDocument(e);this.pdfiumModule.FPDF_CloseDocument(e);for(const d of i)this.pdfiumModule.FPDF_CloseDocument(d.docPtr),this.memoryManager.free(d.filePtr);const F={id:`${Math.random()}`,content:u};return this.logger.perf(f,D,"Merge","End",n),G.resolve(F)}mergePages(r){const n=r.map(i=>`${i.docId}:${i.pageIndices.join(",")}`).join("|");this.logger.debug(f,D,"mergePages",r),this.logger.perf(f,D,"MergePages","Begin",n);const e=this.pdfiumModule.FPDF_CreateNewDocument();if(!e)return this.logger.perf(f,D,"MergePages","End",n),G.reject({code:O.CantCreateNewDoc,message:"Cannot create new document"});try{for(const F of[...r].reverse()){const d=this.cache.getContext(F.docId);if(!d){this.logger.warn(f,D,`Document ${F.docId} is not open, skipping`);continue}const _=this.pdfiumModule.FPDF_GetPageCount(d.docPtr),P=F.pageIndices.filter(b=>b>=0&&b<_);if(P.length===0)continue;const h=P.map(b=>b+1).join(",");try{if(!this.pdfiumModule.FPDF_ImportPages(e,d.docPtr,h,0))throw new Error(`Failed to import pages ${h} from document ${F.docId}`)}finally{}}const i=this.saveDocument(e),u={id:`${Math.random()}`,content:i};return this.logger.perf(f,D,"MergePages","End",n),G.resolve(u)}catch(i){return this.logger.error(f,D,"mergePages failed",i),this.logger.perf(f,D,"MergePages","End",n),G.reject({code:O.CantImportPages,message:i instanceof Error?i.message:"Failed to merge pages"})}finally{e&&this.pdfiumModule.FPDF_CloseDocument(e)}}saveAsCopy(r){this.logger.debug(f,D,"saveAsCopy",r),this.logger.perf(f,D,"SaveAsCopy","Begin",r.id);const n=this.cache.getContext(r.id);if(!n)return this.logger.perf(f,D,"SaveAsCopy","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const e=this.saveDocument(n.docPtr);return this.logger.perf(f,D,"SaveAsCopy","End",r.id),G.resolve(e)}closeDocument(r){this.logger.debug(f,D,"closeDocument",r),this.logger.perf(f,D,"CloseDocument","Begin",r.id);const n=this.cache.getContext(r.id);return n?(n.dispose(),this.logger.perf(f,D,"CloseDocument","End",r.id),G.resolve(!0)):(this.logger.perf(f,D,"CloseDocument","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"}))}closeAllDocuments(){return this.logger.debug(f,D,"closeAllDocuments"),this.logger.perf(f,D,"CloseAllDocuments","Begin"),this.cache.closeAllDocuments(),this.logger.perf(f,D,"CloseAllDocuments","End"),G.resolve(!0)}addTextContent(r,n,e,i){return!(!this.setAnnotString(e,"Contents",i.contents??"")||!this.setAnnotString(e,"T",i.author||"")||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.inReplyToId&&!this.setInReplyToId(n,e,i.inReplyToId)||!this.setAnnotationIcon(e,i.icon||Xr.Comment)||!this.setAnnotationFlags(e,i.flags||["print","noZoom","noRotate"])||i.state&&!this.setAnnotString(e,"State",i.state)||i.stateModel&&!this.setAnnotString(e,"StateModel",i.stateModel))}addFreeTextContent(r,n,e,i){if(i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.flags&&!this.setAnnotationFlags(e,i.flags)||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||!this.setBorderStyle(e,Ge.SOLID,0)||!this.setAnnotString(e,"Contents",i.contents??"")||!this.setAnnotString(e,"T",i.author||"")||!this.setAnnotationOpacity(e,i.opacity??1)||!this.setAnnotationTextAlignment(e,i.textAlign)||!this.setAnnotationVerticalAlignment(e,i.verticalAlign)||!this.setAnnotationDefaultAppearance(e,i.fontFamily,i.fontSize,i.fontColor)||i.intent&&!this.setAnnotIntent(e,i.intent))return!1;if(!i.backgroundColor||i.backgroundColor==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(e,ne.Color))return!1}else if(!this.setAnnotationColor(e,i.backgroundColor??"#FFFFFF",ne.Color))return!1;return!0}addInkStroke(r,n,e,i){return!(i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.flags&&!this.setAnnotationFlags(e,i.flags)||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||!this.setAnnotString(e,"Contents",i.contents??"")||!this.setBorderStyle(e,Ge.SOLID,i.strokeWidth)||!this.setInkList(r,e,i.inkList)||!this.setAnnotString(e,"T",i.author||"")||!this.setAnnotationOpacity(e,i.opacity??1)||!this.setAnnotationColor(e,i.color??"#FFFF00",ne.Color))}addLineContent(r,n,e,i){var u,F;if(i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.flags&&!this.setAnnotationFlags(e,i.flags)||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||!this.setLinePoints(r,e,i.linePoints.start,i.linePoints.end)||!this.setLineEndings(e,((u=i.lineEndings)==null?void 0:u.start)??Ve.None,((F=i.lineEndings)==null?void 0:F.end)??Ve.None)||!this.setAnnotString(e,"Contents",i.contents??"")||!this.setAnnotString(e,"T",i.author||"")||!this.setBorderStyle(e,i.strokeStyle,i.strokeWidth)||!this.setBorderDashPattern(e,i.strokeDashArray??[])||i.intent&&!this.setAnnotIntent(e,i.intent))return!1;if(!i.color||i.color==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(e,ne.InteriorColor))return!1}else if(!this.setAnnotationColor(e,i.color??"#FFFF00",ne.InteriorColor))return!1;return!(!this.setAnnotationOpacity(e,i.opacity??1)||!this.setAnnotationColor(e,i.strokeColor??"#FFFF00",ne.Color))}addPolyContent(r,n,e,i){var u,F;if(i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||i.flags&&!this.setAnnotationFlags(e,i.flags)||i.type===R.POLYLINE&&!this.setLineEndings(e,((u=i.lineEndings)==null?void 0:u.start)??Ve.None,((F=i.lineEndings)==null?void 0:F.end)??Ve.None)||!this.setPdfAnnoVertices(r,e,i.vertices)||!this.setAnnotString(e,"Contents",i.contents??"")||!this.setAnnotString(e,"T",i.author||"")||!this.setBorderStyle(e,i.strokeStyle,i.strokeWidth)||!this.setBorderDashPattern(e,i.strokeDashArray??[])||i.intent&&!this.setAnnotIntent(e,i.intent))return!1;if(!i.color||i.color==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(e,ne.InteriorColor))return!1}else if(!this.setAnnotationColor(e,i.color??"#FFFF00",ne.InteriorColor))return!1;return!(!this.setAnnotationOpacity(e,i.opacity??1)||!this.setAnnotationColor(e,i.strokeColor??"#FFFF00",ne.Color))}addShapeContent(r,n,e,i){if(i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||!this.setAnnotString(e,"Contents",i.contents??"")||!this.setAnnotString(e,"T",i.author||"")||!this.setBorderStyle(e,i.strokeStyle,i.strokeWidth)||!this.setBorderDashPattern(e,i.strokeDashArray??[])||!this.setAnnotationFlags(e,i.flags))return!1;if(!i.color||i.color==="transparent"){if(!this.pdfiumModule.EPDFAnnot_ClearColor(e,ne.InteriorColor))return!1}else if(!this.setAnnotationColor(e,i.color??"#FFFF00",ne.InteriorColor))return!1;return!(!this.setAnnotationOpacity(e,i.opacity??1)||!this.setAnnotationColor(e,i.strokeColor??"#FFFF00",ne.Color))}addTextMarkupContent(r,n,e,i){return!(i.created&&!this.setAnnotationDate(e,"CreationDate",i.created)||i.custom&&!this.setAnnotCustom(e,i.custom)||i.flags&&!this.setAnnotationFlags(e,i.flags)||i.modified&&!this.setAnnotationDate(e,"M",i.modified)||!this.syncQuadPointsAnno(r,e,i.segmentRects)||!this.setAnnotString(e,"Contents",i.contents??"")||!this.setAnnotString(e,"T",i.author||"")||!this.setAnnotationOpacity(e,i.opacity??1)||!this.setAnnotationColor(e,i.color??"#FFFF00",ne.Color))}addStampContent(r,n,e,i,u,F){if(u.created&&!this.setAnnotationDate(i,"CreationDate",u.created)||u.flags&&!this.setAnnotationFlags(i,u.flags)||u.modified&&!this.setAnnotationDate(i,"M",u.modified)||u.icon&&!this.setAnnotationIcon(i,u.icon)||u.subject&&!this.setAnnotString(i,"Subj",u.subject)||!this.setAnnotString(i,"Contents",u.contents??""))return!1;if(F){for(let d=this.pdfiumModule.FPDFAnnot_GetObjectCount(i)-1;d>=0;d--)this.pdfiumModule.FPDFAnnot_RemoveObject(i,d);if(!this.addImageObject(r,n,e,i,u.rect,F))return!1}return!!this.pdfiumModule.EPDFAnnot_UpdateAppearanceToRect(i,Kr.Cover)}addImageObject(r,n,e,i,u,F){const _=F.width*F.height,P=this.memoryManager.malloc(4*_);if(!P)return!1;for(let S=0;S<_;S++){const x=F.data[S*4],v=F.data[S*4+1],I=F.data[S*4+2],B=F.data[S*4+3];this.pdfiumModule.pdfium.setValue(P+S*4,I,"i8"),this.pdfiumModule.pdfium.setValue(P+S*4+1,v,"i8"),this.pdfiumModule.pdfium.setValue(P+S*4+2,x,"i8"),this.pdfiumModule.pdfium.setValue(P+S*4+3,B,"i8")}const b=this.pdfiumModule.FPDFBitmap_CreateEx(F.width,F.height,4,P,0);if(!b)return this.memoryManager.free(P),!1;const A=this.pdfiumModule.FPDFPageObj_NewImageObj(r);if(!A)return this.pdfiumModule.FPDFBitmap_Destroy(b),this.memoryManager.free(P),!1;if(!this.pdfiumModule.FPDFImageObj_SetBitmap(e,0,A,b))return this.pdfiumModule.FPDFBitmap_Destroy(b),this.pdfiumModule.FPDFPageObj_Destroy(A),this.memoryManager.free(P),!1;const M=this.memoryManager.malloc(6*4);if(this.pdfiumModule.pdfium.setValue(M,F.width,"float"),this.pdfiumModule.pdfium.setValue(M+4,0,"float"),this.pdfiumModule.pdfium.setValue(M+8,0,"float"),this.pdfiumModule.pdfium.setValue(M+12,F.height,"float"),this.pdfiumModule.pdfium.setValue(M+16,0,"float"),this.pdfiumModule.pdfium.setValue(M+20,0,"float"),!this.pdfiumModule.FPDFPageObj_SetMatrix(A,M))return this.memoryManager.free(M),this.pdfiumModule.FPDFBitmap_Destroy(b),this.pdfiumModule.FPDFPageObj_Destroy(A),this.memoryManager.free(P),!1;this.memoryManager.free(M);const y=this.convertDevicePointToPagePoint(n,{x:u.origin.x,y:u.origin.y+F.height});return this.pdfiumModule.FPDFPageObj_Transform(A,1,0,0,1,y.x,y.y),this.pdfiumModule.FPDFAnnot_AppendObject(i,A)?(this.pdfiumModule.FPDFBitmap_Destroy(b),this.memoryManager.free(P),!0):(this.pdfiumModule.FPDFBitmap_Destroy(b),this.pdfiumModule.FPDFPageObj_Destroy(A),this.memoryManager.free(P),!1)}saveDocument(r){const n=this.pdfiumModule.PDFiumExt_OpenFileWriter();this.pdfiumModule.PDFiumExt_SaveAsCopy(r,n);const e=this.pdfiumModule.PDFiumExt_GetFileWriterSize(n),i=this.memoryManager.malloc(e);this.pdfiumModule.PDFiumExt_GetFileWriterData(n,i,e);const u=new ArrayBuffer(e),F=new DataView(u);for(let d=0;d<e;d++)F.setInt8(d,this.pdfiumModule.pdfium.getValue(i+d,"i8"));return this.memoryManager.free(i),this.pdfiumModule.PDFiumExt_CloseFileWriter(n),u}readCatalogLanguage(r){const n=this.pdfiumModule.EPDFCatalog_GetLanguage(r,0,0)>>>0;return n===0?null:n===2?"":se(this.pdfiumModule.pdfium,(e,i)=>this.pdfiumModule.EPDFCatalog_GetLanguage(r,e,i),this.pdfiumModule.pdfium.UTF16ToString,n)}readMetaText(r,n){if(!!!this.pdfiumModule.EPDF_HasMetaText(r,n))return null;const i=this.pdfiumModule.FPDF_GetMetaText(r,n,0,0);return i===2?"":se(this.pdfiumModule.pdfium,(u,F)=>this.pdfiumModule.FPDF_GetMetaText(r,n,u,F),this.pdfiumModule.pdfium.UTF16ToString,i)}setMetaText(r,n,e){if(e==null||e.length===0)return!!this.pdfiumModule.EPDF_SetMetaText(r,n,0);const i=2*(e.length+1),u=this.memoryManager.malloc(i);try{return this.pdfiumModule.pdfium.stringToUTF16(e,u,i),!!this.pdfiumModule.EPDF_SetMetaText(r,n,u)}finally{this.memoryManager.free(u)}}getMetaTrapped(r){const n=Number(this.pdfiumModule.EPDF_GetMetaTrapped(r));switch(n){case Ae.NotSet:case Ae.True:case Ae.False:case Ae.Unknown:return n;default:return Ae.Unknown}}setMetaTrapped(r,n){const e=n==null||n===void 0?Ae.NotSet:n;return e===Ae.NotSet||e===Ae.True||e===Ae.False||e===Ae.Unknown?!!this.pdfiumModule.EPDF_SetMetaTrapped(r,e):!1}getMetaKeyCount(r,n){return Number(this.pdfiumModule.EPDF_GetMetaKeyCount(r,n))|0}getMetaKeyName(r,n,e){const i=this.pdfiumModule.EPDF_GetMetaKeyName(r,n,e,0,0);return i?se(this.pdfiumModule.pdfium,(u,F)=>this.pdfiumModule.EPDF_GetMetaKeyName(r,n,e,u,F),this.pdfiumModule.pdfium.UTF8ToString,i):null}readAllMeta(r,n=!0){const e=this.getMetaKeyCount(r,n),i={};for(let u=0;u<e;u++){const F=this.getMetaKeyName(r,u,n);F&&(i[F]=this.readMetaText(r,F))}return i}readPdfBookmarks(r,n=0){let e=this.pdfiumModule.FPDFBookmark_GetFirstChild(r,n);const i=[];for(;e;){const u=this.readPdfBookmark(r,e);i.push(u),e=this.pdfiumModule.FPDFBookmark_GetNextSibling(r,e)}return i}readPdfBookmark(r,n){const e=se(this.pdfiumModule.pdfium,(F,d)=>this.pdfiumModule.FPDFBookmark_GetTitle(n,F,d),this.pdfiumModule.pdfium.UTF16ToString),i=this.readPdfBookmarks(r,n),u=this.readPdfBookmarkTarget(r,()=>this.pdfiumModule.FPDFBookmark_GetAction(n),()=>this.pdfiumModule.FPDFBookmark_GetDest(r,n));return{title:e,target:u,children:i}}readPageTextRects(r,n,e,i){const u=this.pdfiumModule.FPDFText_CountRects(i,0,-1),F=[];for(let d=0;d<u;d++){const _=this.memoryManager.malloc(8),P=this.memoryManager.malloc(8),h=this.memoryManager.malloc(8),b=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDFText_GetRect(i,d,P,_,h,b)){this.memoryManager.free(P),this.memoryManager.free(_),this.memoryManager.free(h),this.memoryManager.free(b);continue}const M=this.pdfiumModule.pdfium.getValue(P,"double"),y=this.pdfiumModule.pdfium.getValue(_,"double"),S=this.pdfiumModule.pdfium.getValue(h,"double"),x=this.pdfiumModule.pdfium.getValue(b,"double");this.memoryManager.free(P),this.memoryManager.free(_),this.memoryManager.free(h),this.memoryManager.free(b);const v=this.memoryManager.malloc(4),I=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(e,0,0,r.size.width,r.size.height,0,M,y,v,I);const B=this.pdfiumModule.pdfium.getValue(v,"i32"),Y=this.pdfiumModule.pdfium.getValue(I,"i32");this.memoryManager.free(v),this.memoryManager.free(I);const C={origin:{x:B,y:Y},size:{width:Math.ceil(Math.abs(S-M)),height:Math.ceil(Math.abs(y-x))}},H=this.pdfiumModule.FPDFText_GetBoundedText(i,M,y,S,x,0,0),te=(H+1)*2,X=this.memoryManager.malloc(te);this.pdfiumModule.FPDFText_GetBoundedText(i,M,y,S,x,X,H);const re=this.pdfiumModule.pdfium.UTF16ToString(X);this.memoryManager.free(X);const k=this.pdfiumModule.FPDFText_GetCharIndexAtPos(i,M,y,2,2);let K="",me=C.size.height;if(k>=0){me=this.pdfiumModule.FPDFText_GetFontSize(i,k);const fe=this.pdfiumModule.FPDFText_GetFontInfo(i,k,0,0,0)+1,oe=this.memoryManager.malloc(fe),Fe=this.memoryManager.malloc(4);this.pdfiumModule.FPDFText_GetFontInfo(i,k,oe,fe,Fe),K=this.pdfiumModule.pdfium.UTF8ToString(oe),this.memoryManager.free(oe),this.memoryManager.free(Fe)}const Ce={content:re,rect:C,font:{family:K,size:me}};F.push(Ce)}return F}getPageGeometry(r,n){const e="getPageGeometry";this.logger.perf(f,D,e,"Begin",r.id);const i=this.cache.getContext(r.id);if(!i)return this.logger.perf(f,D,e,"End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const u=i.acquirePage(n.index),F=u.getTextPage(),d=this.pdfiumModule.FPDFText_CountChars(F),_=[];for(let h=0;h<d;h++){const b=this.readGlyphInfo(n,u.pagePtr,F,h);_.push(b)}const P=this.buildRunsFromGlyphs(_,F);return u.release(),this.logger.perf(f,D,e,"End",r.id),G.resolve({runs:P})}buildRunsFromGlyphs(r,n){const e=[];let i=null,u=null,F=null;for(let d=0;d<r.length;d++){const _=r[d],P=this.pdfiumModule.FPDFText_GetTextObject(n,d);if(P!==u&&(u=P,i={rect:{x:_.origin.x,y:_.origin.y,width:_.size.width,height:_.size.height},charStart:d,glyphs:[]},F={minX:_.origin.x,minY:_.origin.y,maxX:_.origin.x+_.size.width,maxY:_.origin.y+_.size.height},e.push(i)),i.glyphs.push({x:_.origin.x,y:_.origin.y,width:_.size.width,height:_.size.height,flags:_.isEmpty?2:_.isSpace?1:0}),_.isEmpty)continue;const h=_.origin.x+_.size.width,b=_.origin.y+_.size.height;F.minX=Math.min(F.minX,_.origin.x),F.minY=Math.min(F.minY,_.origin.y),F.maxX=Math.max(F.maxX,h),F.maxY=Math.max(F.maxY,b),i.rect.x=F.minX,i.rect.y=F.minY,i.rect.width=F.maxX-F.minX,i.rect.height=F.maxY-F.minY}return e}readGlyphInfo(r,n,e,i){const u=this.memoryManager.malloc(4),F=this.memoryManager.malloc(4),d=this.memoryManager.malloc(4),_=this.memoryManager.malloc(4),P=this.memoryManager.malloc(16);let h=0,b=0,A=0,M=0,y=!1;if(this.pdfiumModule.FPDFText_GetLooseCharBox(e,i,P)){const S=this.pdfiumModule.pdfium.getValue(P,"float"),x=this.pdfiumModule.pdfium.getValue(P+4,"float"),v=this.pdfiumModule.pdfium.getValue(P+8,"float"),I=this.pdfiumModule.pdfium.getValue(P+12,"float");if(S===v||x===I)return[P,u,F,d,_].forEach(X=>this.memoryManager.free(X)),{origin:{x:0,y:0},size:{width:0,height:0},isEmpty:!0};this.pdfiumModule.FPDF_PageToDevice(n,0,0,r.size.width,r.size.height,0,S,x,u,F),this.pdfiumModule.FPDF_PageToDevice(n,0,0,r.size.width,r.size.height,0,v,I,d,_);const B=this.pdfiumModule.pdfium.getValue(u,"i32"),Y=this.pdfiumModule.pdfium.getValue(F,"i32"),C=this.pdfiumModule.pdfium.getValue(d,"i32"),H=this.pdfiumModule.pdfium.getValue(_,"i32");h=Math.min(B,C),b=Math.min(Y,H),A=Math.max(1,Math.abs(C-B)),M=Math.max(1,Math.abs(H-Y)),y=this.pdfiumModule.FPDFText_GetUnicode(e,i)===32}return[P,u,F,d,_].forEach(S=>this.memoryManager.free(S)),{origin:{x:h,y:b},size:{width:A,height:M},...y&&{isSpace:y}}}getPageGlyphs(r,n){this.logger.debug(f,D,"getPageGlyphs",r,n),this.logger.perf(f,D,"getPageGlyphs","Begin",r.id);const e=this.cache.getContext(r.id);if(!e)return this.logger.perf(f,D,"getPageGlyphs","End",r.id),G.reject({code:O.DocNotOpen,message:"document does not open"});const i=e.acquirePage(n.index),u=i.getTextPage(),F=this.pdfiumModule.FPDFText_CountChars(u),d=new Array(F);for(let _=0;_<F;_++){const P=this.readGlyphInfo(n,i.pagePtr,u,_);P.isEmpty||(d[_]={...P})}return i.release(),this.logger.perf(f,D,"getPageGlyphs","End",r.id),G.resolve(d)}readCharBox(r,n,e,i){const u=this.memoryManager.malloc(8),F=this.memoryManager.malloc(8),d=this.memoryManager.malloc(8),_=this.memoryManager.malloc(8);let P=0,h=0,b=0,A=0;if(this.pdfiumModule.FPDFText_GetCharBox(e,i,F,_,d,u)){const M=this.pdfiumModule.pdfium.getValue(u,"double"),y=this.pdfiumModule.pdfium.getValue(F,"double"),S=this.pdfiumModule.pdfium.getValue(d,"double"),x=this.pdfiumModule.pdfium.getValue(_,"double"),v=this.memoryManager.malloc(4),I=this.memoryManager.malloc(4);this.pdfiumModule.FPDF_PageToDevice(n,0,0,r.size.width,r.size.height,0,y,M,v,I),P=this.pdfiumModule.pdfium.getValue(v,"i32"),h=this.pdfiumModule.pdfium.getValue(I,"i32"),this.memoryManager.free(v),this.memoryManager.free(I),b=Math.ceil(Math.abs(x-y)),A=Math.ceil(Math.abs(M-S))}return this.memoryManager.free(u),this.memoryManager.free(F),this.memoryManager.free(d),this.memoryManager.free(_),{origin:{x:P,y:h},size:{width:b,height:A}}}readPageAnnotations(r,n){return r.borrowPage(n.index,e=>{const i=this.pdfiumModule.FPDFPage_GetAnnotCount(e.pagePtr),u=[];for(let F=0;F<i;F++)e.withAnnotation(F,d=>{const _=this.readPageAnnotation(r.docPtr,n,d,e);_&&u.push(_)});return u})}readPageAnnotationsRaw(r,n){const e=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(r.docPtr,n.index);if(e<=0)return[];const i=[];for(let u=0;u<e;++u){const F=this.pdfiumModule.EPDFPage_GetAnnotRaw(r.docPtr,n.index,u);if(F)try{const d=this.readPageAnnotation(r.docPtr,n,F);d&&i.push(d)}finally{this.pdfiumModule.FPDFPage_CloseAnnot(F)}}return i}readPageAnnotation(r,n,e,i){let u=this.getAnnotString(e,"NM");(!u||!Jt(u))&&(u=qt(),this.setAnnotString(e,"NM",u));const F=this.pdfiumModule.FPDFAnnot_GetSubtype(e);let d;switch(F){case R.TEXT:d=this.readPdfTextAnno(n,e,u);break;case R.FREETEXT:d=this.readPdfFreeTextAnno(n,e,u);break;case R.LINK:d=this.readPdfLinkAnno(n,r,e,u);break;case R.WIDGET:if(i)return this.readPdfWidgetAnno(n,e,i.getFormHandle(),u);case R.FILEATTACHMENT:d=this.readPdfFileAttachmentAnno(n,e,u);break;case R.INK:d=this.readPdfInkAnno(n,e,u);break;case R.POLYGON:d=this.readPdfPolygonAnno(n,e,u);break;case R.POLYLINE:d=this.readPdfPolylineAnno(n,e,u);break;case R.LINE:d=this.readPdfLineAnno(n,e,u);break;case R.HIGHLIGHT:d=this.readPdfHighlightAnno(n,e,u);break;case R.STAMP:d=this.readPdfStampAnno(n,e,u);break;case R.SQUARE:d=this.readPdfSquareAnno(n,e,u);break;case R.CIRCLE:d=this.readPdfCircleAnno(n,e,u);break;case R.UNDERLINE:d=this.readPdfUnderlineAnno(n,e,u);break;case R.SQUIGGLY:d=this.readPdfSquigglyAnno(n,e,u);break;case R.STRIKEOUT:d=this.readPdfStrikeOutAnno(n,e,u);break;case R.CARET:d=this.readPdfCaretAnno(n,e,u);break;default:d=this.readPdfAnno(n,F,e,u);break}return d}readAnnotationColor(r,n=ne.Color){const e=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),F=this.pdfiumModule.EPDFAnnot_GetColor(r,n,e,i,u);let d;return F&&(d={red:this.pdfiumModule.pdfium.getValue(e,"i32")&255,green:this.pdfiumModule.pdfium.getValue(i,"i32")&255,blue:this.pdfiumModule.pdfium.getValue(u,"i32")&255}),this.memoryManager.free(e),this.memoryManager.free(i),this.memoryManager.free(u),d}getAnnotationColor(r,n=ne.Color){const e=this.readAnnotationColor(r,n);return e?Qt(e):void 0}setAnnotationColor(r,n,e=ne.Color){const i=Zt(n);return this.pdfiumModule.EPDFAnnot_SetColor(r,e,i.red&255,i.green&255,i.blue&255)}getAnnotationOpacity(r){const n=this.memoryManager.malloc(4),i=this.pdfiumModule.EPDFAnnot_GetOpacity(r,n)?this.pdfiumModule.pdfium.getValue(n,"i32"):255;return this.memoryManager.free(n),Jr(i)}setAnnotationOpacity(r,n){const e=no(n);return this.pdfiumModule.EPDFAnnot_SetOpacity(r,e&255)}getAnnotationTextAlignment(r){return this.pdfiumModule.EPDFAnnot_GetTextAlignment(r)}setAnnotationTextAlignment(r,n){return!!this.pdfiumModule.EPDFAnnot_SetTextAlignment(r,n)}getAnnotationVerticalAlignment(r){return this.pdfiumModule.EPDFAnnot_GetVerticalAlignment(r)}setAnnotationVerticalAlignment(r,n){return!!this.pdfiumModule.EPDFAnnot_SetVerticalAlignment(r,n)}getAnnotationDefaultAppearance(r){const n=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),F=this.memoryManager.malloc(4);if(!!!this.pdfiumModule.EPDFAnnot_GetDefaultAppearance(r,n,e,i,u,F)){[n,e,i,u,F].forEach(y=>this.memoryManager.free(y));return}const _=this.pdfiumModule.pdfium,P=_.getValue(n,"i32"),h=_.getValue(e,"float"),b=_.getValue(i,"i32")&255,A=_.getValue(u,"i32")&255,M=_.getValue(F,"i32")&255;return[n,e,i,u,F].forEach(y=>this.memoryManager.free(y)),{fontFamily:P,fontSize:h,fontColor:Qt({red:b,green:A,blue:M})}}setAnnotationDefaultAppearance(r,n,e,i){const{red:u,green:F,blue:d}=Zt(i);return!!this.pdfiumModule.EPDFAnnot_SetDefaultAppearance(r,n,e,u&255,F&255,d&255)}getBorderStyle(r){const n=this.memoryManager.malloc(4);let e=0,i=Ge.UNKNOWN,u=!1;return i=this.pdfiumModule.EPDFAnnot_GetBorderStyle(r,n),e=this.pdfiumModule.pdfium.getValue(n,"float"),u=i!==Ge.UNKNOWN,this.memoryManager.free(n),{ok:u,style:i,width:e}}setBorderStyle(r,n,e){return this.pdfiumModule.EPDFAnnot_SetBorderStyle(r,n,e)}getAnnotationIcon(r){return this.pdfiumModule.EPDFAnnot_GetIcon(r)}setAnnotationIcon(r,n){return this.pdfiumModule.EPDFAnnot_SetIcon(r,n)}getBorderEffect(r){const n=this.memoryManager.malloc(4),e=!!this.pdfiumModule.EPDFAnnot_GetBorderEffect(r,n),i=e?this.pdfiumModule.pdfium.getValue(n,"float"):0;return this.memoryManager.free(n),{ok:e,intensity:i}}getRectangleDifferences(r){const n=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),F=!!this.pdfiumModule.EPDFAnnot_GetRectangleDifferences(r,n,e,i,u),d=this.pdfiumModule.pdfium,_=d.getValue(n,"float"),P=d.getValue(e,"float"),h=d.getValue(i,"float"),b=d.getValue(u,"float");return this.memoryManager.free(n),this.memoryManager.free(e),this.memoryManager.free(i),this.memoryManager.free(u),{ok:F,left:_,top:P,right:h,bottom:b}}getAnnotationDate(r,n){const e=this.getAnnotString(r,n);return e?ot(e):void 0}setAnnotationDate(r,n,e){const i=gt(e);return this.setAnnotString(r,n,i)}getAttachmentDate(r,n){const e=this.getAttachmentString(r,n);return e?ot(e):void 0}setAttachmentDate(r,n,e){const i=gt(e);return this.setAttachmentString(r,n,i)}getBorderDashPattern(r){const n=this.pdfiumModule.EPDFAnnot_GetBorderDashPatternCount(r);if(n===0)return{ok:!1,pattern:[]};const e=this.memoryManager.malloc(4*n),i=!!this.pdfiumModule.EPDFAnnot_GetBorderDashPattern(r,e,n),u=[];if(i){const F=this.pdfiumModule.pdfium;for(let d=0;d<n;d++)u.push(F.getValue(e+4*d,"float"))}return this.memoryManager.free(e),{ok:i,pattern:u}}setBorderDashPattern(r,n){if(!n||n.length===0)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(r,0,0);const e=n.map(d=>Number.isFinite(d)&&d>0?d:0).filter(d=>d>0);if(e.length===0)return this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(r,0,0);const i=4*e.length,u=this.memoryManager.malloc(i);for(let d=0;d<e.length;d++)this.pdfiumModule.pdfium.setValue(u+4*d,e[d],"float");const F=!!this.pdfiumModule.EPDFAnnot_SetBorderDashPattern(r,u,e.length);return this.memoryManager.free(u),F}getLineEndings(r){const n=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4);if(!!!this.pdfiumModule.EPDFAnnot_GetLineEndings(r,n,e)){this.memoryManager.free(n),this.memoryManager.free(e);return}const u=this.pdfiumModule.pdfium.getValue(n,"i32"),F=this.pdfiumModule.pdfium.getValue(e,"i32");return this.memoryManager.free(n),this.memoryManager.free(e),{start:u,end:F}}setLineEndings(r,n,e){return!!this.pdfiumModule.EPDFAnnot_SetLineEndings(r,n,e)}getLinePoints(r,n){const e=this.memoryManager.malloc(8),i=this.memoryManager.malloc(8);if(!this.pdfiumModule.FPDFAnnot_GetLine(n,e,i)){this.memoryManager.free(e),this.memoryManager.free(i);return}const F=this.pdfiumModule.pdfium,d=F.getValue(e+0,"float"),_=F.getValue(e+4,"float"),P=F.getValue(i+0,"float"),h=F.getValue(i+4,"float");this.memoryManager.free(e),this.memoryManager.free(i);const b=this.convertPagePointToDevicePoint(r,{x:d,y:_}),A=this.convertPagePointToDevicePoint(r,{x:P,y:h});return{start:b,end:A}}setLinePoints(r,n,e,i){const u=this.convertDevicePointToPagePoint(r,e),F=this.convertDevicePointToPagePoint(r,i);if(!u||!F)return!1;const d=this.memoryManager.malloc(16),_=this.pdfiumModule.pdfium;_.setValue(d+0,u.x,"float"),_.setValue(d+4,u.y,"float"),_.setValue(d+8,F.x,"float"),_.setValue(d+12,F.y,"float");const P=this.pdfiumModule.EPDFAnnot_SetLine(n,d,d+8);return this.memoryManager.free(d),!!P}getQuadPointsAnno(r,n){const e=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(n);if(e===0)return[];const i=8*4,u=[];for(let F=0;F<e;F++){const d=this.memoryManager.malloc(i);if(this.pdfiumModule.FPDFAnnot_GetAttachmentPoints(n,F,d)){const P=[],h=[];for(let S=0;S<4;S++){const x=d+S*8;P.push(this.pdfiumModule.pdfium.getValue(x,"float")),h.push(this.pdfiumModule.pdfium.getValue(x+4,"float"))}const b=this.convertPagePointToDevicePoint(r,{x:P[0],y:h[0]}),A=this.convertPagePointToDevicePoint(r,{x:P[1],y:h[1]}),M=this.convertPagePointToDevicePoint(r,{x:P[2],y:h[2]}),y=this.convertPagePointToDevicePoint(r,{x:P[3],y:h[3]});u.push({p1:b,p2:A,p3:M,p4:y})}this.memoryManager.free(d)}return u.map(qr)}syncQuadPointsAnno(r,n,e){const u=this.pdfiumModule.pdfium,F=this.pdfiumModule.FPDFAnnot_CountAttachmentPoints(n),d=this.memoryManager.malloc(32),_=h=>{const b=en(h),A=this.convertDevicePointToPagePoint(r,b.p1),M=this.convertDevicePointToPagePoint(r,b.p2),y=this.convertDevicePointToPagePoint(r,b.p3),S=this.convertDevicePointToPagePoint(r,b.p4);u.setValue(d+0,A.x,"float"),u.setValue(d+4,A.y,"float"),u.setValue(d+8,M.x,"float"),u.setValue(d+12,M.y,"float"),u.setValue(d+16,S.x,"float"),u.setValue(d+20,S.y,"float"),u.setValue(d+24,y.x,"float"),u.setValue(d+28,y.y,"float")},P=Math.min(F,e.length);for(let h=0;h<P;h++)if(_(e[h]),!this.pdfiumModule.FPDFAnnot_SetAttachmentPoints(n,h,d))return this.memoryManager.free(d),!1;for(let h=F;h<e.length;h++)if(_(e[h]),!this.pdfiumModule.FPDFAnnot_AppendAttachmentPoints(n,d))return this.memoryManager.free(d),!1;return this.memoryManager.free(d),!0}redactTextInRects(r,n,e,i){const{recurseForms:u=!0,drawBlackBoxes:F=!1}=i??{};this.logger.debug("PDFiumEngine","Engine","redactTextInQuads",r.id,n.index,e.length);const d="RedactTextInQuads";this.logger.perf("PDFiumEngine","Engine",d,"Begin",`${r.id}-${n.index}`);const _=this.cache.getContext(r.id);if(!_)return this.logger.perf("PDFiumEngine","Engine",d,"End",`${r.id}-${n.index}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const P=(e??[]).filter(y=>{var S,x,v,I;return y&&Number.isFinite((S=y.origin)==null?void 0:S.x)&&Number.isFinite((x=y.origin)==null?void 0:x.y)&&Number.isFinite((v=y.size)==null?void 0:v.width)&&Number.isFinite((I=y.size)==null?void 0:I.height)&&y.size.width>0&&y.size.height>0});if(P.length===0)return this.logger.perf("PDFiumEngine","Engine",d,"End",`${r.id}-${n.index}`),G.resolve(!1);const h=_.acquirePage(n.index),{ptr:b,count:A}=this.allocFSQuadsBufferFromRects(n,P);let M=!1;try{M=!!this.pdfiumModule.EPDFText_RedactInQuads(h.pagePtr,b,A,!!u,!!F)}finally{this.memoryManager.free(b)}return M&&(M=!!this.pdfiumModule.FPDFPage_GenerateContent(h.pagePtr)),h.disposeImmediate(),this.logger.perf("PDFiumEngine","Engine",d,"End",`${r.id}-${n.index}`),G.resolve(!!M)}allocFSQuadsBufferFromRects(r,n){const i=n.length,u=this.memoryManager.malloc(32*i),F=this.pdfiumModule.pdfium;for(let d=0;d<i;d++){const _=n[d],P=en(_),h=this.convertDevicePointToPagePoint(r,P.p1),b=this.convertDevicePointToPagePoint(r,P.p2),A=this.convertDevicePointToPagePoint(r,P.p3),M=this.convertDevicePointToPagePoint(r,P.p4),y=u+d*32;F.setValue(y+0,h.x,"float"),F.setValue(y+4,h.y,"float"),F.setValue(y+8,b.x,"float"),F.setValue(y+12,b.y,"float"),F.setValue(y+16,M.x,"float"),F.setValue(y+20,M.y,"float"),F.setValue(y+24,A.x,"float"),F.setValue(y+28,A.y,"float")}return{ptr:u,count:i}}getInkList(r,n){const e=[],i=this.pdfiumModule.FPDFAnnot_GetInkListCount(n);if(i<=0)return e;const u=this.pdfiumModule.pdfium,F=8;for(let d=0;d<i;d++){const _=[],P=this.pdfiumModule.FPDFAnnot_GetInkListPath(n,d,0,0);if(P>0){const h=this.memoryManager.malloc(P*F);this.pdfiumModule.FPDFAnnot_GetInkListPath(n,d,h,P);for(let b=0;b<P;b++){const A=h+b*F,M=u.getValue(A+0,"float"),y=u.getValue(A+4,"float"),S=this.convertPagePointToDevicePoint(r,{x:M,y});_.push({x:S.x,y:S.y})}this.memoryManager.free(h)}e.push({points:_})}return e}setInkList(r,n,e){const i=this.pdfiumModule.pdfium,u=8;for(const F of e){const d=F.points.length;if(d===0)continue;const _=this.memoryManager.malloc(d*u);for(let h=0;h<d;h++){const b=F.points[h],A=this.convertDevicePointToPagePoint(r,b);i.setValue(_+h*u+0,A.x,"float"),i.setValue(_+h*u+4,A.y,"float")}const P=this.pdfiumModule.FPDFAnnot_AddInkStroke(n,_,d);if(this.memoryManager.free(_),P===-1)return!1}return!0}readPdfTextAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getAnnotString(n,"Contents")||"",b=this.getAnnotString(n,"State"),A=this.getAnnotString(n,"StateModel"),M=this.getAnnotationColor(n),y=this.getAnnotationOpacity(n),S=this.getInReplyToId(n),x=this.getAnnotationFlags(n),v=this.getAnnotationIcon(n);return{pageIndex:r.index,custom:i,id:e,type:R.TEXT,flags:x,contents:h,color:M??"#FFFF00",opacity:y,rect:F,inReplyToId:S,author:d,modified:_,created:P,state:b,stateModel:A,icon:v}}readPdfFreeTextAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"Contents")||"",_=this.getAnnotString(n,"T"),P=this.getAnnotationDate(n,"M"),h=this.getAnnotationDate(n,"CreationDate"),b=this.getAnnotString(n,"DS"),A=this.getAnnotationDefaultAppearance(n),M=this.getAnnotationColor(n),y=this.getAnnotationTextAlignment(n),S=this.getAnnotationVerticalAlignment(n),x=this.getAnnotationOpacity(n),v=this.getAnnotRichContent(n),I=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,type:R.FREETEXT,fontFamily:(A==null?void 0:A.fontFamily)??Qr.Unknown,fontSize:(A==null?void 0:A.fontSize)??12,fontColor:(A==null?void 0:A.fontColor)??"#000000",verticalAlign:S,backgroundColor:M,flags:I,opacity:x,textAlign:y,defaultStyle:b,richContent:v,contents:d,author:_,modified:P,created:h,rect:F}}readPdfLinkAnno(r,n,e,i){const u=this.getAnnotCustom(e),F=this.pdfiumModule.FPDFAnnot_GetLink(e);if(!F)return;const d=this.readPageAnnoRect(e),_=this.convertPageRectToDeviceRect(r,d),P=this.getAnnotString(e,"T"),h=this.getAnnotationDate(e,"M"),b=this.getAnnotationDate(e,"CreationDate"),A=this.getAnnotationFlags(e),M=this.readPdfLinkAnnoTarget(n,()=>this.pdfiumModule.FPDFLink_GetAction(F),()=>this.pdfiumModule.FPDFLink_GetDest(n,F));return{pageIndex:r.index,custom:u,id:i,type:R.LINK,flags:A,target:M,rect:_,author:P,modified:h,created:b}}readPdfWidgetAnno(r,n,e,i){const u=this.getAnnotCustom(n),F=this.readPageAnnoRect(n),d=this.convertPageRectToDeviceRect(r,F),_=this.getAnnotString(n,"T"),P=this.getAnnotationDate(n,"M"),h=this.getAnnotationDate(n,"CreationDate"),b=this.getAnnotationFlags(n),A=this.readPdfWidgetAnnoField(e,n);return{pageIndex:r.index,custom:u,id:i,type:R.WIDGET,flags:b,rect:d,field:A,author:_,modified:P,created:h}}readPdfFileAttachmentAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,type:R.FILEATTACHMENT,flags:h,rect:F,author:d,modified:_,created:P}}readPdfInkAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getAnnotationColor(n),b=this.getAnnotationOpacity(n),{width:A}=this.getBorderStyle(n),M=this.getInkList(r,n),y=this.pdfiumModule.EPDFAnnot_GetBlendMode(n),S=this.getAnnotIntent(n),x=this.getAnnotationFlags(n),v=this.getAnnotString(n,"Contents")||"";return{pageIndex:r.index,custom:i,id:e,type:R.INK,...S&&{intent:S},contents:v,blendMode:y,flags:x,color:h??"#FF0000",opacity:b,strokeWidth:A===0?1:A,rect:F,inkList:M,author:d,modified:_,created:P}}readPdfPolygonAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.readPdfAnnoVertices(r,n),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationFlags(n),M=this.getAnnotationColor(n),y=this.getAnnotationColor(n,ne.InteriorColor),S=this.getAnnotationOpacity(n);let{style:x,width:v}=this.getBorderStyle(n),I;if(x===Ge.DASHED){const{ok:B,pattern:Y}=this.getBorderDashPattern(n);B&&(I=Y)}if(h.length>1){const B=h[0],Y=h[h.length-1];B.x===Y.x&&B.y===Y.y&&h.pop()}return{pageIndex:r.index,custom:i,id:e,type:R.POLYGON,contents:b,flags:A,strokeColor:M??"#FF0000",color:y??"transparent",opacity:S,strokeWidth:v===0?1:v,strokeStyle:x,strokeDashArray:I,rect:F,vertices:h,author:d,modified:_,created:P}}readPdfPolylineAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.readPdfAnnoVertices(r,n),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationColor(n),M=this.getAnnotationFlags(n),y=this.getAnnotationColor(n,ne.InteriorColor),S=this.getAnnotationOpacity(n);let{style:x,width:v}=this.getBorderStyle(n),I;if(x===Ge.DASHED){const{ok:Y,pattern:C}=this.getBorderDashPattern(n);Y&&(I=C)}const B=this.getLineEndings(n);return{pageIndex:r.index,custom:i,id:e,type:R.POLYLINE,contents:b,flags:M,strokeColor:A??"#FF0000",color:y??"transparent",opacity:S,strokeWidth:v===0?1:v,strokeStyle:x,strokeDashArray:I,lineEndings:B,rect:F,vertices:h,author:d,modified:_,created:P}}readPdfLineAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getLinePoints(r,n),b=this.getLineEndings(n),A=this.getAnnotString(n,"Contents")||"",M=this.getAnnotationColor(n),y=this.getAnnotationFlags(n),S=this.getAnnotationColor(n,ne.InteriorColor),x=this.getAnnotationOpacity(n);let{style:v,width:I}=this.getBorderStyle(n),B;if(v===Ge.DASHED){const{ok:Y,pattern:C}=this.getBorderDashPattern(n);Y&&(B=C)}return{pageIndex:r.index,custom:i,id:e,type:R.LINE,flags:y,rect:F,contents:A,strokeWidth:I===0?1:I,strokeStyle:v,strokeDashArray:B,strokeColor:M??"#FF0000",color:S??"transparent",opacity:x,linePoints:h||{start:{x:0,y:0},end:{x:0,y:0}},lineEndings:b||{start:Ve.None,end:Ve.None},author:d,modified:_,created:P}}readPdfHighlightAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getQuadPointsAnno(r,n),_=this.getAnnotationColor(n),P=this.getAnnotationOpacity(n),h=this.pdfiumModule.EPDFAnnot_GetBlendMode(n),b=this.getAnnotString(n,"T"),A=this.getAnnotationDate(n,"M"),M=this.getAnnotationDate(n,"CreationDate"),y=this.getAnnotString(n,"Contents")||"",S=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,blendMode:h,type:R.HIGHLIGHT,rect:F,flags:S,contents:y,segmentRects:d,color:_??"#FFFF00",opacity:P,author:b,modified:A,created:M}}readPdfUnderlineAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getQuadPointsAnno(r,n),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationColor(n),M=this.getAnnotationOpacity(n),y=this.pdfiumModule.EPDFAnnot_GetBlendMode(n),S=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,blendMode:y,type:R.UNDERLINE,rect:F,flags:S,contents:b,segmentRects:h,color:A??"#FF0000",opacity:M,author:d,modified:_,created:P}}readPdfStrikeOutAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getQuadPointsAnno(r,n),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationColor(n),M=this.getAnnotationOpacity(n),y=this.pdfiumModule.EPDFAnnot_GetBlendMode(n),S=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,blendMode:y,type:R.STRIKEOUT,flags:S,rect:F,contents:b,segmentRects:h,color:A??"#FF0000",opacity:M,author:d,modified:_,created:P}}readPdfSquigglyAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getQuadPointsAnno(r,n),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationColor(n),M=this.getAnnotationOpacity(n),y=this.pdfiumModule.EPDFAnnot_GetBlendMode(n),S=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,blendMode:y,type:R.SQUIGGLY,rect:F,flags:S,contents:b,segmentRects:h,color:A??"#FF0000",opacity:M,author:d,modified:_,created:P}}readPdfCaretAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getAnnotationFlags(n);return{pageIndex:r.index,custom:i,id:e,type:R.CARET,rect:F,flags:h,author:d,modified:_,created:P}}readPdfStampAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.readPageAnnoRect(n),F=this.convertPageRectToDeviceRect(r,u),d=this.getAnnotString(n,"T"),_=this.getAnnotationDate(n,"M"),P=this.getAnnotationDate(n,"CreationDate"),h=this.getAnnotationFlags(n),b=this.getAnnotString(n,"Contents")||"";return{pageIndex:r.index,custom:i,id:e,type:R.STAMP,contents:b,rect:F,author:d,modified:_,created:P,flags:h}}readPdfPageObject(r){switch(this.pdfiumModule.FPDFPageObj_GetType(r)){case Ue.PATH:return this.readPathObject(r);case Ue.IMAGE:return this.readImageObject(r);case Ue.FORM:return this.readFormObject(r)}}readPathObject(r){const n=this.pdfiumModule.FPDFPath_CountSegments(r),e=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),u=this.memoryManager.malloc(4),F=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPageObj_GetBounds(r,e,i,u,F);const d=this.pdfiumModule.pdfium.getValue(e,"float"),_=this.pdfiumModule.pdfium.getValue(i,"float"),P=this.pdfiumModule.pdfium.getValue(u,"float"),h=this.pdfiumModule.pdfium.getValue(F,"float"),b={left:d,bottom:_,right:P,top:h};this.memoryManager.free(e),this.memoryManager.free(i),this.memoryManager.free(u),this.memoryManager.free(F);const A=[];for(let y=0;y<n;y++){const S=this.readPdfSegment(r,y);A.push(S)}const M=this.readPdfPageObjectTransformMatrix(r);return{type:Ue.PATH,bounds:b,segments:A,matrix:M}}readPdfSegment(r,n){const e=this.pdfiumModule.FPDFPath_GetPathSegment(r,n),i=this.pdfiumModule.FPDFPathSegment_GetType(e),u=this.pdfiumModule.FPDFPathSegment_GetClose(e),F=this.memoryManager.malloc(4),d=this.memoryManager.malloc(4);this.pdfiumModule.FPDFPathSegment_GetPoint(e,F,d);const _=this.pdfiumModule.pdfium.getValue(F,"float"),P=this.pdfiumModule.pdfium.getValue(d,"float");return this.memoryManager.free(F),this.memoryManager.free(d),{type:i,point:{x:_,y:P},isClosed:u}}readImageObject(r){const n=this.pdfiumModule.FPDFImageObj_GetBitmap(r),e=this.pdfiumModule.FPDFBitmap_GetBuffer(n),i=this.pdfiumModule.FPDFBitmap_GetWidth(n),u=this.pdfiumModule.FPDFBitmap_GetHeight(n),F=this.pdfiumModule.FPDFBitmap_GetFormat(n),d=i*u,_=4,P=new Uint8ClampedArray(d*_);for(let A=0;A<d;A++)switch(F){case 2:{const M=this.pdfiumModule.pdfium.getValue(e+A*3,"i8"),y=this.pdfiumModule.pdfium.getValue(e+A*3+1,"i8"),S=this.pdfiumModule.pdfium.getValue(e+A*3+2,"i8");P[A*_]=S,P[A*_+1]=y,P[A*_+2]=M,P[A*_+3]=100}break}const h=new ImageData(P,i,u),b=this.readPdfPageObjectTransformMatrix(r);return{type:Ue.IMAGE,imageData:h,matrix:b}}readFormObject(r){const n=this.pdfiumModule.FPDFFormObj_CountObjects(r),e=[];for(let u=0;u<n;u++){const F=this.pdfiumModule.FPDFFormObj_GetObject(r,u),d=this.readPdfPageObject(F);d&&e.push(d)}const i=this.readPdfPageObjectTransformMatrix(r);return{type:Ue.FORM,objects:e,matrix:i}}readPdfPageObjectTransformMatrix(r){const n=this.memoryManager.malloc(24);if(this.pdfiumModule.FPDFPageObj_GetMatrix(r,n)){const e=this.pdfiumModule.pdfium.getValue(n,"float"),i=this.pdfiumModule.pdfium.getValue(n+4,"float"),u=this.pdfiumModule.pdfium.getValue(n+8,"float"),F=this.pdfiumModule.pdfium.getValue(n+12,"float"),d=this.pdfiumModule.pdfium.getValue(n+16,"float"),_=this.pdfiumModule.pdfium.getValue(n+20,"float");return this.memoryManager.free(n),{a:e,b:i,c:u,d:F,e:d,f:_}}return this.memoryManager.free(n),{a:1,b:0,c:0,d:1,e:0,f:0}}readStampAnnotationContents(r){const n=[],e=this.pdfiumModule.FPDFAnnot_GetObjectCount(r);for(let i=0;i<e;i++){const u=this.pdfiumModule.FPDFAnnot_GetObject(r,i),F=this.readPdfPageObject(u);F&&n.push(F)}return n}getStrokeWidth(r){const n=this.memoryManager.malloc(4),e=this.memoryManager.malloc(4),i=this.memoryManager.malloc(4),F=this.pdfiumModule.FPDFAnnot_GetBorder(r,n,e,i)?this.pdfiumModule.pdfium.getValue(i,"float"):1;return this.memoryManager.free(n),this.memoryManager.free(e),this.memoryManager.free(i),F}getAnnotationFlags(r){const n=this.pdfiumModule.FPDFAnnot_GetFlags(r);return Zr(n)}setAnnotationFlags(r,n){const e=eo(n);return this.pdfiumModule.FPDFAnnot_SetFlags(r,e)}readPdfCircleAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.getAnnotationFlags(n),F=this.readPageAnnoRect(n),d=this.convertPageRectToDeviceRect(r,F),_=this.getAnnotString(n,"T"),P=this.getAnnotationDate(n,"M"),h=this.getAnnotationDate(n,"CreationDate"),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationColor(n,ne.InteriorColor),M=this.getAnnotationColor(n),y=this.getAnnotationOpacity(n);let{style:S,width:x}=this.getBorderStyle(n),v;if(S===Ge.DASHED){const{ok:I,pattern:B}=this.getBorderDashPattern(n);I&&(v=B)}return{pageIndex:r.index,custom:i,id:e,type:R.CIRCLE,flags:u,color:A??"transparent",opacity:y,contents:b,strokeWidth:x,strokeColor:M??"#FF0000",strokeStyle:S,rect:d,author:_,modified:P,created:h,...v!==void 0&&{strokeDashArray:v}}}readPdfSquareAnno(r,n,e){const i=this.getAnnotCustom(n),u=this.getAnnotationFlags(n),F=this.readPageAnnoRect(n),d=this.convertPageRectToDeviceRect(r,F),_=this.getAnnotString(n,"T"),P=this.getAnnotationDate(n,"M"),h=this.getAnnotationDate(n,"CreationDate"),b=this.getAnnotString(n,"Contents")||"",A=this.getAnnotationColor(n,ne.InteriorColor),M=this.getAnnotationColor(n),y=this.getAnnotationOpacity(n);let{style:S,width:x}=this.getBorderStyle(n),v;if(S===Ge.DASHED){const{ok:I,pattern:B}=this.getBorderDashPattern(n);I&&(v=B)}return{pageIndex:r.index,custom:i,id:e,type:R.SQUARE,flags:u,color:A??"transparent",opacity:y,contents:b,strokeColor:M??"#FF0000",strokeWidth:x,strokeStyle:S,rect:d,author:_,modified:P,created:h,...v!==void 0&&{strokeDashArray:v}}}readPdfAnno(r,n,e,i){const u=this.getAnnotCustom(e),F=this.readPageAnnoRect(e),d=this.convertPageRectToDeviceRect(r,F),_=this.getAnnotString(e,"T"),P=this.getAnnotationDate(e,"M"),h=this.getAnnotationDate(e,"CreationDate"),b=this.getAnnotationFlags(e);return{pageIndex:r.index,custom:u,id:i,flags:b,type:n,rect:d,author:_,modified:P,created:h}}getInReplyToId(r){const n=this.pdfiumModule.FPDFAnnot_GetLinkedAnnot(r,"IRT");if(n)return this.getAnnotString(n,"NM")}setInReplyToId(r,n,e){const i=this.getAnnotationByName(r,e);return i?this.pdfiumModule.EPDFAnnot_SetLinkedAnnot(n,"IRT",i):!1}getAnnotString(r,n){const e=this.pdfiumModule.FPDFAnnot_GetStringValue(r,n,0,0);if(e===0)return;const i=(e+1)*2,u=this.memoryManager.malloc(i);this.pdfiumModule.FPDFAnnot_GetStringValue(r,n,u,i);const F=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),F||void 0}getAttachmentString(r,n){const e=this.pdfiumModule.FPDFAttachment_GetStringValue(r,n,0,0);if(e===0)return;const i=(e+1)*2,u=this.memoryManager.malloc(i);this.pdfiumModule.FPDFAttachment_GetStringValue(r,n,u,i);const F=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),F||void 0}getAttachmentNumber(r,n){const e=this.memoryManager.malloc(4);try{return this.pdfiumModule.EPDFAttachment_GetIntegerValue(r,n,e)?this.pdfiumModule.pdfium.getValue(e,"i32")>>>0:void 0}finally{this.memoryManager.free(e)}}getAnnotCustom(r){const n=this.getAnnotString(r,"EPDFCustom");if(n)try{return JSON.parse(n)}catch(e){console.warn("Failed to parse annotation custom data as JSON:",e),console.warn("Invalid JSON string:",n);return}}setAnnotCustom(r,n){if(n==null)return this.setAnnotString(r,"EPDFCustom","");try{const e=JSON.stringify(n);return this.setAnnotString(r,"EPDFCustom",e)}catch(e){return console.warn("Failed to stringify annotation custom data as JSON:",e),console.warn("Invalid data object:",n),!1}}getAnnotIntent(r){const n=this.pdfiumModule.EPDFAnnot_GetIntent(r,0,0);if(n===0)return;const i=(n+1)*2,u=this.memoryManager.malloc(i);this.pdfiumModule.EPDFAnnot_GetIntent(r,u,i);const F=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),F&&F!=="undefined"?F:void 0}setAnnotIntent(r,n){return this.pdfiumModule.EPDFAnnot_SetIntent(r,n)}getAnnotRichContent(r){const n=this.pdfiumModule.EPDFAnnot_GetRichContent(r,0,0);if(n===0)return;const i=(n+1)*2,u=this.memoryManager.malloc(i);this.pdfiumModule.EPDFAnnot_GetRichContent(r,u,i);const F=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),F||void 0}getAnnotationByName(r,n){return this.withWString(n,e=>this.pdfiumModule.EPDFPage_GetAnnotByName(r,e))}removeAnnotationByName(r,n){return this.withWString(n,e=>this.pdfiumModule.EPDFPage_RemoveAnnotByName(r,e))}setAnnotString(r,n,e){return this.withWString(e,i=>this.pdfiumModule.FPDFAnnot_SetStringValue(r,n,i))}setAttachmentString(r,n,e){return this.withWString(e,i=>this.pdfiumModule.FPDFAttachment_SetStringValue(r,n,i))}readPdfAnnoVertices(r,n){const e=[],i=this.pdfiumModule.FPDFAnnot_GetVertices(n,0,0),u=8,F=this.memoryManager.malloc(i*u);this.pdfiumModule.FPDFAnnot_GetVertices(n,F,i);for(let d=0;d<i;d++){const _=this.pdfiumModule.pdfium.getValue(F+d*u,"float"),P=this.pdfiumModule.pdfium.getValue(F+d*u+4,"float"),{x:h,y:b}=this.convertPagePointToDevicePoint(r,{x:_,y:P}),A=e[e.length-1];(!A||A.x!==h||A.y!==b)&&e.push({x:h,y:b})}return this.memoryManager.free(F),e}setPdfAnnoVertices(r,n,e){const i=this.pdfiumModule.pdfium,u=8,F=this.memoryManager.malloc(u*e.length);e.forEach((_,P)=>{const h=this.convertDevicePointToPagePoint(r,_);i.setValue(F+P*u+0,h.x,"float"),i.setValue(F+P*u+4,h.y,"float")});const d=this.pdfiumModule.EPDFAnnot_SetVertices(n,F,e.length);return this.memoryManager.free(F),d}readPdfBookmarkTarget(r,n,e){const i=n();if(i)return{type:"action",action:this.readPdfAction(r,i)};{const u=e();if(u)return{type:"destination",destination:this.readPdfDestination(r,u)}}}readPdfWidgetAnnoField(r,n){const e=this.pdfiumModule.FPDFAnnot_GetFormFieldFlags(r,n),i=this.pdfiumModule.FPDFAnnot_GetFormFieldType(r,n),u=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.FPDFAnnot_GetFormFieldName(r,n,h,b),this.pdfiumModule.pdfium.UTF16ToString),F=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.FPDFAnnot_GetFormFieldAlternateName(r,n,h,b),this.pdfiumModule.pdfium.UTF16ToString),d=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.FPDFAnnot_GetFormFieldValue(r,n,h,b),this.pdfiumModule.pdfium.UTF16ToString),_=[];if(i===it.COMBOBOX||i===it.LISTBOX){const h=this.pdfiumModule.FPDFAnnot_GetOptionCount(r,n);for(let b=0;b<h;b++){const A=se(this.pdfiumModule.pdfium,(y,S)=>this.pdfiumModule.FPDFAnnot_GetOptionLabel(r,n,b,y,S),this.pdfiumModule.pdfium.UTF16ToString),M=this.pdfiumModule.FPDFAnnot_IsOptionSelected(r,n,b);_.push({label:A,isSelected:M})}}let P=!1;return(i===it.CHECKBOX||i===it.RADIOBUTTON)&&(P=this.pdfiumModule.FPDFAnnot_IsChecked(r,n)),{flag:e,type:i,name:u,alternateName:F,value:d,isChecked:P,options:_}}renderPageAnnotation(r,n,e,i){const{scaleFactor:u=1,rotation:F=ze.Degree0,dpr:d=1,mode:_=We.Normal,imageType:P="image/webp",imageQuality:h}=i??{};this.logger.debug(f,D,"renderPageAnnotation",r,n,e,i),this.logger.perf(f,D,"RenderPageAnnotation","Begin",`${r.id}-${n.index}-${e.id}`);const b=new rn,A=this.cache.getContext(r.id);if(!A)return this.logger.perf(f,D,"RenderPageAnnotation","End",`${r.id}-${n.index}-${e.id}`),G.reject({code:O.DocNotOpen,message:"document does not open"});const M=A.acquirePage(n.index),y=this.getAnnotationByName(M.pagePtr,e.id);if(!y)return this.logger.perf(f,D,"RenderPageAnnotation","End",`${r.id}-${n.index}-${e.id}`),M.release(),G.reject({code:O.NotFound,message:"annotation not found"});const S=Math.max(.01,u*d),x=tn(e.rect),v=tn(to(n.size,x,F,S)),I=Math.max(1,v.size.width),B=Math.max(1,v.size.height),Y=I*4,C=Y*B,H=this.memoryManager.malloc(C),te=this.pdfiumModule.FPDFBitmap_CreateEx(I,B,4,H,Y);this.pdfiumModule.FPDFBitmap_FillRect(te,0,0,I,B,0);const X=nn(x,F,I,B),re=this.memoryManager.malloc(6*4);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,re,6).set([X.a,X.b,X.c,X.d,X.e,X.f]);const K=16;let me=!1;try{me=!!this.pdfiumModule.EPDF_RenderAnnotBitmap(te,M.pagePtr,y,_,re,K)}finally{this.memoryManager.free(re),this.pdfiumModule.FPDFBitmap_Destroy(te),this.pdfiumModule.FPDFPage_CloseAnnot(y),M.release()}if(!me)return this.memoryManager.free(H),this.logger.perf(f,D,"RenderPageAnnotation","End",`${r.id}-${n.index}-${e.id}`),G.reject({code:O.Unknown,message:"EPDF_RenderAnnotBitmap failed"});const Ce=()=>this.memoryManager.free(H);return this.imageDataConverter(()=>{const ue=new Uint8ClampedArray(this.pdfiumModule.pdfium.HEAPU8.subarray(H,H+C));return{width:I,height:B,data:ue}},P,h).then(ue=>b.resolve(ue)).catch(ue=>{if(ue instanceof pt)try{const fe=this.encodeViaWasm({ptr:H,width:I,height:B,stride:Y},{type:P,quality:h});b.resolve(fe)}catch(fe){b.reject({code:O.Unknown,message:String(fe)})}else b.reject({code:O.Unknown,message:String(ue)})}).finally(Ce),b}encodeViaWasm(r,n){const e=this.pdfiumModule.pdfium,i=(d,_,P)=>{const h=e.HEAPU8.subarray(d,d+_),b=new Uint8Array(h);return this.memoryManager.free(d),new Blob([b],{type:P})},u=6,F=this.memoryManager.malloc(4);try{switch(n.type){case"image/png":default:{const d=this.pdfiumModule.EPDF_PNG_EncodeRGBA(r.ptr,r.width,r.height,r.stride,u,F),_=e.getValue(F,"i32");return i(at(_),d,"image/png")}}}finally{this.memoryManager.free(F)}}renderRectEncoded(r,n,e,i){const u=new rn,F=(i==null?void 0:i.imageType)??"image/webp",d=i==null?void 0:i.imageQuality,_=(i==null?void 0:i.rotation)??ze.Degree0,P=this.cache.getContext(r.id);if(!P)return G.reject({code:O.DocNotOpen,message:"document does not open"});const h=Math.max(.01,(i==null?void 0:i.scaleFactor)??1),b=Math.max(1,(i==null?void 0:i.dpr)??1),A=h*b,M=e.size.width,y=e.size.height,S=(_&1)===1,x=Math.max(1,Math.round((S?y:M)*A)),v=Math.max(1,Math.round((S?M:y)*A)),I=x*4,B=I*v,Y=P.acquirePage(n.index),H=(i==null?void 0:i.withForms)??!1?Y.getFormHandle():void 0,te=this.memoryManager.malloc(B),X=this.pdfiumModule.FPDFBitmap_CreateEx(x,v,4,te,I);this.pdfiumModule.FPDFBitmap_FillRect(X,0,0,x,v,4294967295);const re=nn(e,_,x,v),k=this.memoryManager.malloc(6*4);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,k,6).set([re.a,re.b,re.c,re.d,re.e,re.f]);const me=this.memoryManager.malloc(4*4);new Float32Array(this.pdfiumModule.pdfium.HEAPF32.buffer,me,4).set([0,0,x,v]);let ue=16;((i==null?void 0:i.withAnnotations)??!1)&&(ue|=1);try{if(this.pdfiumModule.FPDF_RenderPageBitmapWithMatrix(X,Y.pagePtr,k,me,ue),H!==void 0){const oe=uo(re,e,n.size,_),{startX:Fe,startY:Qe,formsWidth:Ze,formsHeight:Ie,scaleX:At,scaleY:Et}=oe;this.pdfiumModule.FPDF_FFLDraw(H,X,Y.pagePtr,Fe,Qe,Ze,Ie,_,ue)}}finally{Y.release(),this.memoryManager.free(k),this.memoryManager.free(me)}const fe=()=>{this.pdfiumModule.FPDFBitmap_Destroy(X),this.memoryManager.free(te)};return this.imageDataConverter(()=>{const oe=this.pdfiumModule.pdfium.HEAPU8.buffer,Fe=new Uint8ClampedArray(oe,te,B);return{width:x,height:v,data:Fe}},F,d).then(oe=>u.resolve(oe)).catch(oe=>{if(this.logger.error(f,D,"Error",oe),oe instanceof pt){this.logger.info(f,D,"Fallback to WASM encoding");try{const Fe=this.encodeViaWasm({ptr:te,width:x,height:v,stride:I},{type:F,quality:d});u.resolve(Fe)}catch(Fe){u.reject({code:O.Unknown,message:String(Fe)})}}else u.reject({code:O.Unknown,message:String(oe)})}).finally(fe),u}readPdfLinkAnnoTarget(r,n,e){const i=e();if(i)return{type:"destination",destination:this.readPdfDestination(r,i)};{const u=n();if(u)return{type:"action",action:this.readPdfAction(r,u)}}}createLocalDestPtr(r,n){var e,i;const u=this.pdfiumModule.FPDF_LoadPage(r,n.pageIndex);if(!u)return 0;try{if(n.zoom.mode===he.XYZ){const{x:_,y:P,zoom:h}=n.zoom.params;return this.pdfiumModule.EPDFDest_CreateXYZ(u,!0,_,!0,P,!0,h)}let F,d=[];switch(n.zoom.mode){case he.FitPage:F=he.FitPage;break;case he.FitHorizontal:F=he.FitHorizontal,d=[((e=n.view)==null?void 0:e[0])??0];break;case he.FitVertical:F=he.FitVertical,d=[((i=n.view)==null?void 0:i[0])??0];break;case he.FitRectangle:{const _=n.view??[];d=[_[0]??0,_[1]??0,_[2]??0,_[3]??0],F=he.FitRectangle}break;case he.Unknown:default:return 0}return this.withFloatArray(d,(_,P)=>this.pdfiumModule.EPDFDest_CreateView(u,F,_,P))}finally{this.pdfiumModule.FPDF_ClosePage(u)}}applyBookmarkTarget(r,n,e){if(e.type==="destination"){const u=this.createLocalDestPtr(r,e.destination);return u?!!this.pdfiumModule.EPDFBookmark_SetDest(r,n,u):!1}const i=e.action;switch(i.type){case ae.Goto:{const u=this.createLocalDestPtr(r,i.destination);if(!u)return!1;const F=this.pdfiumModule.EPDFAction_CreateGoTo(r,u);return F?!!this.pdfiumModule.EPDFBookmark_SetAction(r,n,F):!1}case ae.URI:{const u=this.pdfiumModule.EPDFAction_CreateURI(r,i.uri);return u?!!this.pdfiumModule.EPDFBookmark_SetAction(r,n,u):!1}case ae.LaunchAppOrOpenFile:{const u=this.withWString(i.path,F=>this.pdfiumModule.EPDFAction_CreateLaunch(r,F));return u?!!this.pdfiumModule.EPDFBookmark_SetAction(r,n,u):!1}case ae.RemoteGoto:return!1;case ae.Unsupported:default:return!1}}readPdfAction(r,n){const e=this.pdfiumModule.FPDFAction_GetType(n);let i;switch(e){case ae.Unsupported:i={type:ae.Unsupported};break;case ae.Goto:{const u=this.pdfiumModule.FPDFAction_GetDest(r,n);if(u){const F=this.readPdfDestination(r,u);i={type:ae.Goto,destination:F}}else i={type:ae.Unsupported}}break;case ae.RemoteGoto:i={type:ae.Unsupported};break;case ae.URI:{const u=se(this.pdfiumModule.pdfium,(F,d)=>this.pdfiumModule.FPDFAction_GetURIPath(r,n,F,d),this.pdfiumModule.pdfium.UTF8ToString);i={type:ae.URI,uri:u}}break;case ae.LaunchAppOrOpenFile:{const u=se(this.pdfiumModule.pdfium,(F,d)=>this.pdfiumModule.FPDFAction_GetFilePath(n,F,d),this.pdfiumModule.pdfium.UTF8ToString);i={type:ae.LaunchAppOrOpenFile,path:u}}break}return i}readPdfDestination(r,n){const e=this.pdfiumModule.FPDFDest_GetDestPageIndex(r,n),i=4,u=this.memoryManager.malloc(i),F=this.memoryManager.malloc(i*4),d=this.pdfiumModule.FPDFDest_GetView(n,u,F),_=this.pdfiumModule.pdfium.getValue(u,"i32"),P=[];for(let h=0;h<_;h++){const b=F+h*4;P.push(this.pdfiumModule.pdfium.getValue(b,"float"))}if(this.memoryManager.free(u),this.memoryManager.free(F),d===he.XYZ){const h=this.memoryManager.malloc(1),b=this.memoryManager.malloc(1),A=this.memoryManager.malloc(1),M=this.memoryManager.malloc(4),y=this.memoryManager.malloc(4),S=this.memoryManager.malloc(4);if(this.pdfiumModule.FPDFDest_GetLocationInPage(n,h,b,A,M,y,S)){const v=this.pdfiumModule.pdfium.getValue(h,"i8"),I=this.pdfiumModule.pdfium.getValue(b,"i8"),B=this.pdfiumModule.pdfium.getValue(A,"i8"),Y=v?this.pdfiumModule.pdfium.getValue(M,"float"):0,C=I?this.pdfiumModule.pdfium.getValue(y,"float"):0,H=B?this.pdfiumModule.pdfium.getValue(S,"float"):0;return this.memoryManager.free(h),this.memoryManager.free(b),this.memoryManager.free(A),this.memoryManager.free(M),this.memoryManager.free(y),this.memoryManager.free(S),{pageIndex:e,zoom:{mode:d,params:{x:Y,y:C,zoom:H}},view:P}}return this.memoryManager.free(h),this.memoryManager.free(b),this.memoryManager.free(A),this.memoryManager.free(M),this.memoryManager.free(y),this.memoryManager.free(S),{pageIndex:e,zoom:{mode:d,params:{x:0,y:0,zoom:0}},view:P}}return{pageIndex:e,zoom:{mode:d},view:P}}readPdfAttachment(r,n){const e=this.pdfiumModule.FPDFDoc_GetAttachment(r,n),i=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.FPDFAttachment_GetName(e,h,b),this.pdfiumModule.pdfium.UTF16ToString),u=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.EPDFAttachment_GetDescription(e,h,b),this.pdfiumModule.pdfium.UTF16ToString),F=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.FPDFAttachment_GetSubtype(e,h,b),this.pdfiumModule.pdfium.UTF16ToString),d=this.getAttachmentDate(e,"CreationDate"),_=se(this.pdfiumModule.pdfium,(h,b)=>this.pdfiumModule.FPDFAttachment_GetStringValue(e,"Checksum",h,b),this.pdfiumModule.pdfium.UTF16ToString),P=this.getAttachmentNumber(e,"Size");return{index:n,name:i,description:u,mimeType:F,size:P,creationDate:d,checksum:_}}convertDevicePointToPagePoint(r,n){const e=r.size.width,i=r.size.height,u=r.rotation&3;return u===0?{x:n.x,y:i-n.y}:u===1?{x:n.y,y:n.x}:u===2?{x:e-n.x,y:n.y}:{x:i-n.y,y:e-n.x}}convertPagePointToDevicePoint(r,n){const e=r.size.width,i=r.size.height,u=r.rotation&3;return u===0?{x:n.x,y:i-n.y}:u===1?{x:n.y,y:n.x}:u===2?{x:e-n.x,y:n.y}:{x:e-n.y,y:i-n.x}}convertPageRectToDeviceRect(r,n){const{x:e,y:i}=this.convertPagePointToDevicePoint(r,{x:n.left,y:n.top});return{origin:{x:e,y:i},size:{width:Math.abs(n.right-n.left),height:Math.abs(n.top-n.bottom)}}}readPageAnnoAppearanceStreams(r){return{normal:this.readPageAnnoAppearanceStream(r,We.Normal),rollover:this.readPageAnnoAppearanceStream(r,We.Rollover),down:this.readPageAnnoAppearanceStream(r,We.Down)}}readPageAnnoAppearanceStream(r,n=We.Normal){const i=(this.pdfiumModule.FPDFAnnot_GetAP(r,n,0,0)+1)*2,u=this.memoryManager.malloc(i);this.pdfiumModule.FPDFAnnot_GetAP(r,n,u,i);const F=this.pdfiumModule.pdfium.UTF16ToString(u);return this.memoryManager.free(u),F}setPageAnnoAppearanceStream(r,n=We.Normal,e){const i=2*(e.length+1),u=this.memoryManager.malloc(i);try{return this.pdfiumModule.pdfium.stringToUTF16(e,u,i),!!this.pdfiumModule.FPDFAnnot_SetAP(r,n,u)}finally{this.memoryManager.free(u)}}setPageAnnoRect(r,n,e){const i=Math.floor(e.origin.x),u=Math.floor(e.origin.y),F=Math.floor(e.origin.x+e.size.width),d=Math.floor(e.origin.y+e.size.height),_=this.convertDevicePointToPagePoint(r,{x:i,y:u}),P=this.convertDevicePointToPagePoint(r,{x:F,y:u}),h=this.convertDevicePointToPagePoint(r,{x:F,y:d}),b=this.convertDevicePointToPagePoint(r,{x:i,y:d});let A=Math.min(_.x,P.x,h.x,b.x),M=Math.max(_.x,P.x,h.x,b.x),y=Math.min(_.y,P.y,h.y,b.y),S=Math.max(_.y,P.y,h.y,b.y);A>M&&([A,M]=[M,A]),y>S&&([y,S]=[S,y]);const x=this.memoryManager.malloc(16),v=this.pdfiumModule.pdfium;v.setValue(x+0,A,"float"),v.setValue(x+4,S,"float"),v.setValue(x+8,M,"float"),v.setValue(x+12,y,"float");const I=this.pdfiumModule.FPDFAnnot_SetRect(n,x);return this.memoryManager.free(x),!!I}readPageAnnoRect(r){const n=this.memoryManager.malloc(16),e={left:0,top:0,right:0,bottom:0};return this.pdfiumModule.FPDFAnnot_GetRect(r,n)&&(e.left=this.pdfiumModule.pdfium.getValue(n,"float"),e.top=this.pdfiumModule.pdfium.getValue(n+4,"float"),e.right=this.pdfiumModule.pdfium.getValue(n+8,"float"),e.bottom=this.pdfiumModule.pdfium.getValue(n+12,"float")),this.memoryManager.free(n),e}getHighlightRects(r,n,e,i){const u=this.pdfiumModule.FPDFText_CountRects(n,e,i),F=[],d=this.memoryManager.malloc(8),_=this.memoryManager.malloc(8),P=this.memoryManager.malloc(8),h=this.memoryManager.malloc(8);for(let b=0;b<u;b++){if(!this.pdfiumModule.FPDFText_GetRect(n,b,d,_,P,h))continue;const M=this.pdfiumModule.pdfium.getValue(d,"double"),y=this.pdfiumModule.pdfium.getValue(_,"double"),S=this.pdfiumModule.pdfium.getValue(P,"double"),x=this.pdfiumModule.pdfium.getValue(h,"double"),v=this.convertPagePointToDevicePoint(r,{x:M,y}),I=this.convertPagePointToDevicePoint(r,{x:S,y}),B=this.convertPagePointToDevicePoint(r,{x:S,y:x}),Y=this.convertPagePointToDevicePoint(r,{x:M,y:x}),C=[v.x,I.x,B.x,Y.x],H=[v.y,I.y,B.y,Y.y],te=Math.min(...C),X=Math.min(...H),re=Math.max(...C)-te,k=Math.max(...H)-X;F.push({origin:{x:te,y:X},size:{width:Math.ceil(re),height:Math.ceil(k)}})}return this.memoryManager.free(d),this.memoryManager.free(_),this.memoryManager.free(P),this.memoryManager.free(h),F}searchAllPages(r,n,e){var i;this.logger.debug(f,D,"searchAllPages",r,n,e),this.logger.perf(f,D,"SearchAllPages","Begin",r.id);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(f,D,"SearchAllPages","End",r.id),G.resolve({results:[],total:0});const F=2*(n.length+1),d=this.memoryManager.malloc(F);this.pdfiumModule.pdfium.stringToUTF16(n,d,F);const _=((i=e==null?void 0:e.flags)==null?void 0:i.reduce((y,S)=>y|S,on.None))??on.None,P=G.create();let h=!1;P.wait(()=>{},y=>{y.type==="abort"&&(h=!0)});const b=100,A=[],M=y=>{if(h)return;const S=Math.min(y+b,r.pageCount);try{for(let x=y;x<S&&!h;x++){const v=this.searchAllInPage(u,r.pages[x],d,_);A.push(...v),P.progress({page:x,results:v})}}catch(x){h||(this.memoryManager.free(d),this.logger.perf(f,D,"SearchAllPages","End",r.id),P.reject({code:O.Unknown,message:`Error searching document: ${x}`}));return}if(!h){if(S>=r.pageCount){this.memoryManager.free(d),this.logger.perf(f,D,"SearchAllPages","End",r.id),P.resolve({results:A,total:A.length});return}setTimeout(()=>M(S),0)}};return setTimeout(()=>M(0),0),P.wait(()=>{},y=>{if(y.type==="abort")try{this.memoryManager.free(d)}catch{}}),P}buildContext(r,n,e,i=30){const u=/[\s\u00A0.,;:!?()\[\]{}<>/\\\-"'`"\u2013\u2014]/,F=y=>{for(;y>0&&!u.test(r[y-1]);)y--;return y},d=y=>{for(;y<r.length&&!u.test(r[y]);)y++;return y};let _=n;for(;_>0&&u.test(r[_-1]);)_--;let P=0;for(;_>0&&P<i;)_--,u.test(r[_])||P++;_=F(_);let h=n+e;for(;h<r.length&&u.test(r[h]);)h++;for(P=0;h<r.length&&P<i;)u.test(r[h])||P++,h++;h=d(h);const b=r.slice(_,n).replace(/\s+/g," ").trimStart(),A=r.slice(n,n+e),M=r.slice(n+e,h).replace(/\s+/g," ").trimEnd();return{before:this.tidy(b),match:this.tidy(A),after:this.tidy(M),truncatedLeft:_>0,truncatedRight:h<r.length}}tidy(r){return r.replace(/-\uFFFE\s*/g,"").replace(/[\uFFFE\u00AD\u200B\u2060\uFEFF]/g,"").replace(/\s+/g," ")}searchAllInPage(r,n,e,i){return r.borrowPage(n.index,u=>{const F=u.getTextPage(),d=this.pdfiumModule.FPDFText_CountChars(F),_=this.memoryManager.malloc(2*(d+1));this.pdfiumModule.FPDFText_GetText(F,0,d,_);const P=this.pdfiumModule.pdfium.UTF16ToString(_);this.memoryManager.free(_);const h=[],b=this.pdfiumModule.FPDFText_FindStart(F,e,i,0);for(;this.pdfiumModule.FPDFText_FindNext(b);){const A=this.pdfiumModule.FPDFText_GetSchResultIndex(b),M=this.pdfiumModule.FPDFText_GetSchCount(b),y=this.getHighlightRects(n,F,A,M),S=this.buildContext(P,A,M);h.push({pageIndex:n.index,charIndex:A,charCount:M,rects:y,context:S})}return this.pdfiumModule.FPDFText_FindClose(b),h})}preparePrintDocument(r,n){const{includeAnnotations:e=!0,pageRange:i=null}=n??{};this.logger.debug(f,D,"preparePrintDocument",r,n),this.logger.perf(f,D,"PreparePrintDocument","Begin",r.id);const u=this.cache.getContext(r.id);if(!u)return this.logger.perf(f,D,"PreparePrintDocument","End",r.id),G.reject({code:O.DocNotOpen,message:"Document is not open"});const F=this.pdfiumModule.FPDF_CreateNewDocument();if(!F)return this.logger.perf(f,D,"PreparePrintDocument","End",r.id),G.reject({code:O.CantCreateNewDoc,message:"Cannot create print document"});try{const d=this.sanitizePageRange(i,r.pageCount);if(!this.pdfiumModule.FPDF_ImportPages(F,u.docPtr,d??"",0))return this.pdfiumModule.FPDF_CloseDocument(F),this.logger.error(f,D,"Failed to import pages for printing"),this.logger.perf(f,D,"PreparePrintDocument","End",r.id),G.reject({code:O.CantImportPages,message:"Failed to import pages for printing"});if(!e){const P=this.removeAnnotationsFromPrintDocument(F);if(!P.success)return this.pdfiumModule.FPDF_CloseDocument(F),this.logger.error(f,D,`Failed to remove annotations: ${P.error}`),this.logger.perf(f,D,"PreparePrintDocument","End",r.id),G.reject({code:O.Unknown,message:`Failed to prepare print document: ${P.error}`});this.logger.debug(f,D,`Removed ${P.annotationsRemoved} annotations from ${P.pagesProcessed} pages`)}const _=this.saveDocument(F);return this.pdfiumModule.FPDF_CloseDocument(F),this.logger.perf(f,D,"PreparePrintDocument","End",r.id),G.resolve(_)}catch(d){return F&&this.pdfiumModule.FPDF_CloseDocument(F),this.logger.error(f,D,"preparePrintDocument failed",d),this.logger.perf(f,D,"PreparePrintDocument","End",r.id),G.reject({code:O.Unknown,message:d instanceof Error?d.message:"Failed to prepare print document"})}}removeAnnotationsFromPrintDocument(r){let n=0,e=0;try{const i=this.pdfiumModule.FPDF_GetPageCount(r);for(let u=0;u<i;u++){const F=this.pdfiumModule.EPDFPage_GetAnnotCountRaw(r,u);if(F<=0){e++;continue}let d=0;for(let _=F-1;_>=0;_--)this.pdfiumModule.EPDFPage_RemoveAnnotRaw(r,u,_)?(d++,n++):this.logger.warn(f,D,`Failed to remove annotation ${_} from page ${u}`);if(d>0){const _=this.pdfiumModule.FPDF_LoadPage(r,u);_&&(this.pdfiumModule.FPDFPage_GenerateContent(_),this.pdfiumModule.FPDF_ClosePage(_))}e++}return{success:!0,annotationsRemoved:n,pagesProcessed:e}}catch(i){return{success:!1,annotationsRemoved:n,pagesProcessed:e,error:i instanceof Error?i.message:"Unknown error during annotation removal"}}}sanitizePageRange(r,n){if(!r||r.trim()==="")return null;try{const e=[],i=r.split(",");for(const P of i){const h=P.trim();if(h.includes("-")){const[b,A]=h.split("-").map(v=>v.trim()),M=parseInt(b,10),y=parseInt(A,10);if(isNaN(M)||isNaN(y)){this.logger.warn(f,D,`Invalid range: ${h}`);continue}const S=Math.max(1,Math.min(M,n)),x=Math.max(1,Math.min(y,n));for(let v=S;v<=x;v++)e.includes(v)||e.push(v)}else{const b=parseInt(h,10);if(isNaN(b)){this.logger.warn(f,D,`Invalid page number: ${h}`);continue}const A=Math.max(1,Math.min(b,n));e.includes(A)||e.push(A)}}if(e.length===0)return this.logger.warn(f,D,"No valid pages in range, using all pages"),null;e.sort((P,h)=>P-h);const u=[];let F=e[0],d=e[0];for(let P=1;P<e.length;P++)e[P]===d+1||(F===d?u.push(F.toString()):d-F===1?(u.push(F.toString()),u.push(d.toString())):u.push(`${F}-${d}`),F=e[P]),d=e[P];F===d?u.push(F.toString()):d-F===1?(u.push(F.toString()),u.push(d.toString())):u.push(`${F}-${d}`);const _=u.join(",");return this.logger.debug(f,D,`Sanitized page range: "${r}" -> "${_}"`),_}catch(e){return this.logger.error(f,D,`Error sanitizing page range: ${e}`),null}}}async function bo(W,r){const e=await(await fetch(W)).arrayBuffer(),i=await io({wasmBinary:e});return new fo(i,{logger:r})}export{bo as createPdfiumEngine};
//# sourceMappingURL=direct-engine-DsMN-8vU.js.map
